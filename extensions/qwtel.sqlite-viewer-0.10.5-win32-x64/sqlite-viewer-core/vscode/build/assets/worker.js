"throwIfAborted"in AbortSignal.prototype||(AbortSignal.prototype.throwIfAborted=function(e){if(this.aborted)throw new DOMException(e,"AbortError")})
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */;const e=Symbol("Caplink.messageChannel"),t=Symbol("Caplink.adaptNative"),i=Symbol("Caplink.toNative");var n=(e=>(e.RAW="RAW",e.PROXY="PROXY",e.THROW="THROW",e.HANDLER="HANDLER",e))(n||{}),s=(e=>(e.GET="GET",e.SET="SET",e.APPLY="APPLY",e.CONSTRUCT="CONSTRUCT",e.ENDPOINT="ENDPOINT",e.RELEASE="RELEASE",e))(s||{});
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
const r=Symbol("Caplink.proxy"),o=Symbol("Caplink.endpoint"),a=Symbol("Caplink.releaseProxy"),l=Symbol("Caplink.finalizer"),c=Symbol("Caplink.thrown"),u=e=>"object"==typeof e&&null!==e||"function"==typeof e,_=e=>"Worker"in globalThis&&e instanceof globalThis.Worker||"MessagePort"in globalThis&&e instanceof globalThis.MessagePort,f={canHandle:e=>r in e||o in e,serialize(n,s){let r;if(o in n)r=n[o](),_(s)&&(u(a=r)&&i in a)?r=r[i]():s[t]&&_(r)&&(r=s[t](r));else{const{port1:t,port2:i}=new(s[e]??MessageChannel);b(n,t),r=i}var a;return[r,[r]]},deserialize:e=>(e.start(),function(e,t,i={}){return A(e,[],t,i)}(e))},p=new WeakMap,d=new Map([["proxy",f],["throw",{canHandle:e=>c in e,serialize:({value:e})=>[e,[]],deserialize(e){if(e instanceof Error){if(!e.stack||!e.stack.startsWith("    at"))throw e;Object.defineProperty(e,"stack",{value:`Error: ${e.message}\n${e.stack}`})}throw e}}]]);const m=new WeakMap;async function h(e){const t=(m.get(e)||0)-1;m.set(e,t),0===t&&("dispose"in Symbol&&Symbol.dispose in e&&e[Symbol.dispose](),"asyncDispose"in Symbol&&Symbol.asyncDispose in e&&await e[Symbol.asyncDispose](),l in e&&"function"==typeof e[l]&&e[l]())}const g=new WeakSet;function b(e,t=globalThis,i=["*"]){if(g.has(t))throw Error("Endpoint is already exposing another object and cannot be reused.");g.add(t),m.set(e,(m.get(e)||0)+1),t.addEventListener("message",(async function r(o){const a=e;if(!(o&&o.data&&(l=o.data,(e=>"object"==typeof e&&null!==e)(l)&&"type"in l&&"id"in l)))return;var l;if(!function(e,t){for(const i of e){if(t===i||"*"===i)return!0;if(i instanceof RegExp&&i.test(t))return!0}return!1}(i,o.origin))return void console.warn(`Invalid origin '${o.origin}' for caplink proxy`);const{data:u}=o,{id:_,type:f}=u;let p;try{switch(f){case s.GET:p=u.path.reduce(((e,t)=>e[t]),a);break;case s.SET:u.path.slice(0,-1).reduce(((e,t)=>e[t]),a)[u.path.slice(-1)[0]]=C.call(t,u.value),p=!0;break;case s.APPLY:{const e=u.path.slice(0,-1).reduce(((e,t)=>e[t]),a),i=u.path.reduce(((e,t)=>e[t]),a),n=u.argumentList.map(C,t);p=i.apply(e,n)}break;case s.CONSTRUCT:{const e=u.path.reduce(((e,t)=>e[t]),a),i=u.argumentList.map(C,t);p=L(new e(...i))}break;case s.ENDPOINT:b(a,u.value),p=void 0;break;case s.RELEASE:p=void 0,h(a);break;default:return}}catch(m){p={value:m,[c]:0}}try{p=await p}catch(m){p={value:m,[c]:0}}try{const[e,i]=P.call(t,p);e.id=_,(o.source??t).postMessage(e,{transfer:i})}catch(g){console.error(g);const[e,i]=P.call(t,{value:new TypeError("Unserializable return value"),[c]:0});e.id=_,(o.source??t).postMessage(e,{transfer:i})}finally{f===s.RELEASE&&(t.removeEventListener("message",r),t.removeEventListener("close",n),t.removeEventListener("error",n),y(d=t)&&d.close())}var d}));const n=()=>{h(e),t.removeEventListener("close",n),t.removeEventListener("error",n)};t.addEventListener("close",n),t.addEventListener("error",n),t.start?.()}function y(e){return"close"in e&&"function"==typeof e.close}function q(e,t=!1){t?!function(e){return"dispose"in Symbol&&Symbol.dispose in e&&null!=e[Symbol.dispose]}(e)?function(e){return"terminate"in e&&"function"==typeof e.terminate}(e)&&e.terminate():e[Symbol.dispose]():y(e)&&e.close()}function w(e){if(e)throw new Error("Proxy has been released and is not useable"+("string"==typeof e?`: ${e}`:""),e instanceof Error?{cause:e}:{})}async function x(e,t=!1,i=!1){if(p.has(e)){const{resolvers:n,messageHandler:r}=p.get(e);try{const i=!t&&R(e,{type:s.RELEASE});p.delete(e),await i}finally{n.forEach((({reject:e})=>e(new DOMException("Cancelled due to endpoint release","AbortError")))),n.clear(),e.removeEventListener("message",r),q(e,i)}}}const E=new WeakMap,S="FinalizationRegistry"in globalThis?new FinalizationRegistry((async function([e,t]){const i=(E.get(e)||0)-1;E.set(e,i),0===i&&await x(e,void 0,t)})):void 0;function k(e){S?.unregister(e)}function A(t,i=[],n=function(){},{owned:r=!1}={}){let l=!1;const c=new Proxy(n,{get(e,n){if(n===Symbol.dispose||n===a)return()=>{l=!0,k(c),x(t,!1,r).catch((()=>{}))};if(n===Symbol.asyncDispose)return async()=>{l=!0,k(c),await x(t,!1,r)};if(w(l),"then"===n){if(0===i.length)return{then:()=>c};const e=R(t,{type:s.GET,path:i.map((e=>e.toString()))}).then(C.bind(t));return e.then.bind(e)}return A(t,[...i,n])},set(e,n,r){w(l);const[o,a]=P.call(t,r);return R(t,{type:s.SET,path:[...i,n].map((e=>e.toString())),value:o},a).then(C.bind(t))},apply(n,r,a){w(l);const c=i[i.length-1];if(c===o){const{port1:i,port2:n}=new(t[e]??MessageChannel);return R(t,{type:s.ENDPOINT,value:n},[n]).catch((()=>{i.close()})),i}if("bind"===c)return A(t,i.slice(0,-1));"call"===c&&(i=i.slice(0,-1),a=a.slice(1)),"apply"===c&&(i=i.slice(0,-1),a=a[1]);const[u,_]=T(a,t);return R(t,{type:s.APPLY,path:i.map((e=>e.toString())),argumentList:u},_).then(C.bind(t))},construct(e,n){w(l);const[r,o]=T(n,t);return R(t,{type:s.CONSTRUCT,path:i.map((e=>e.toString())),argumentList:r},o).then(C.bind(t))},has:(e,t)=>(w(l),t===Symbol.dispose||t===a||t===Symbol.asyncDispose||t===o||"then"===t)});return t.addEventListener("close",(async e=>{l=e.reason??"closed",k(c),await x(t,!0,r)})),t.addEventListener("error",(async e=>{l=e.error instanceof Error?e.error:"errored",k(c),await x(t,!0,r)})),function(e,[t,i]){const n=(E.get(t)||0)+1;E.set(t,n),S?.register(e,[t,i],e)}(c,[t,r]),c}const I="flat"in Array.prototype?e=>e.flat():e=>Array.prototype.concat.apply([],e);function T(e,t){const i=e.map(P,t);return[i.map((e=>e[0])),I(i.map((e=>e[1])))]}const O=new WeakMap;function F(e,t){return O.set(e,t),e}function L(e){const t=e;return t[r]=!0,t}function P(e){if(u(e))for(const[t,i]of d)if(i.canHandle(e,this)){const[s,r]=i.serialize(e,this);return[{type:n.HANDLER,name:t,value:s},r]}return[{type:n.RAW,value:e},O.get(e)||[]]}function C(e){switch(e.type){case n.HANDLER:return d.get(e.name).deserialize(e.value,this);case n.RAW:return e.value}}const N=e=>t=>{const{data:i}=t;if(!i?.id)return;const n=e.get(i.id);n&&(e.delete(i.id),n.resolve(i))};function R(e,t,i){return new Promise(((n,s)=>{let r=p.get(e)?.resolvers;if(!r){r=new Map;const t=N(r);p.set(e,{resolvers:r,messageHandler:t}),e.addEventListener("message",t),e.start?.()}const o=Math.random()*2**32>>>0;t.id=o,r.set(o,{resolve:n,reject:s}),e.postMessage(t,i)}))}const D="FinalizationRegistry"in globalThis?new FinalizationRegistry((async e=>{e.postMessage(null),e.close()})):void 0,j=(new AbortController).signal;d.set("abortsignal",{canHandle:e=>e instanceof AbortSignal||"AbortSignal"===e?.constructor?.name,serialize(t,i){if(t.aborted)return[{aborted:!0},[]];const{port1:n,port2:s}=new(i[e]??MessageChannel);return t.addEventListener("abort",(()=>n.postMessage({reason:t.reason})),{once:!0}),n.addEventListener("message",(()=>{})),D?.register(t,n),[{aborted:!1,port:s},[s]]},deserialize({aborted:e,port:t}){if(e)return AbortSignal.abort();if(!t)return j;const i=new AbortController;return t.addEventListener("message",(e=>{e.data&&"reason"in e.data&&i.abort(e.data.reason),t.close()}),{once:!0}),t.start(),i.signal}});const z=new Map,M=new Map,B=2**20,U=2**30;let W=200*B;const Q=(e,t,i)=>({xOpen:(n,s,r,o,a)=>{let l=e.cstrToJs(s);l||=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(36);let c=z.get(l);if(!c){if(!(o&t.SQLITE_OPEN_CREATE))return t.SQLITE_CANTOPEN;{const e=new ArrayBuffer(0,{maxByteLength:Math.min(W,4*U)||4*U});c={name:l,flags:o,size:0,data:new Uint8Array(e),lockType:t.SQLITE_LOCK_NONE},z.set(l,c)}}const u=new t.sqlite3_file(r);return u.$pMethods=i.pointer,u.dispose(),M.set(r,c),e.poke32(a,o),t.SQLITE_OK},xDelete:(i,n,s)=>{let r=e.cstrToJs(n);return z.delete(r),t.SQLITE_OK},xAccess:(i,n,s,r)=>{let o=e.cstrToJs(n);const a=z.has(o);return e.poke32(r,a?1:0),t.SQLITE_OK},xFullPathname:(i,n,s,r)=>e.cstrncpy(r,n,s)<s?t.SQLITE_OK:t.SQLITE_CANTOPEN,xRandomness:(t,i,n)=>{const s=e.heap8u();let r=0;for(;r<i;++r)s[n+r]=255e3*Math.random()&255;return r},xSleep:(e,i)=>t.SQLITE_OK,xCurrentTime:(i,n)=>(e.poke(n,2440587.5+(new Date).getTime()/864e5,"double"),t.SQLITE_OK),xGetLastError:()=>(console.warn("OPFS xGetLastError() has nothing sensible to return."),t.SQLITE_OK)}),$=(e,t)=>({xClose:e=>{const i=M.get(e);return M.delete(e),i.flags&t.SQLITE_OPEN_DELETEONCLOSE&&z.delete(i.name),t.SQLITE_OK},xRead:(i,n,s,r)=>{const o=M.get(i),a=Number(r),l=o.data.subarray(a,a+s);return e.heap8u().set(l,n),l.byteLength<s?(e.heap8u().fill(0,n+l.byteLength,n+s),t.SQLITE_IOERR_SHORT_READ):t.SQLITE_OK},xWrite:(i,n,s,r)=>{const o=M.get(i),a=Number(r);if(a+s>o.data.byteLength)if(o.data.buffer.resizable)o.data.buffer.resize(a+s);else{const e=Math.max(a+s,2*o.data.byteLength),t=new Uint8Array(e);t.set(o.data),o.data=t}const l=e.heap8u().subarray(n,n+s);return o.data.set(l,a),o.size=Math.max(o.size,a+s),t.SQLITE_OK},xTruncate:(e,i)=>{const n=M.get(e),s=Number(i);return n.size=Math.min(n.size,s),n.data.buffer.resizable&&n.data.buffer.resize(s),t.SQLITE_OK},xSync:(e,i)=>t.SQLITE_OK,xFileSize:(i,n)=>{const s=M.get(i);return e.poke64(n,BigInt(s.size)),t.SQLITE_OK},xLock:(e,i)=>(M.get(e).lockType=i,t.SQLITE_OK),xUnlock:(e,i)=>(M.get(e).lockType=i,t.SQLITE_OK),xCheckReservedLock:(i,n)=>{const s=M.get(i);return e.poke(n,s.lockType?1:0,"i32"),t.SQLITE_OK},xFileControl:(e,i,n)=>t.SQLITE_NOTFOUND,xSectorSize:e=>4096,xDeviceCharacteristics:e=>t.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN});var H=(()=>function(e={}){var t,i,n=e,s=new Promise(((e,n)=>{t=e,i=n})),r="object"==typeof window,o="function"==typeof importScripts;"object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node&&process.type;const a=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{}});delete globalThis.sqlite3InitModuleState,a.debugModule("globalThis.location =",globalThis.location);var l,c,u=Object.assign({},n),_="./this.program",f="";(r||o)&&(o?f=self.location.href:"undefined"!=typeof document&&document.currentScript&&(f=document.currentScript.src),f=f.startsWith("blob:")?"":f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1),o&&(c=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),l=e=>fetch(e,{credentials:"same-origin"}).then((e=>e.ok?e.arrayBuffer():Promise.reject(new Error(e.status+" : "+e.url)))));var p=n.print||console.log.bind(console),d=n.printErr||console.error.bind(console);Object.assign(n,u),u=null,n.arguments&&n.arguments,n.thisProgram&&(_=n.thisProgram);var m,h,g,b,y,q,w,x=n.wasmBinary,E=!1;function S(){var e=m.buffer;n.HEAP8=h=new Int8Array(e),n.HEAP16=b=new Int16Array(e),n.HEAPU8=g=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAP32=y=new Int32Array(e),n.HEAPU32=q=new Uint32Array(e),n.HEAPF32=new Float32Array(e),n.HEAPF64=new Float64Array(e),n.HEAP64=w=new BigInt64Array(e),n.HEAPU64=new BigUint64Array(e)}if(n.wasmMemory)m=n.wasmMemory;else{var k=n.INITIAL_MEMORY||16777216;m=new WebAssembly.Memory({initial:k/65536,maximum:32768})}S();var A=[],I=[],T=[];var O=0,F=null;function L(e){O++,n.monitorRunDependencies?.(O)}function P(e){if(O--,n.monitorRunDependencies?.(O),0==O&&F){var t=F;F=null,t()}}function C(e){n.onAbort?.(e),d(e="Aborted("+e+")"),E=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw i(t),t}var N,R=e=>e.startsWith("data:application/octet-stream;base64,");function D(){if(n.locateFile){var e="sqlite3.wasm";return R(e)?e:(t=e,n.locateFile?n.locateFile(t,f):f+t)}var t;return new URL("/assets/sqlite3.wasm",import.meta.url).href}function j(e){if(e==N&&x)return new Uint8Array(x);if(c)return c(e);throw"both async and sync fetching of the wasm failed"}function z(e,t,i){return function(e){return x?Promise.resolve().then((()=>j(e))):l(e).then((e=>new Uint8Array(e)),(()=>j(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then(i,(e=>{d(`failed to asynchronously prepare wasm: ${e}`),C(e)}))}var M=e=>{for(;e.length>0;)e.shift()(n)};n.noExitRuntime;var B={isAbs:e=>"/"===e.charAt(0),splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var i=0,n=e.length-1;n>=0;n--){var s=e[n];"."===s?e.splice(n,1):".."===s?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i;i--)e.unshift("..");return e},normalize:e=>{var t=B.isAbs(e),i="/"===e.substr(-1);return(e=B.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||t||(e="."),e&&i&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=B.splitPath(e),i=t[0],n=t[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},basename:e=>{if("/"===e)return"/";var t=(e=(e=B.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},join:(...e)=>B.normalize(e.join("/")),join2:(e,t)=>B.normalize(e+"/"+t)},U=e=>(U=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);C("initRandomDevice")})())(e),W={resolve:(...e)=>{for(var t="",i=!1,n=e.length-1;n>=-1&&!i;n--){var s=n>=0?e[n]:ie.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");if(!s)return"";t=s+"/"+t,i=B.isAbs(s)}return(i?"/":"")+(t=B.normalizeArray(t.split("/").filter((e=>!!e)),!i).join("/"))||"."},relative:(e,t)=>{function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=W.resolve(e).substr(1),t=W.resolve(t).substr(1);for(var n=i(e.split("/")),s=i(t.split("/")),r=Math.min(n.length,s.length),o=r,a=0;a<r;a++)if(n[a]!==s[a]){o=a;break}var l=[];for(a=o;a<n.length;a++)l.push("..");return(l=l.concat(s.slice(o))).join("/")}},Q="undefined"!=typeof TextDecoder?new TextDecoder:void 0,$=(e,t,i)=>{for(var n=t+i,s=t;e[s]&&!(s>=n);)++s;if(s-t>16&&e.buffer&&Q)return Q.decode(e.subarray(t,s));for(var r="";t<s;){var o=e[t++];if(128&o){var a=63&e[t++];if(192!=(224&o)){var l=63&e[t++];if((o=224==(240&o)?(15&o)<<12|a<<6|l:(7&o)<<18|a<<12|l<<6|63&e[t++])<65536)r+=String.fromCharCode(o);else{var c=o-65536;r+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else r+=String.fromCharCode((31&o)<<6|a)}else r+=String.fromCharCode(o)}return r},H=[],V=e=>{for(var t=0,i=0;i<e.length;++i){var n=e.charCodeAt(i);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++i):t+=3}return t},G=(e,t,i,n)=>{if(!(n>0))return 0;for(var s=i,r=i+n-1,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(a<=127){if(i>=r)break;t[i++]=a}else if(a<=2047){if(i+1>=r)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=r)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=r)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}return t[i]=0,i-s};function K(e,t,i){var n=V(e)+1,s=new Array(n),r=G(e,s,0,s.length);return s.length=r,s}var J={ttys:[],init(){},shutdown(){},register(e,t){J.ttys[e]={input:[],output:[],ops:t},ie.registerDevice(e,J.stream_ops)},stream_ops:{open(e){var t=J.ttys[e.node.rdev];if(!t)throw new ie.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,i,n,s){if(!e.tty||!e.tty.ops.get_char)throw new ie.ErrnoError(60);for(var r=0,o=0;o<n;o++){var a;try{a=e.tty.ops.get_char(e.tty)}catch(l){throw new ie.ErrnoError(29)}if(void 0===a&&0===r)throw new ie.ErrnoError(6);if(null==a)break;r++,t[i+o]=a}return r&&(e.node.timestamp=Date.now()),r},write(e,t,i,n,s){if(!e.tty||!e.tty.ops.put_char)throw new ie.ErrnoError(60);try{for(var r=0;r<n;r++)e.tty.ops.put_char(e.tty,t[i+r])}catch(o){throw new ie.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),r}},default_tty_ops:{get_char:e=>(()=>{if(!H.length){var e=null;if("undefined"!=typeof window&&"function"==typeof window.prompt&&null!==(e=window.prompt("Input: "))&&(e+="\n"),!e)return null;H=K(e)}return H.shift()})(),put_char(e,t){null===t||10===t?(p($(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(p($(e.output,0)),e.output=[])},ioctl_tcgets:e=>({c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}),ioctl_tcsets:(e,t,i)=>0,ioctl_tiocgwinsz:e=>[24,80]},default_tty1_ops:{put_char(e,t){null===t||10===t?(d($(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(d($(e.output,0)),e.output=[])}}},X=(e,t)=>Math.ceil(e/t)*t,Y=e=>{e=X(e,65536);var t=ge(65536,e);return t?((e,t)=>(g.fill(0,e,e+t),e))(t,e):0},Z={ops_table:null,mount:e=>Z.createNode(null,"/",16895,0),createNode(e,t,i,n){if(ie.isBlkdev(i)||ie.isFIFO(i))throw new ie.ErrnoError(63);Z.ops_table||={dir:{node:{getattr:Z.node_ops.getattr,setattr:Z.node_ops.setattr,lookup:Z.node_ops.lookup,mknod:Z.node_ops.mknod,rename:Z.node_ops.rename,unlink:Z.node_ops.unlink,rmdir:Z.node_ops.rmdir,readdir:Z.node_ops.readdir,symlink:Z.node_ops.symlink},stream:{llseek:Z.stream_ops.llseek}},file:{node:{getattr:Z.node_ops.getattr,setattr:Z.node_ops.setattr},stream:{llseek:Z.stream_ops.llseek,read:Z.stream_ops.read,write:Z.stream_ops.write,allocate:Z.stream_ops.allocate,mmap:Z.stream_ops.mmap,msync:Z.stream_ops.msync}},link:{node:{getattr:Z.node_ops.getattr,setattr:Z.node_ops.setattr,readlink:Z.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Z.node_ops.getattr,setattr:Z.node_ops.setattr},stream:ie.chrdev_stream_ops}};var s=ie.createNode(e,t,i,n);return ie.isDir(s.mode)?(s.node_ops=Z.ops_table.dir.node,s.stream_ops=Z.ops_table.dir.stream,s.contents={}):ie.isFile(s.mode)?(s.node_ops=Z.ops_table.file.node,s.stream_ops=Z.ops_table.file.stream,s.usedBytes=0,s.contents=null):ie.isLink(s.mode)?(s.node_ops=Z.ops_table.link.node,s.stream_ops=Z.ops_table.link.stream):ie.isChrdev(s.mode)&&(s.node_ops=Z.ops_table.chrdev.node,s.stream_ops=Z.ops_table.chrdev.stream),s.timestamp=Date.now(),e&&(e.contents[t]=s,e.timestamp=s.timestamp),s},getFileDataAsTypedArray:e=>e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0),expandFileStorage(e,t){var i=e.contents?e.contents.length:0;if(!(i>=t)){t=Math.max(t,i*(i<1048576?2:1.125)>>>0),0!=i&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var i=e.contents;e.contents=new Uint8Array(t),i&&e.contents.set(i.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=ie.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,ie.isDir(e.mode)?t.size=4096:ie.isFile(e.mode)?t.size=e.usedBytes:ie.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Z.resizeFileStorage(e,t.size)},lookup(e,t){throw ie.genericErrors[44]},mknod:(e,t,i,n)=>Z.createNode(e,t,i,n),rename(e,t,i){if(ie.isDir(e.mode)){var n;try{n=ie.lookupNode(t,i)}catch(r){}if(n)for(var s in n.contents)throw new ie.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=i,t.contents[i]=e,t.timestamp=e.parent.timestamp},unlink(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir(e,t){var i=ie.lookupNode(e,t);for(var n in i.contents)throw new ie.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir(e){var t=[".",".."];for(var i of Object.keys(e.contents))t.push(i);return t},symlink(e,t,i){var n=Z.createNode(e,t,41471,0);return n.link=i,n},readlink(e){if(!ie.isLink(e.mode))throw new ie.ErrnoError(28);return e.link}},stream_ops:{read(e,t,i,n,s){var r=e.node.contents;if(s>=e.node.usedBytes)return 0;var o=Math.min(e.node.usedBytes-s,n);if(o>8&&r.subarray)t.set(r.subarray(s,s+o),i);else for(var a=0;a<o;a++)t[i+a]=r[s+a];return o},write(e,t,i,n,s,r){if(t.buffer===h.buffer&&(r=!1),!n)return 0;var o=e.node;if(o.timestamp=Date.now(),t.subarray&&(!o.contents||o.contents.subarray)){if(r)return o.contents=t.subarray(i,i+n),o.usedBytes=n,n;if(0===o.usedBytes&&0===s)return o.contents=t.slice(i,i+n),o.usedBytes=n,n;if(s+n<=o.usedBytes)return o.contents.set(t.subarray(i,i+n),s),n}if(Z.expandFileStorage(o,s+n),o.contents.subarray&&t.subarray)o.contents.set(t.subarray(i,i+n),s);else for(var a=0;a<n;a++)o.contents[s+a]=t[i+a];return o.usedBytes=Math.max(o.usedBytes,s+n),n},llseek(e,t,i){var n=t;if(1===i?n+=e.position:2===i&&ie.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new ie.ErrnoError(28);return n},allocate(e,t,i){Z.expandFileStorage(e.node,t+i),e.node.usedBytes=Math.max(e.node.usedBytes,t+i)},mmap(e,t,i,n,s){if(!ie.isFile(e.node.mode))throw new ie.ErrnoError(43);var r,o,a=e.node.contents;if(2&s||!a||a.buffer!==h.buffer){if(o=!0,!(r=Y(t)))throw new ie.ErrnoError(48);a&&((i>0||i+t<a.length)&&(a=a.subarray?a.subarray(i,i+t):Array.prototype.slice.call(a,i,i+t)),h.set(a,r))}else o=!1,r=a.byteOffset;return{ptr:r,allocated:o}},msync:(e,t,i,n,s)=>(Z.stream_ops.write(e,t,0,n,i,!1),0)}},ee=n.preloadPlugins||[],te=(e,t)=>{var i=0;return e&&(i|=365),t&&(i|=146),i},ie={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:class{constructor(e){this.name="ErrnoError",this.errno=e}},genericErrors:{},filesystems:null,syncFSRequests:0,readFiles:{},FSStream:class{constructor(){this.shared={}}get object(){return this.node}set object(e){this.node=e}get isRead(){return 1!=(2097155&this.flags)}get isWrite(){return!!(2097155&this.flags)}get isAppend(){return 1024&this.flags}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{constructor(e,t,i,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=ie.nextInode++,this.name=t,this.mode=i,this.node_ops={},this.stream_ops={},this.rdev=n,this.readMode=365,this.writeMode=146}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return ie.isDir(this.mode)}get isDevice(){return ie.isChrdev(this.mode)}},lookupPath(e,t={}){if(!(e=W.resolve(e)))return{path:"",node:null};if((t=Object.assign({follow_mount:!0,recurse_count:0},t)).recurse_count>8)throw new ie.ErrnoError(32);for(var i=e.split("/").filter((e=>!!e)),n=ie.root,s="/",r=0;r<i.length;r++){var o=r===i.length-1;if(o&&t.parent)break;if(n=ie.lookupNode(n,i[r]),s=B.join2(s,i[r]),ie.isMountpoint(n)&&(!o||o&&t.follow_mount)&&(n=n.mounted.root),!o||t.follow)for(var a=0;ie.isLink(n.mode);){var l=ie.readlink(s);if(s=W.resolve(B.dirname(s),l),n=ie.lookupPath(s,{recurse_count:t.recurse_count+1}).node,a++>40)throw new ie.ErrnoError(32)}}return{path:s,node:n}},getPath(e){for(var t;;){if(ie.isRoot(e)){var i=e.mount.mountpoint;return t?"/"!==i[i.length-1]?`${i}/${t}`:i+t:i}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var i=0,n=0;n<t.length;n++)i=(i<<5)-i+t.charCodeAt(n)|0;return(e+i>>>0)%ie.nameTable.length},hashAddNode(e){var t=ie.hashName(e.parent.id,e.name);e.name_next=ie.nameTable[t],ie.nameTable[t]=e},hashRemoveNode(e){var t=ie.hashName(e.parent.id,e.name);if(ie.nameTable[t]===e)ie.nameTable[t]=e.name_next;else for(var i=ie.nameTable[t];i;){if(i.name_next===e){i.name_next=e.name_next;break}i=i.name_next}},lookupNode(e,t){var i=ie.mayLookup(e);if(i)throw new ie.ErrnoError(i);for(var n=ie.hashName(e.id,t),s=ie.nameTable[n];s;s=s.name_next){var r=s.name;if(s.parent.id===e.id&&r===t)return s}return ie.lookup(e,t)},createNode(e,t,i,n){var s=new ie.FSNode(e,t,i,n);return ie.hashAddNode(s),s},destroyNode(e){ie.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>32768==(61440&e),isDir:e=>16384==(61440&e),isLink:e=>40960==(61440&e),isChrdev:e=>8192==(61440&e),isBlkdev:e=>24576==(61440&e),isFIFO:e=>4096==(61440&e),isSocket:e=>!(49152&~e),flagsToPermissionString(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:(e,t)=>ie.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2,mayLookup(e){if(!ie.isDir(e.mode))return 54;var t=ie.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate(e,t){try{ie.lookupNode(e,t);return 20}catch(i){}return ie.nodePermissions(e,"wx")},mayDelete(e,t,i){var n;try{n=ie.lookupNode(e,t)}catch(r){return r.errno}var s=ie.nodePermissions(e,"wx");if(s)return s;if(i){if(!ie.isDir(n.mode))return 54;if(ie.isRoot(n)||ie.getPath(n)===ie.cwd())return 10}else if(ie.isDir(n.mode))return 31;return 0},mayOpen:(e,t)=>e?ie.isLink(e.mode)?32:ie.isDir(e.mode)&&("r"!==ie.flagsToPermissionString(t)||512&t)?31:ie.nodePermissions(e,ie.flagsToPermissionString(t)):44,MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=ie.MAX_OPEN_FDS;e++)if(!ie.streams[e])return e;throw new ie.ErrnoError(33)},getStreamChecked(e){var t=ie.getStream(e);if(!t)throw new ie.ErrnoError(8);return t},getStream:e=>ie.streams[e],createStream:(e,t=-1)=>(e=Object.assign(new ie.FSStream,e),-1==t&&(t=ie.nextfd()),e.fd=t,ie.streams[t]=e,e),closeStream(e){ie.streams[e]=null},dupStream(e,t=-1){var i=ie.createStream(e,t);return i.stream_ops?.dup?.(i),i},chrdev_stream_ops:{open(e){var t=ie.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open?.(e)},llseek(){throw new ie.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice(e,t){ie.devices[e]={stream_ops:t}},getDevice:e=>ie.devices[e],getMounts(e){for(var t=[],i=[e];i.length;){var n=i.pop();t.push(n),i.push(...n.mounts)}return t},syncfs(e,t){"function"==typeof e&&(t=e,e=!1),ie.syncFSRequests++,ie.syncFSRequests>1&&d(`warning: ${ie.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var i=ie.getMounts(ie.root.mount),n=0;function s(e){return ie.syncFSRequests--,t(e)}function r(e){if(e)return r.errored?void 0:(r.errored=!0,s(e));++n>=i.length&&s(null)}i.forEach((t=>{if(!t.type.syncfs)return r(null);t.type.syncfs(t,e,r)}))},mount(e,t,i){var n,s="/"===i,r=!i;if(s&&ie.root)throw new ie.ErrnoError(10);if(!s&&!r){var o=ie.lookupPath(i,{follow_mount:!1});if(i=o.path,n=o.node,ie.isMountpoint(n))throw new ie.ErrnoError(10);if(!ie.isDir(n.mode))throw new ie.ErrnoError(54)}var a={type:e,opts:t,mountpoint:i,mounts:[]},l=e.mount(a);return l.mount=a,a.root=l,s?ie.root=l:n&&(n.mounted=a,n.mount&&n.mount.mounts.push(a)),l},unmount(e){var t=ie.lookupPath(e,{follow_mount:!1});if(!ie.isMountpoint(t.node))throw new ie.ErrnoError(28);var i=t.node,n=i.mounted,s=ie.getMounts(n);Object.keys(ie.nameTable).forEach((e=>{for(var t=ie.nameTable[e];t;){var i=t.name_next;s.includes(t.mount)&&ie.destroyNode(t),t=i}})),i.mounted=null;var r=i.mount.mounts.indexOf(n);i.mount.mounts.splice(r,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod(e,t,i){var n=ie.lookupPath(e,{parent:!0}).node,s=B.basename(e);if(!s||"."===s||".."===s)throw new ie.ErrnoError(28);var r=ie.mayCreate(n,s);if(r)throw new ie.ErrnoError(r);if(!n.node_ops.mknod)throw new ie.ErrnoError(63);return n.node_ops.mknod(n,s,t,i)},create:(e,t)=>(t=void 0!==t?t:438,t&=4095,t|=32768,ie.mknod(e,t,0)),mkdir:(e,t)=>(t=void 0!==t?t:511,t&=1023,t|=16384,ie.mknod(e,t,0)),mkdirTree(e,t){for(var i=e.split("/"),n="",s=0;s<i.length;++s)if(i[s]){n+="/"+i[s];try{ie.mkdir(n,t)}catch(r){if(20!=r.errno)throw r}}},mkdev:(e,t,i)=>(void 0===i&&(i=t,t=438),t|=8192,ie.mknod(e,t,i)),symlink(e,t){if(!W.resolve(e))throw new ie.ErrnoError(44);var i=ie.lookupPath(t,{parent:!0}).node;if(!i)throw new ie.ErrnoError(44);var n=B.basename(t),s=ie.mayCreate(i,n);if(s)throw new ie.ErrnoError(s);if(!i.node_ops.symlink)throw new ie.ErrnoError(63);return i.node_ops.symlink(i,n,e)},rename(e,t){var i,n,s=B.dirname(e),r=B.dirname(t),o=B.basename(e),a=B.basename(t);if(i=ie.lookupPath(e,{parent:!0}).node,n=ie.lookupPath(t,{parent:!0}).node,!i||!n)throw new ie.ErrnoError(44);if(i.mount!==n.mount)throw new ie.ErrnoError(75);var l,c=ie.lookupNode(i,o),u=W.relative(e,r);if("."!==u.charAt(0))throw new ie.ErrnoError(28);if("."!==(u=W.relative(t,s)).charAt(0))throw new ie.ErrnoError(55);try{l=ie.lookupNode(n,a)}catch(p){}if(c!==l){var _=ie.isDir(c.mode),f=ie.mayDelete(i,o,_);if(f)throw new ie.ErrnoError(f);if(f=l?ie.mayDelete(n,a,_):ie.mayCreate(n,a))throw new ie.ErrnoError(f);if(!i.node_ops.rename)throw new ie.ErrnoError(63);if(ie.isMountpoint(c)||l&&ie.isMountpoint(l))throw new ie.ErrnoError(10);if(n!==i&&(f=ie.nodePermissions(i,"w")))throw new ie.ErrnoError(f);ie.hashRemoveNode(c);try{i.node_ops.rename(c,n,a),c.parent=n}catch(p){throw p}finally{ie.hashAddNode(c)}}},rmdir(e){var t=ie.lookupPath(e,{parent:!0}).node,i=B.basename(e),n=ie.lookupNode(t,i),s=ie.mayDelete(t,i,!0);if(s)throw new ie.ErrnoError(s);if(!t.node_ops.rmdir)throw new ie.ErrnoError(63);if(ie.isMountpoint(n))throw new ie.ErrnoError(10);t.node_ops.rmdir(t,i),ie.destroyNode(n)},readdir(e){var t=ie.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new ie.ErrnoError(54);return t.node_ops.readdir(t)},unlink(e){var t=ie.lookupPath(e,{parent:!0}).node;if(!t)throw new ie.ErrnoError(44);var i=B.basename(e),n=ie.lookupNode(t,i),s=ie.mayDelete(t,i,!1);if(s)throw new ie.ErrnoError(s);if(!t.node_ops.unlink)throw new ie.ErrnoError(63);if(ie.isMountpoint(n))throw new ie.ErrnoError(10);t.node_ops.unlink(t,i),ie.destroyNode(n)},readlink(e){var t=ie.lookupPath(e).node;if(!t)throw new ie.ErrnoError(44);if(!t.node_ops.readlink)throw new ie.ErrnoError(28);return W.resolve(ie.getPath(t.parent),t.node_ops.readlink(t))},stat(e,t){var i=ie.lookupPath(e,{follow:!t}).node;if(!i)throw new ie.ErrnoError(44);if(!i.node_ops.getattr)throw new ie.ErrnoError(63);return i.node_ops.getattr(i)},lstat:e=>ie.stat(e,!0),chmod(e,t,i){var n;"string"==typeof e?n=ie.lookupPath(e,{follow:!i}).node:n=e;if(!n.node_ops.setattr)throw new ie.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod(e,t){ie.chmod(e,t,!0)},fchmod(e,t){var i=ie.getStreamChecked(e);ie.chmod(i.node,t)},chown(e,t,i,n){var s;"string"==typeof e?s=ie.lookupPath(e,{follow:!n}).node:s=e;if(!s.node_ops.setattr)throw new ie.ErrnoError(63);s.node_ops.setattr(s,{timestamp:Date.now()})},lchown(e,t,i){ie.chown(e,t,i,!0)},fchown(e,t,i){var n=ie.getStreamChecked(e);ie.chown(n.node,t,i)},truncate(e,t){if(t<0)throw new ie.ErrnoError(28);var i;"string"==typeof e?i=ie.lookupPath(e,{follow:!0}).node:i=e;if(!i.node_ops.setattr)throw new ie.ErrnoError(63);if(ie.isDir(i.mode))throw new ie.ErrnoError(31);if(!ie.isFile(i.mode))throw new ie.ErrnoError(28);var n=ie.nodePermissions(i,"w");if(n)throw new ie.ErrnoError(n);i.node_ops.setattr(i,{size:t,timestamp:Date.now()})},ftruncate(e,t){var i=ie.getStreamChecked(e);if(!(2097155&i.flags))throw new ie.ErrnoError(28);ie.truncate(i.node,t)},utime(e,t,i){var n=ie.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,i)})},open(e,t,i){if(""===e)throw new ie.ErrnoError(44);var s;if(i=64&(t="string"==typeof t?(e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(void 0===t)throw new Error(`Unknown file open mode: ${e}`);return t})(t):t)?4095&(i=void 0===i?438:i)|32768:0,"object"==typeof e)s=e;else{e=B.normalize(e);try{s=ie.lookupPath(e,{follow:!(131072&t)}).node}catch(l){}}var r=!1;if(64&t)if(s){if(128&t)throw new ie.ErrnoError(20)}else s=ie.mknod(e,i,0),r=!0;if(!s)throw new ie.ErrnoError(44);if(ie.isChrdev(s.mode)&&(t&=-513),65536&t&&!ie.isDir(s.mode))throw new ie.ErrnoError(54);if(!r){var o=ie.mayOpen(s,t);if(o)throw new ie.ErrnoError(o)}512&t&&!r&&ie.truncate(s,0),t&=-131713;var a=ie.createStream({node:s,path:ie.getPath(s),flags:t,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1});return a.stream_ops.open&&a.stream_ops.open(a),!n.logReadFiles||1&t||e in ie.readFiles||(ie.readFiles[e]=1),a},close(e){if(ie.isClosed(e))throw new ie.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{ie.closeStream(e.fd)}e.fd=null},isClosed:e=>null===e.fd,llseek(e,t,i){if(ie.isClosed(e))throw new ie.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new ie.ErrnoError(70);if(0!=i&&1!=i&&2!=i)throw new ie.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,i),e.ungotten=[],e.position},read(e,t,i,n,s){if(n<0||s<0)throw new ie.ErrnoError(28);if(ie.isClosed(e))throw new ie.ErrnoError(8);if(1==(2097155&e.flags))throw new ie.ErrnoError(8);if(ie.isDir(e.node.mode))throw new ie.ErrnoError(31);if(!e.stream_ops.read)throw new ie.ErrnoError(28);var r=void 0!==s;if(r){if(!e.seekable)throw new ie.ErrnoError(70)}else s=e.position;var o=e.stream_ops.read(e,t,i,n,s);return r||(e.position+=o),o},write(e,t,i,n,s,r){if(n<0||s<0)throw new ie.ErrnoError(28);if(ie.isClosed(e))throw new ie.ErrnoError(8);if(!(2097155&e.flags))throw new ie.ErrnoError(8);if(ie.isDir(e.node.mode))throw new ie.ErrnoError(31);if(!e.stream_ops.write)throw new ie.ErrnoError(28);e.seekable&&1024&e.flags&&ie.llseek(e,0,2);var o=void 0!==s;if(o){if(!e.seekable)throw new ie.ErrnoError(70)}else s=e.position;var a=e.stream_ops.write(e,t,i,n,s,r);return o||(e.position+=a),a},allocate(e,t,i){if(ie.isClosed(e))throw new ie.ErrnoError(8);if(t<0||i<=0)throw new ie.ErrnoError(28);if(!(2097155&e.flags))throw new ie.ErrnoError(8);if(!ie.isFile(e.node.mode)&&!ie.isDir(e.node.mode))throw new ie.ErrnoError(43);if(!e.stream_ops.allocate)throw new ie.ErrnoError(138);e.stream_ops.allocate(e,t,i)},mmap(e,t,i,n,s){if(2&n&&!(2&s)&&2!=(2097155&e.flags))throw new ie.ErrnoError(2);if(1==(2097155&e.flags))throw new ie.ErrnoError(2);if(!e.stream_ops.mmap)throw new ie.ErrnoError(43);if(!t)throw new ie.ErrnoError(28);return e.stream_ops.mmap(e,t,i,n,s)},msync:(e,t,i,n,s)=>e.stream_ops.msync?e.stream_ops.msync(e,t,i,n,s):0,ioctl(e,t,i){if(!e.stream_ops.ioctl)throw new ie.ErrnoError(59);return e.stream_ops.ioctl(e,t,i)},readFile(e,t={}){if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error(`Invalid encoding type "${t.encoding}"`);var i,n=ie.open(e,t.flags),s=ie.stat(e).size,r=new Uint8Array(s);return ie.read(n,r,0,s,0),"utf8"===t.encoding?i=$(r,0):"binary"===t.encoding&&(i=r),ie.close(n),i},writeFile(e,t,i={}){i.flags=i.flags||577;var n=ie.open(e,i.flags,i.mode);if("string"==typeof t){var s=new Uint8Array(V(t)+1),r=G(t,s,0,s.length);ie.write(n,s,0,r,void 0,i.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");ie.write(n,t,0,t.byteLength,void 0,i.canOwn)}ie.close(n)},cwd:()=>ie.currentPath,chdir(e){var t=ie.lookupPath(e,{follow:!0});if(null===t.node)throw new ie.ErrnoError(44);if(!ie.isDir(t.node.mode))throw new ie.ErrnoError(54);var i=ie.nodePermissions(t.node,"x");if(i)throw new ie.ErrnoError(i);ie.currentPath=t.path},createDefaultDirectories(){ie.mkdir("/tmp"),ie.mkdir("/home"),ie.mkdir("/home/web_user")},createDefaultDevices(){ie.mkdir("/dev"),ie.registerDevice(ie.makedev(1,3),{read:()=>0,write:(e,t,i,n,s)=>n}),ie.mkdev("/dev/null",ie.makedev(1,3)),J.register(ie.makedev(5,0),J.default_tty_ops),J.register(ie.makedev(6,0),J.default_tty1_ops),ie.mkdev("/dev/tty",ie.makedev(5,0)),ie.mkdev("/dev/tty1",ie.makedev(6,0));var e=new Uint8Array(1024),t=0,i=()=>(0===t&&(t=U(e).byteLength),e[--t]);ie.createDevice("/dev","random",i),ie.createDevice("/dev","urandom",i),ie.mkdir("/dev/shm"),ie.mkdir("/dev/shm/tmp")},createSpecialDirectories(){ie.mkdir("/proc");var e=ie.mkdir("/proc/self");ie.mkdir("/proc/self/fd"),ie.mount({mount(){var t=ie.createNode(e,"fd",16895,73);return t.node_ops={lookup(e,t){var i=+t,n=ie.getStreamChecked(i),s={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>n.path}};return s.parent=s,s}},t}},{},"/proc/self/fd")},createStandardStreams(e,t,i){e?ie.createDevice("/dev","stdin",e):ie.symlink("/dev/tty","/dev/stdin"),t?ie.createDevice("/dev","stdout",null,t):ie.symlink("/dev/tty","/dev/stdout"),i?ie.createDevice("/dev","stderr",null,i):ie.symlink("/dev/tty1","/dev/stderr"),ie.open("/dev/stdin",0),ie.open("/dev/stdout",1),ie.open("/dev/stderr",1)},staticInit(){[44].forEach((e=>{ie.genericErrors[e]=new ie.ErrnoError(e),ie.genericErrors[e].stack="<generic error, no stack>"})),ie.nameTable=new Array(4096),ie.mount(Z,{},"/"),ie.createDefaultDirectories(),ie.createDefaultDevices(),ie.createSpecialDirectories(),ie.filesystems={MEMFS:Z}},init(e,t,i){ie.initialized=!0,e??=n.stdin,t??=n.stdout,i??=n.stderr,ie.createStandardStreams(e,t,i)},quit(){ie.initialized=!1;for(var e=0;e<ie.streams.length;e++){var t=ie.streams[e];t&&ie.close(t)}},findObject(e,t){var i=ie.analyzePath(e,t);return i.exists?i.object:null},analyzePath(e,t){try{e=(n=ie.lookupPath(e,{follow:!t})).path}catch(s){}var i={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=ie.lookupPath(e,{parent:!0});i.parentExists=!0,i.parentPath=n.path,i.parentObject=n.node,i.name=B.basename(e),n=ie.lookupPath(e,{follow:!t}),i.exists=!0,i.path=n.path,i.object=n.node,i.name=n.node.name,i.isRoot="/"===n.path}catch(s){i.error=s.errno}return i},createPath(e,t,i,n){e="string"==typeof e?e:ie.getPath(e);for(var s=t.split("/").reverse();s.length;){var r=s.pop();if(r){var o=B.join2(e,r);try{ie.mkdir(o)}catch(a){}e=o}}return o},createFile(e,t,i,n,s){var r=B.join2("string"==typeof e?e:ie.getPath(e),t),o=te(n,s);return ie.create(r,o)},createDataFile(e,t,i,n,s,r){var o=t;e&&(e="string"==typeof e?e:ie.getPath(e),o=t?B.join2(e,t):e);var a=te(n,s),l=ie.create(o,a);if(i){if("string"==typeof i){for(var c=new Array(i.length),u=0,_=i.length;u<_;++u)c[u]=i.charCodeAt(u);i=c}ie.chmod(l,146|a);var f=ie.open(l,577);ie.write(f,i,0,i.length,0,r),ie.close(f),ie.chmod(l,a)}},createDevice(e,t,i,n){var s=B.join2("string"==typeof e?e:ie.getPath(e),t),r=te(!!i,!!n);ie.createDevice.major??=64;var o=ie.makedev(ie.createDevice.major++,0);return ie.registerDevice(o,{open(e){e.seekable=!1},close(e){n?.buffer?.length&&n(10)},read(e,t,n,s,r){for(var o=0,a=0;a<s;a++){var l;try{l=i()}catch(c){throw new ie.ErrnoError(29)}if(void 0===l&&0===o)throw new ie.ErrnoError(6);if(null==l)break;o++,t[n+a]=l}return o&&(e.node.timestamp=Date.now()),o},write(e,t,i,s,r){for(var o=0;o<s;o++)try{n(t[i+o])}catch(a){throw new ie.ErrnoError(29)}return s&&(e.node.timestamp=Date.now()),o}}),ie.mkdev(s,r,o)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{e.contents=c(e.url),e.usedBytes=e.contents.length}catch(t){throw new ie.ErrnoError(29)}},createLazyFile(e,t,i,n,s){class r{constructor(){this.lengthKnown=!1,this.chunks=[]}get(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,i=e/this.chunkSize|0;return this.getter(i)[t]}}setDataGetter(e){this.getter=e}cacheLength(){var e=new XMLHttpRequest;if(e.open("HEAD",i,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+i+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),s=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,r=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,o=1048576;s||(o=n);var a=this;a.setDataGetter((e=>{var t=e*o,s=(e+1)*o-1;if(s=Math.min(s,n-1),void 0===a.chunks[e]&&(a.chunks[e]=((e,t)=>{if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var s=new XMLHttpRequest;if(s.open("GET",i,!1),n!==o&&s.setRequestHeader("Range","bytes="+e+"-"+t),s.responseType="arraybuffer",s.overrideMimeType&&s.overrideMimeType("text/plain; charset=x-user-defined"),s.send(null),!(s.status>=200&&s.status<300||304===s.status))throw new Error("Couldn't load "+i+". Status: "+s.status);return void 0!==s.response?new Uint8Array(s.response||[]):K(s.responseText||"")})(t,s)),void 0===a.chunks[e])throw new Error("doXHR failed!");return a.chunks[e]})),!r&&n||(o=n=1,n=this.getter(0).length,o=n,p("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=o,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if("undefined"!=typeof XMLHttpRequest){if(!o)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var a={isDevice:!1,contents:new r}}else a={isDevice:!1,url:i};var l=ie.createFile(e,t,a,n,s);a.contents?l.contents=a.contents:a.url&&(l.contents=null,l.url=a.url),Object.defineProperties(l,{usedBytes:{get:function(){return this.contents.length}}});var c={};function u(e,t,i,n,s){var r=e.node.contents;if(s>=r.length)return 0;var o=Math.min(r.length-s,n);if(r.slice)for(var a=0;a<o;a++)t[i+a]=r[s+a];else for(a=0;a<o;a++)t[i+a]=r.get(s+a);return o}return Object.keys(l.stream_ops).forEach((e=>{var t=l.stream_ops[e];c[e]=(...e)=>(ie.forceLoadFile(l),t(...e))})),c.read=(e,t,i,n,s)=>(ie.forceLoadFile(l),u(e,t,i,n,s)),c.mmap=(e,t,i,n,s)=>{ie.forceLoadFile(l);var r=Y(t);if(!r)throw new ie.ErrnoError(48);return u(e,h,r,t,i),{ptr:r,allocated:!0}},l.stream_ops=c,l}},ne={DEFAULT_POLLMASK:5,calculateAt(e,t,i){if(B.isAbs(t))return t;var n;-100===e?n=ie.cwd():n=ne.getStreamFromFD(e).path;if(0==t.length){if(!i)throw new ie.ErrnoError(44);return n}return B.join2(n,t)},doStat(e,t,i){var n=e(t);y[i>>2]=n.dev,y[i+4>>2]=n.mode,q[i+8>>2]=n.nlink,y[i+12>>2]=n.uid,y[i+16>>2]=n.gid,y[i+20>>2]=n.rdev,w[i+24>>3]=BigInt(n.size),y[i+32>>2]=4096,y[i+36>>2]=n.blocks;var s=n.atime.getTime(),r=n.mtime.getTime(),o=n.ctime.getTime();return w[i+40>>3]=BigInt(Math.floor(s/1e3)),q[i+48>>2]=s%1e3*1e3*1e3,w[i+56>>3]=BigInt(Math.floor(r/1e3)),q[i+64>>2]=r%1e3*1e3*1e3,w[i+72>>3]=BigInt(Math.floor(o/1e3)),q[i+80>>2]=o%1e3*1e3*1e3,w[i+88>>3]=BigInt(n.ino),0},doMsync(e,t,i,n,s){if(!ie.isFile(t.node.mode))throw new ie.ErrnoError(43);if(2&n)return 0;var r=g.slice(e,e+i);ie.msync(t,r,s,i,n)},getStreamFromFD:e=>ie.getStreamChecked(e),varargs:void 0,getStr(e){var t=((e,t)=>e?$(g,e,t):"")(e);return t}};function se(){var e=y[+ne.varargs>>2];return ne.varargs+=4,e}var re=se;var oe=e=>e<-9007199254740992||e>9007199254740992?NaN:Number(e);var ae=(e,t,i)=>G(e,g,t,i);var le=e=>q[e>>2]+4294967296*y[e+4>>2];var ce=[0,31,60,91,121,152,182,213,244,274,305,335],ue=[0,31,59,90,120,151,181,212,243,273,304,334];var _e=e=>{var t=(e-m.buffer.byteLength+65535)/65536;try{return m.grow(t),S(),1}catch(i){}},fe={},pe=()=>{if(!pe.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:_||"./this.program"};for(var t in fe)void 0===fe[t]?delete e[t]:e[t]=fe[t];var i=[];for(var t in e)i.push(`${t}=${e[t]}`);pe.strings=i}return pe.strings};ie.createPreloadedFile=(e,t,i,n,s,r,o,a,c,u)=>{var _=t?W.resolve(B.join2(e,t)):e;function f(i){function l(i){u?.(),a||((e,t,i,n,s,r)=>{ie.createDataFile(e,t,i,n,s,r)})(e,t,i,n,s,c),r?.(),P()}((e,t,i,n)=>{"undefined"!=typeof Browser&&Browser.init();var s=!1;return ee.forEach((r=>{s||r.canHandle(t)&&(r.handle(e,t,i,n),s=!0)})),s})(i,_,l,(()=>{o?.(),P()}))||l(i)}L(),"string"==typeof i?((e,t,i)=>{var n=`al ${e}`;l(e).then((e=>{t(new Uint8Array(e)),n&&P()}),(t=>{if(!i)throw`Loading data file "${e}" failed.`;i()})),n&&L()})(i,f,o):f(i)},ie.staticInit();var de={__syscall_chmod:function(e,t){try{return e=ne.getStr(e),ie.chmod(e,t),0}catch(i){if(void 0===ie||"ErrnoError"!==i.name)throw i;return-i.errno}},__syscall_faccessat:function(e,t,i,n){try{if(t=ne.getStr(t),t=ne.calculateAt(e,t),-8&i)return-28;var s=ie.lookupPath(t,{follow:!0}).node;if(!s)return-44;var r="";return 4&i&&(r+="r"),2&i&&(r+="w"),1&i&&(r+="x"),r&&ie.nodePermissions(s,r)?-2:0}catch(o){if(void 0===ie||"ErrnoError"!==o.name)throw o;return-o.errno}},__syscall_fchmod:function(e,t){try{return ie.fchmod(e,t),0}catch(i){if(void 0===ie||"ErrnoError"!==i.name)throw i;return-i.errno}},__syscall_fchown32:function(e,t,i){try{return ie.fchown(e,t,i),0}catch(n){if(void 0===ie||"ErrnoError"!==n.name)throw n;return-n.errno}},__syscall_fcntl64:function(e,t,i){ne.varargs=i;try{var n=ne.getStreamFromFD(e);switch(t){case 0:if((s=se())<0)return-28;for(;ie.streams[s];)s++;return ie.dupStream(n,s).fd;case 1:case 2:case 13:case 14:return 0;case 3:return n.flags;case 4:var s=se();return n.flags|=s,0;case 12:s=re();return b[s+0>>1]=2,0}return-28}catch(r){if(void 0===ie||"ErrnoError"!==r.name)throw r;return-r.errno}},__syscall_fstat64:function(e,t){try{var i=ne.getStreamFromFD(e);return ne.doStat(ie.stat,i.path,t)}catch(n){if(void 0===ie||"ErrnoError"!==n.name)throw n;return-n.errno}},__syscall_ftruncate64:function(e,t){t=oe(t);try{return isNaN(t)?61:(ie.ftruncate(e,t),0)}catch(i){if(void 0===ie||"ErrnoError"!==i.name)throw i;return-i.errno}},__syscall_getcwd:function(e,t){try{if(0===t)return-28;var i=ie.cwd(),n=V(i)+1;return t<n?-68:(ae(i,e,t),n)}catch(s){if(void 0===ie||"ErrnoError"!==s.name)throw s;return-s.errno}},__syscall_ioctl:function(e,t,i){ne.varargs=i;try{var n=ne.getStreamFromFD(e);switch(t){case 21509:case 21510:case 21511:case 21512:case 21524:case 21515:return n.tty?0:-59;case 21505:if(!n.tty)return-59;if(n.tty.ops.ioctl_tcgets){var s=n.tty.ops.ioctl_tcgets(n),r=re();y[r>>2]=s.c_iflag||0,y[r+4>>2]=s.c_oflag||0,y[r+8>>2]=s.c_cflag||0,y[r+12>>2]=s.c_lflag||0;for(var o=0;o<32;o++)h[r+o+17]=s.c_cc[o]||0;return 0}return 0;case 21506:case 21507:case 21508:if(!n.tty)return-59;if(n.tty.ops.ioctl_tcsets){r=re();var a=y[r>>2],l=y[r+4>>2],c=y[r+8>>2],u=y[r+12>>2],_=[];for(o=0;o<32;o++)_.push(h[r+o+17]);return n.tty.ops.ioctl_tcsets(n.tty,t,{c_iflag:a,c_oflag:l,c_cflag:c,c_lflag:u,c_cc:_})}return 0;case 21519:if(!n.tty)return-59;r=re();return y[r>>2]=0,0;case 21520:return n.tty?-28:-59;case 21531:r=re();return ie.ioctl(n,t,r);case 21523:if(!n.tty)return-59;if(n.tty.ops.ioctl_tiocgwinsz){var f=n.tty.ops.ioctl_tiocgwinsz(n.tty);r=re();b[r>>1]=f[0],b[r+2>>1]=f[1]}return 0;default:return-28}}catch(p){if(void 0===ie||"ErrnoError"!==p.name)throw p;return-p.errno}},__syscall_lstat64:function(e,t){try{return e=ne.getStr(e),ne.doStat(ie.lstat,e,t)}catch(i){if(void 0===ie||"ErrnoError"!==i.name)throw i;return-i.errno}},__syscall_mkdirat:function(e,t,i){try{return t=ne.getStr(t),t=ne.calculateAt(e,t),"/"===(t=B.normalize(t))[t.length-1]&&(t=t.substr(0,t.length-1)),ie.mkdir(t,i,0),0}catch(n){if(void 0===ie||"ErrnoError"!==n.name)throw n;return-n.errno}},__syscall_newfstatat:function(e,t,i,n){try{t=ne.getStr(t);var s=256&n,r=4096&n;return n&=-6401,t=ne.calculateAt(e,t,r),ne.doStat(s?ie.lstat:ie.stat,t,i)}catch(o){if(void 0===ie||"ErrnoError"!==o.name)throw o;return-o.errno}},__syscall_openat:function(e,t,i,n){ne.varargs=n;try{t=ne.getStr(t),t=ne.calculateAt(e,t);var s=n?se():0;return ie.open(t,i,s).fd}catch(r){if(void 0===ie||"ErrnoError"!==r.name)throw r;return-r.errno}},__syscall_readlinkat:function(e,t,i,n){try{if(t=ne.getStr(t),t=ne.calculateAt(e,t),n<=0)return-28;var s=ie.readlink(t),r=Math.min(n,V(s)),o=h[i+r];return ae(s,i,n+1),h[i+r]=o,r}catch(a){if(void 0===ie||"ErrnoError"!==a.name)throw a;return-a.errno}},__syscall_rmdir:function(e){try{return e=ne.getStr(e),ie.rmdir(e),0}catch(t){if(void 0===ie||"ErrnoError"!==t.name)throw t;return-t.errno}},__syscall_stat64:function(e,t){try{return e=ne.getStr(e),ne.doStat(ie.stat,e,t)}catch(i){if(void 0===ie||"ErrnoError"!==i.name)throw i;return-i.errno}},__syscall_unlinkat:function(e,t,i){try{return t=ne.getStr(t),t=ne.calculateAt(e,t),0===i?ie.unlink(t):512===i?ie.rmdir(t):C("Invalid flags passed to unlinkat"),0}catch(n){if(void 0===ie||"ErrnoError"!==n.name)throw n;return-n.errno}},__syscall_utimensat:function(e,t,i,n){try{t=ne.getStr(t),t=ne.calculateAt(e,t,!0);var s,r,o=Date.now();if(i){var a=le(i),l=y[i+8>>2];s=1073741823==l?o:1073741822==l?-1:1e3*a+l/1e6,a=le(i+=16),r=1073741823==(l=y[i+8>>2])?o:1073741822==l?-1:1e3*a+l/1e6}else s=o,r=o;return-1==r&&-1==s||ie.utime(t,s,r),0}catch(c){if(void 0===ie||"ErrnoError"!==c.name)throw c;return-c.errno}},_emscripten_get_now_is_monotonic:()=>1,_localtime_js:function(e,t){e=oe(e);var i=new Date(1e3*e);y[t>>2]=i.getSeconds(),y[t+4>>2]=i.getMinutes(),y[t+8>>2]=i.getHours(),y[t+12>>2]=i.getDate(),y[t+16>>2]=i.getMonth(),y[t+20>>2]=i.getFullYear()-1900,y[t+24>>2]=i.getDay();var n=0|(e=>{var t;return((t=e.getFullYear())%4!=0||t%100==0&&t%400!=0?ue:ce)[e.getMonth()]+e.getDate()-1})(i);y[t+28>>2]=n,y[t+36>>2]=-60*i.getTimezoneOffset();var s=new Date(i.getFullYear(),0,1),r=new Date(i.getFullYear(),6,1).getTimezoneOffset(),o=s.getTimezoneOffset(),a=0|(r!=o&&i.getTimezoneOffset()==Math.min(o,r));y[t+32>>2]=a},_mmap_js:function(e,t,i,n,s,r,o){s=oe(s);try{if(isNaN(s))return 61;var a=ne.getStreamFromFD(n),l=ie.mmap(a,e,s,t,i),c=l.ptr;return y[r>>2]=l.allocated,q[o>>2]=c,0}catch(u){if(void 0===ie||"ErrnoError"!==u.name)throw u;return-u.errno}},_munmap_js:function(e,t,i,n,s,r){r=oe(r);try{var o=ne.getStreamFromFD(s);2&i&&ne.doMsync(e,o,t,n,r)}catch(a){if(void 0===ie||"ErrnoError"!==a.name)throw a;return-a.errno}},_tzset_js:(e,t,i,n)=>{var s=(new Date).getFullYear(),r=new Date(s,0,1),o=new Date(s,6,1),a=r.getTimezoneOffset(),l=o.getTimezoneOffset(),c=Math.max(a,l);q[e>>2]=60*c,y[t>>2]=Number(a!=l);var u=e=>{var t=e>=0?"-":"+",i=Math.abs(e);return`UTC${t}${String(Math.floor(i/60)).padStart(2,"0")}${String(i%60).padStart(2,"0")}`},_=u(a),f=u(l);l<a?(ae(_,i,17),ae(f,n,17)):(ae(_,n,17),ae(f,i,17))},emscripten_date_now:()=>Date.now(),emscripten_get_now:()=>performance.now(),emscripten_resize_heap:e=>{var t=g.length,i=2147483648;if((e>>>=0)>i)return!1;for(var n=1;n<=4;n*=2){var s=t*(1+.2/n);s=Math.min(s,e+100663296);var r=Math.min(i,X(Math.max(e,s),65536));if(_e(r))return!0}return!1},environ_get:(e,t)=>{var i=0;return pe().forEach(((n,s)=>{var r=t+i;q[e+4*s>>2]=r,((e,t)=>{for(var i=0;i<e.length;++i)h[t++]=e.charCodeAt(i);h[t]=0})(n,r),i+=n.length+1})),0},environ_sizes_get:(e,t)=>{var i=pe();q[e>>2]=i.length;var n=0;return i.forEach((e=>n+=e.length+1)),q[t>>2]=n,0},fd_close:function(e){try{var t=ne.getStreamFromFD(e);return ie.close(t),0}catch(i){if(void 0===ie||"ErrnoError"!==i.name)throw i;return i.errno}},fd_fdstat_get:function(e,t){try{var i=ne.getStreamFromFD(e),n=i.tty?2:ie.isDir(i.mode)?3:ie.isLink(i.mode)?7:4;return h[t]=n,b[t+2>>1]=0,w[t+8>>3]=BigInt(0),w[t+16>>3]=BigInt(0),0}catch(s){if(void 0===ie||"ErrnoError"!==s.name)throw s;return s.errno}},fd_read:function(e,t,i,n){try{var s=((e,t,i,n)=>{for(var s=0,r=0;r<i;r++){var o=q[t>>2],a=q[t+4>>2];t+=8;var l=ie.read(e,h,o,a,n);if(l<0)return-1;if(s+=l,l<a)break}return s})(ne.getStreamFromFD(e),t,i);return q[n>>2]=s,0}catch(r){if(void 0===ie||"ErrnoError"!==r.name)throw r;return r.errno}},fd_seek:function(e,t,i,n){t=oe(t);try{if(isNaN(t))return 61;var s=ne.getStreamFromFD(e);return ie.llseek(s,t,i),w[n>>3]=BigInt(s.position),s.getdents&&0===t&&0===i&&(s.getdents=null),0}catch(r){if(void 0===ie||"ErrnoError"!==r.name)throw r;return r.errno}},fd_sync:function(e){try{var t=ne.getStreamFromFD(e);return t.stream_ops?.fsync?t.stream_ops.fsync(t):0}catch(i){if(void 0===ie||"ErrnoError"!==i.name)throw i;return i.errno}},fd_write:function(e,t,i,n){try{var s=((e,t,i,n)=>{for(var s=0,r=0;r<i;r++){var o=q[t>>2],a=q[t+4>>2];t+=8;var l=ie.write(e,h,o,a,n);if(l<0)return-1;if(s+=l,l<a)break}return s})(ne.getStreamFromFD(e),t,i);return q[n>>2]=s,0}catch(r){if(void 0===ie||"ErrnoError"!==r.name)throw r;return r.errno}},memory:m},me=function(){var e,t,s,r,o={env:de,wasi_snapshot_preview1:de};function a(e,t){var i;return me=e.exports,i=me.__wasm_call_ctors,I.unshift(i),P(),me}if(L(),n.instantiateWasm)try{return n.instantiateWasm(o,a)}catch(l){d(`Module.instantiateWasm callback failed with error: ${l}`),i(l)}return N??=D(),(e=x,t=N,s=o,r=function(e){a(e.instance)},e||"function"!=typeof WebAssembly.instantiateStreaming||R(t)||"function"!=typeof fetch?z(t,s,r):fetch(t,{credentials:"same-origin"}).then((e=>WebAssembly.instantiateStreaming(e,s).then(r,(function(e){return d(`wasm streaming compile failed: ${e}`),d("falling back to ArrayBuffer instantiation"),z(t,s,r)}))))).catch(i),{}}();n._sqlite3_status64=(e,t,i,s)=>(n._sqlite3_status64=me.sqlite3_status64)(e,t,i,s),n._sqlite3_status=(e,t,i,s)=>(n._sqlite3_status=me.sqlite3_status)(e,t,i,s),n._sqlite3_db_status=(e,t,i,s,r)=>(n._sqlite3_db_status=me.sqlite3_db_status)(e,t,i,s,r),n._sqlite3_msize=e=>(n._sqlite3_msize=me.sqlite3_msize)(e),n._sqlite3_vfs_find=e=>(n._sqlite3_vfs_find=me.sqlite3_vfs_find)(e),n._sqlite3_initialize=()=>(n._sqlite3_initialize=me.sqlite3_initialize)(),n._sqlite3_malloc=e=>(n._sqlite3_malloc=me.sqlite3_malloc)(e),n._sqlite3_free=e=>(n._sqlite3_free=me.sqlite3_free)(e),n._sqlite3_vfs_register=(e,t)=>(n._sqlite3_vfs_register=me.sqlite3_vfs_register)(e,t),n._sqlite3_vfs_unregister=e=>(n._sqlite3_vfs_unregister=me.sqlite3_vfs_unregister)(e),n._sqlite3_malloc64=e=>(n._sqlite3_malloc64=me.sqlite3_malloc64)(e),n._sqlite3_realloc=(e,t)=>(n._sqlite3_realloc=me.sqlite3_realloc)(e,t),n._sqlite3_realloc64=(e,t)=>(n._sqlite3_realloc64=me.sqlite3_realloc64)(e,t),n._sqlite3_value_text=e=>(n._sqlite3_value_text=me.sqlite3_value_text)(e),n._sqlite3_randomness=(e,t)=>(n._sqlite3_randomness=me.sqlite3_randomness)(e,t),n._sqlite3_stricmp=(e,t)=>(n._sqlite3_stricmp=me.sqlite3_stricmp)(e,t),n._sqlite3_strnicmp=(e,t,i)=>(n._sqlite3_strnicmp=me.sqlite3_strnicmp)(e,t,i),n._sqlite3_uri_parameter=(e,t)=>(n._sqlite3_uri_parameter=me.sqlite3_uri_parameter)(e,t),n._sqlite3_uri_boolean=(e,t,i)=>(n._sqlite3_uri_boolean=me.sqlite3_uri_boolean)(e,t,i),n._sqlite3_serialize=(e,t,i,s)=>(n._sqlite3_serialize=me.sqlite3_serialize)(e,t,i,s),n._sqlite3_prepare_v2=(e,t,i,s,r)=>(n._sqlite3_prepare_v2=me.sqlite3_prepare_v2)(e,t,i,s,r),n._sqlite3_step=e=>(n._sqlite3_step=me.sqlite3_step)(e),n._sqlite3_column_int64=(e,t)=>(n._sqlite3_column_int64=me.sqlite3_column_int64)(e,t),n._sqlite3_reset=e=>(n._sqlite3_reset=me.sqlite3_reset)(e),n._sqlite3_exec=(e,t,i,s,r)=>(n._sqlite3_exec=me.sqlite3_exec)(e,t,i,s,r),n._sqlite3_column_int=(e,t)=>(n._sqlite3_column_int=me.sqlite3_column_int)(e,t),n._sqlite3_finalize=e=>(n._sqlite3_finalize=me.sqlite3_finalize)(e),n._sqlite3_file_control=(e,t,i,s)=>(n._sqlite3_file_control=me.sqlite3_file_control)(e,t,i,s),n._sqlite3_column_name=(e,t)=>(n._sqlite3_column_name=me.sqlite3_column_name)(e,t),n._sqlite3_column_text=(e,t)=>(n._sqlite3_column_text=me.sqlite3_column_text)(e,t),n._sqlite3_column_type=(e,t)=>(n._sqlite3_column_type=me.sqlite3_column_type)(e,t),n._sqlite3_errmsg=e=>(n._sqlite3_errmsg=me.sqlite3_errmsg)(e),n._sqlite3_deserialize=(e,t,i,s,r,o)=>(n._sqlite3_deserialize=me.sqlite3_deserialize)(e,t,i,s,r,o),n._sqlite3_clear_bindings=e=>(n._sqlite3_clear_bindings=me.sqlite3_clear_bindings)(e),n._sqlite3_value_blob=e=>(n._sqlite3_value_blob=me.sqlite3_value_blob)(e),n._sqlite3_value_bytes=e=>(n._sqlite3_value_bytes=me.sqlite3_value_bytes)(e),n._sqlite3_value_double=e=>(n._sqlite3_value_double=me.sqlite3_value_double)(e),n._sqlite3_value_int=e=>(n._sqlite3_value_int=me.sqlite3_value_int)(e),n._sqlite3_value_int64=e=>(n._sqlite3_value_int64=me.sqlite3_value_int64)(e),n._sqlite3_value_subtype=e=>(n._sqlite3_value_subtype=me.sqlite3_value_subtype)(e),n._sqlite3_value_pointer=(e,t)=>(n._sqlite3_value_pointer=me.sqlite3_value_pointer)(e,t),n._sqlite3_value_type=e=>(n._sqlite3_value_type=me.sqlite3_value_type)(e),n._sqlite3_value_nochange=e=>(n._sqlite3_value_nochange=me.sqlite3_value_nochange)(e),n._sqlite3_value_frombind=e=>(n._sqlite3_value_frombind=me.sqlite3_value_frombind)(e),n._sqlite3_value_dup=e=>(n._sqlite3_value_dup=me.sqlite3_value_dup)(e),n._sqlite3_value_free=e=>(n._sqlite3_value_free=me.sqlite3_value_free)(e),n._sqlite3_result_blob=(e,t,i,s)=>(n._sqlite3_result_blob=me.sqlite3_result_blob)(e,t,i,s),n._sqlite3_result_error_toobig=e=>(n._sqlite3_result_error_toobig=me.sqlite3_result_error_toobig)(e),n._sqlite3_result_error_nomem=e=>(n._sqlite3_result_error_nomem=me.sqlite3_result_error_nomem)(e),n._sqlite3_result_double=(e,t)=>(n._sqlite3_result_double=me.sqlite3_result_double)(e,t),n._sqlite3_result_error=(e,t,i)=>(n._sqlite3_result_error=me.sqlite3_result_error)(e,t,i),n._sqlite3_result_int=(e,t)=>(n._sqlite3_result_int=me.sqlite3_result_int)(e,t),n._sqlite3_result_int64=(e,t)=>(n._sqlite3_result_int64=me.sqlite3_result_int64)(e,t),n._sqlite3_result_null=e=>(n._sqlite3_result_null=me.sqlite3_result_null)(e),n._sqlite3_result_pointer=(e,t,i,s)=>(n._sqlite3_result_pointer=me.sqlite3_result_pointer)(e,t,i,s),n._sqlite3_result_subtype=(e,t)=>(n._sqlite3_result_subtype=me.sqlite3_result_subtype)(e,t),n._sqlite3_result_text=(e,t,i,s)=>(n._sqlite3_result_text=me.sqlite3_result_text)(e,t,i,s),n._sqlite3_result_zeroblob=(e,t)=>(n._sqlite3_result_zeroblob=me.sqlite3_result_zeroblob)(e,t),n._sqlite3_result_zeroblob64=(e,t)=>(n._sqlite3_result_zeroblob64=me.sqlite3_result_zeroblob64)(e,t),n._sqlite3_result_error_code=(e,t)=>(n._sqlite3_result_error_code=me.sqlite3_result_error_code)(e,t),n._sqlite3_user_data=e=>(n._sqlite3_user_data=me.sqlite3_user_data)(e),n._sqlite3_context_db_handle=e=>(n._sqlite3_context_db_handle=me.sqlite3_context_db_handle)(e),n._sqlite3_vtab_nochange=e=>(n._sqlite3_vtab_nochange=me.sqlite3_vtab_nochange)(e),n._sqlite3_vtab_in_first=(e,t)=>(n._sqlite3_vtab_in_first=me.sqlite3_vtab_in_first)(e,t),n._sqlite3_vtab_in_next=(e,t)=>(n._sqlite3_vtab_in_next=me.sqlite3_vtab_in_next)(e,t),n._sqlite3_aggregate_context=(e,t)=>(n._sqlite3_aggregate_context=me.sqlite3_aggregate_context)(e,t),n._sqlite3_get_auxdata=(e,t)=>(n._sqlite3_get_auxdata=me.sqlite3_get_auxdata)(e,t),n._sqlite3_set_auxdata=(e,t,i,s)=>(n._sqlite3_set_auxdata=me.sqlite3_set_auxdata)(e,t,i,s),n._sqlite3_column_count=e=>(n._sqlite3_column_count=me.sqlite3_column_count)(e),n._sqlite3_data_count=e=>(n._sqlite3_data_count=me.sqlite3_data_count)(e),n._sqlite3_column_blob=(e,t)=>(n._sqlite3_column_blob=me.sqlite3_column_blob)(e,t),n._sqlite3_column_bytes=(e,t)=>(n._sqlite3_column_bytes=me.sqlite3_column_bytes)(e,t),n._sqlite3_column_double=(e,t)=>(n._sqlite3_column_double=me.sqlite3_column_double)(e,t),n._sqlite3_column_value=(e,t)=>(n._sqlite3_column_value=me.sqlite3_column_value)(e,t),n._sqlite3_column_decltype=(e,t)=>(n._sqlite3_column_decltype=me.sqlite3_column_decltype)(e,t),n._sqlite3_bind_blob=(e,t,i,s,r)=>(n._sqlite3_bind_blob=me.sqlite3_bind_blob)(e,t,i,s,r),n._sqlite3_bind_double=(e,t,i)=>(n._sqlite3_bind_double=me.sqlite3_bind_double)(e,t,i),n._sqlite3_bind_int=(e,t,i)=>(n._sqlite3_bind_int=me.sqlite3_bind_int)(e,t,i),n._sqlite3_bind_int64=(e,t,i)=>(n._sqlite3_bind_int64=me.sqlite3_bind_int64)(e,t,i),n._sqlite3_bind_null=(e,t)=>(n._sqlite3_bind_null=me.sqlite3_bind_null)(e,t),n._sqlite3_bind_pointer=(e,t,i,s,r)=>(n._sqlite3_bind_pointer=me.sqlite3_bind_pointer)(e,t,i,s,r),n._sqlite3_bind_text=(e,t,i,s,r)=>(n._sqlite3_bind_text=me.sqlite3_bind_text)(e,t,i,s,r),n._sqlite3_bind_parameter_count=e=>(n._sqlite3_bind_parameter_count=me.sqlite3_bind_parameter_count)(e),n._sqlite3_bind_parameter_name=(e,t)=>(n._sqlite3_bind_parameter_name=me.sqlite3_bind_parameter_name)(e,t),n._sqlite3_bind_parameter_index=(e,t)=>(n._sqlite3_bind_parameter_index=me.sqlite3_bind_parameter_index)(e,t),n._sqlite3_db_handle=e=>(n._sqlite3_db_handle=me.sqlite3_db_handle)(e),n._sqlite3_stmt_readonly=e=>(n._sqlite3_stmt_readonly=me.sqlite3_stmt_readonly)(e),n._sqlite3_stmt_isexplain=e=>(n._sqlite3_stmt_isexplain=me.sqlite3_stmt_isexplain)(e),n._sqlite3_stmt_explain=(e,t)=>(n._sqlite3_stmt_explain=me.sqlite3_stmt_explain)(e,t),n._sqlite3_stmt_busy=e=>(n._sqlite3_stmt_busy=me.sqlite3_stmt_busy)(e),n._sqlite3_stmt_status=(e,t,i)=>(n._sqlite3_stmt_status=me.sqlite3_stmt_status)(e,t,i),n._sqlite3_sql=e=>(n._sqlite3_sql=me.sqlite3_sql)(e),n._sqlite3_expanded_sql=e=>(n._sqlite3_expanded_sql=me.sqlite3_expanded_sql)(e),n._sqlite3_preupdate_old=(e,t,i)=>(n._sqlite3_preupdate_old=me.sqlite3_preupdate_old)(e,t,i),n._sqlite3_preupdate_count=e=>(n._sqlite3_preupdate_count=me.sqlite3_preupdate_count)(e),n._sqlite3_preupdate_depth=e=>(n._sqlite3_preupdate_depth=me.sqlite3_preupdate_depth)(e),n._sqlite3_preupdate_blobwrite=e=>(n._sqlite3_preupdate_blobwrite=me.sqlite3_preupdate_blobwrite)(e),n._sqlite3_preupdate_new=(e,t,i)=>(n._sqlite3_preupdate_new=me.sqlite3_preupdate_new)(e,t,i),n._sqlite3_value_numeric_type=e=>(n._sqlite3_value_numeric_type=me.sqlite3_value_numeric_type)(e),n._sqlite3_set_authorizer=(e,t,i)=>(n._sqlite3_set_authorizer=me.sqlite3_set_authorizer)(e,t,i),n._sqlite3_strglob=(e,t)=>(n._sqlite3_strglob=me.sqlite3_strglob)(e,t),n._sqlite3_strlike=(e,t,i)=>(n._sqlite3_strlike=me.sqlite3_strlike)(e,t,i),n._sqlite3_auto_extension=e=>(n._sqlite3_auto_extension=me.sqlite3_auto_extension)(e),n._sqlite3_cancel_auto_extension=e=>(n._sqlite3_cancel_auto_extension=me.sqlite3_cancel_auto_extension)(e),n._sqlite3_reset_auto_extension=()=>(n._sqlite3_reset_auto_extension=me.sqlite3_reset_auto_extension)(),n._sqlite3_prepare_v3=(e,t,i,s,r,o)=>(n._sqlite3_prepare_v3=me.sqlite3_prepare_v3)(e,t,i,s,r,o),n._sqlite3_create_module=(e,t,i,s)=>(n._sqlite3_create_module=me.sqlite3_create_module)(e,t,i,s),n._sqlite3_create_module_v2=(e,t,i,s,r)=>(n._sqlite3_create_module_v2=me.sqlite3_create_module_v2)(e,t,i,s,r),n._sqlite3_drop_modules=(e,t)=>(n._sqlite3_drop_modules=me.sqlite3_drop_modules)(e,t),n._sqlite3_declare_vtab=(e,t)=>(n._sqlite3_declare_vtab=me.sqlite3_declare_vtab)(e,t),n._sqlite3_vtab_on_conflict=e=>(n._sqlite3_vtab_on_conflict=me.sqlite3_vtab_on_conflict)(e),n._sqlite3_vtab_collation=(e,t)=>(n._sqlite3_vtab_collation=me.sqlite3_vtab_collation)(e,t),n._sqlite3_vtab_in=(e,t,i)=>(n._sqlite3_vtab_in=me.sqlite3_vtab_in)(e,t,i),n._sqlite3_vtab_rhs_value=(e,t,i)=>(n._sqlite3_vtab_rhs_value=me.sqlite3_vtab_rhs_value)(e,t,i),n._sqlite3_vtab_distinct=e=>(n._sqlite3_vtab_distinct=me.sqlite3_vtab_distinct)(e),n._sqlite3_keyword_name=(e,t,i)=>(n._sqlite3_keyword_name=me.sqlite3_keyword_name)(e,t,i),n._sqlite3_keyword_count=()=>(n._sqlite3_keyword_count=me.sqlite3_keyword_count)(),n._sqlite3_keyword_check=(e,t)=>(n._sqlite3_keyword_check=me.sqlite3_keyword_check)(e,t),n._sqlite3_complete=e=>(n._sqlite3_complete=me.sqlite3_complete)(e),n._sqlite3_libversion=()=>(n._sqlite3_libversion=me.sqlite3_libversion)(),n._sqlite3_libversion_number=()=>(n._sqlite3_libversion_number=me.sqlite3_libversion_number)(),n._sqlite3_shutdown=()=>(n._sqlite3_shutdown=me.sqlite3_shutdown)(),n._sqlite3_last_insert_rowid=e=>(n._sqlite3_last_insert_rowid=me.sqlite3_last_insert_rowid)(e),n._sqlite3_set_last_insert_rowid=(e,t)=>(n._sqlite3_set_last_insert_rowid=me.sqlite3_set_last_insert_rowid)(e,t),n._sqlite3_changes64=e=>(n._sqlite3_changes64=me.sqlite3_changes64)(e),n._sqlite3_changes=e=>(n._sqlite3_changes=me.sqlite3_changes)(e),n._sqlite3_total_changes64=e=>(n._sqlite3_total_changes64=me.sqlite3_total_changes64)(e),n._sqlite3_total_changes=e=>(n._sqlite3_total_changes=me.sqlite3_total_changes)(e),n._sqlite3_txn_state=(e,t)=>(n._sqlite3_txn_state=me.sqlite3_txn_state)(e,t),n._sqlite3_close_v2=e=>(n._sqlite3_close_v2=me.sqlite3_close_v2)(e),n._sqlite3_busy_handler=(e,t,i)=>(n._sqlite3_busy_handler=me.sqlite3_busy_handler)(e,t,i),n._sqlite3_progress_handler=(e,t,i,s)=>(n._sqlite3_progress_handler=me.sqlite3_progress_handler)(e,t,i,s),n._sqlite3_busy_timeout=(e,t)=>(n._sqlite3_busy_timeout=me.sqlite3_busy_timeout)(e,t),n._sqlite3_interrupt=e=>(n._sqlite3_interrupt=me.sqlite3_interrupt)(e),n._sqlite3_is_interrupted=e=>(n._sqlite3_is_interrupted=me.sqlite3_is_interrupted)(e),n._sqlite3_create_function=(e,t,i,s,r,o,a,l)=>(n._sqlite3_create_function=me.sqlite3_create_function)(e,t,i,s,r,o,a,l),n._sqlite3_create_function_v2=(e,t,i,s,r,o,a,l,c)=>(n._sqlite3_create_function_v2=me.sqlite3_create_function_v2)(e,t,i,s,r,o,a,l,c),n._sqlite3_create_window_function=(e,t,i,s,r,o,a,l,c,u)=>(n._sqlite3_create_window_function=me.sqlite3_create_window_function)(e,t,i,s,r,o,a,l,c,u),n._sqlite3_overload_function=(e,t,i)=>(n._sqlite3_overload_function=me.sqlite3_overload_function)(e,t,i),n._sqlite3_trace_v2=(e,t,i,s)=>(n._sqlite3_trace_v2=me.sqlite3_trace_v2)(e,t,i,s),n._sqlite3_commit_hook=(e,t,i)=>(n._sqlite3_commit_hook=me.sqlite3_commit_hook)(e,t,i),n._sqlite3_update_hook=(e,t,i)=>(n._sqlite3_update_hook=me.sqlite3_update_hook)(e,t,i),n._sqlite3_rollback_hook=(e,t,i)=>(n._sqlite3_rollback_hook=me.sqlite3_rollback_hook)(e,t,i),n._sqlite3_preupdate_hook=(e,t,i)=>(n._sqlite3_preupdate_hook=me.sqlite3_preupdate_hook)(e,t,i),n._sqlite3_error_offset=e=>(n._sqlite3_error_offset=me.sqlite3_error_offset)(e),n._sqlite3_errcode=e=>(n._sqlite3_errcode=me.sqlite3_errcode)(e),n._sqlite3_extended_errcode=e=>(n._sqlite3_extended_errcode=me.sqlite3_extended_errcode)(e),n._sqlite3_errstr=e=>(n._sqlite3_errstr=me.sqlite3_errstr)(e),n._sqlite3_limit=(e,t,i)=>(n._sqlite3_limit=me.sqlite3_limit)(e,t,i),n._sqlite3_open=(e,t)=>(n._sqlite3_open=me.sqlite3_open)(e,t),n._sqlite3_open_v2=(e,t,i,s)=>(n._sqlite3_open_v2=me.sqlite3_open_v2)(e,t,i,s),n._sqlite3_create_collation=(e,t,i,s,r)=>(n._sqlite3_create_collation=me.sqlite3_create_collation)(e,t,i,s,r),n._sqlite3_create_collation_v2=(e,t,i,s,r,o)=>(n._sqlite3_create_collation_v2=me.sqlite3_create_collation_v2)(e,t,i,s,r,o),n._sqlite3_collation_needed=(e,t,i)=>(n._sqlite3_collation_needed=me.sqlite3_collation_needed)(e,t,i),n._sqlite3_get_autocommit=e=>(n._sqlite3_get_autocommit=me.sqlite3_get_autocommit)(e),n._sqlite3_table_column_metadata=(e,t,i,s,r,o,a,l,c)=>(n._sqlite3_table_column_metadata=me.sqlite3_table_column_metadata)(e,t,i,s,r,o,a,l,c),n._sqlite3_extended_result_codes=(e,t)=>(n._sqlite3_extended_result_codes=me.sqlite3_extended_result_codes)(e,t),n._sqlite3_uri_key=(e,t)=>(n._sqlite3_uri_key=me.sqlite3_uri_key)(e,t),n._sqlite3_uri_int64=(e,t,i)=>(n._sqlite3_uri_int64=me.sqlite3_uri_int64)(e,t,i),n._sqlite3_db_name=(e,t)=>(n._sqlite3_db_name=me.sqlite3_db_name)(e,t),n._sqlite3_db_filename=(e,t)=>(n._sqlite3_db_filename=me.sqlite3_db_filename)(e,t),n._sqlite3_db_readonly=(e,t)=>(n._sqlite3_db_readonly=me.sqlite3_db_readonly)(e,t),n._sqlite3_compileoption_used=e=>(n._sqlite3_compileoption_used=me.sqlite3_compileoption_used)(e),n._sqlite3_compileoption_get=e=>(n._sqlite3_compileoption_get=me.sqlite3_compileoption_get)(e),n._sqlite3session_diff=(e,t,i,s)=>(n._sqlite3session_diff=me.sqlite3session_diff)(e,t,i,s),n._sqlite3session_attach=(e,t)=>(n._sqlite3session_attach=me.sqlite3session_attach)(e,t),n._sqlite3session_create=(e,t,i)=>(n._sqlite3session_create=me.sqlite3session_create)(e,t,i),n._sqlite3session_delete=e=>(n._sqlite3session_delete=me.sqlite3session_delete)(e),n._sqlite3session_table_filter=(e,t,i)=>(n._sqlite3session_table_filter=me.sqlite3session_table_filter)(e,t,i),n._sqlite3session_changeset=(e,t,i)=>(n._sqlite3session_changeset=me.sqlite3session_changeset)(e,t,i),n._sqlite3session_changeset_strm=(e,t,i)=>(n._sqlite3session_changeset_strm=me.sqlite3session_changeset_strm)(e,t,i),n._sqlite3session_patchset_strm=(e,t,i)=>(n._sqlite3session_patchset_strm=me.sqlite3session_patchset_strm)(e,t,i),n._sqlite3session_patchset=(e,t,i)=>(n._sqlite3session_patchset=me.sqlite3session_patchset)(e,t,i),n._sqlite3session_enable=(e,t)=>(n._sqlite3session_enable=me.sqlite3session_enable)(e,t),n._sqlite3session_indirect=(e,t)=>(n._sqlite3session_indirect=me.sqlite3session_indirect)(e,t),n._sqlite3session_isempty=e=>(n._sqlite3session_isempty=me.sqlite3session_isempty)(e),n._sqlite3session_memory_used=e=>(n._sqlite3session_memory_used=me.sqlite3session_memory_used)(e),n._sqlite3session_object_config=(e,t,i)=>(n._sqlite3session_object_config=me.sqlite3session_object_config)(e,t,i),n._sqlite3session_changeset_size=e=>(n._sqlite3session_changeset_size=me.sqlite3session_changeset_size)(e),n._sqlite3changeset_start=(e,t,i)=>(n._sqlite3changeset_start=me.sqlite3changeset_start)(e,t,i),n._sqlite3changeset_start_v2=(e,t,i,s)=>(n._sqlite3changeset_start_v2=me.sqlite3changeset_start_v2)(e,t,i,s),n._sqlite3changeset_start_strm=(e,t,i)=>(n._sqlite3changeset_start_strm=me.sqlite3changeset_start_strm)(e,t,i),n._sqlite3changeset_start_v2_strm=(e,t,i,s)=>(n._sqlite3changeset_start_v2_strm=me.sqlite3changeset_start_v2_strm)(e,t,i,s),n._sqlite3changeset_next=e=>(n._sqlite3changeset_next=me.sqlite3changeset_next)(e),n._sqlite3changeset_op=(e,t,i,s,r)=>(n._sqlite3changeset_op=me.sqlite3changeset_op)(e,t,i,s,r),n._sqlite3changeset_pk=(e,t,i)=>(n._sqlite3changeset_pk=me.sqlite3changeset_pk)(e,t,i),n._sqlite3changeset_old=(e,t,i)=>(n._sqlite3changeset_old=me.sqlite3changeset_old)(e,t,i),n._sqlite3changeset_new=(e,t,i)=>(n._sqlite3changeset_new=me.sqlite3changeset_new)(e,t,i),n._sqlite3changeset_conflict=(e,t,i)=>(n._sqlite3changeset_conflict=me.sqlite3changeset_conflict)(e,t,i),n._sqlite3changeset_fk_conflicts=(e,t)=>(n._sqlite3changeset_fk_conflicts=me.sqlite3changeset_fk_conflicts)(e,t),n._sqlite3changeset_finalize=e=>(n._sqlite3changeset_finalize=me.sqlite3changeset_finalize)(e),n._sqlite3changeset_invert=(e,t,i,s)=>(n._sqlite3changeset_invert=me.sqlite3changeset_invert)(e,t,i,s),n._sqlite3changeset_invert_strm=(e,t,i,s)=>(n._sqlite3changeset_invert_strm=me.sqlite3changeset_invert_strm)(e,t,i,s),n._sqlite3changeset_apply_v2=(e,t,i,s,r,o,a,l,c)=>(n._sqlite3changeset_apply_v2=me.sqlite3changeset_apply_v2)(e,t,i,s,r,o,a,l,c),n._sqlite3changeset_apply=(e,t,i,s,r,o)=>(n._sqlite3changeset_apply=me.sqlite3changeset_apply)(e,t,i,s,r,o),n._sqlite3changeset_apply_v2_strm=(e,t,i,s,r,o,a,l,c)=>(n._sqlite3changeset_apply_v2_strm=me.sqlite3changeset_apply_v2_strm)(e,t,i,s,r,o,a,l,c),n._sqlite3changeset_apply_strm=(e,t,i,s,r,o)=>(n._sqlite3changeset_apply_strm=me.sqlite3changeset_apply_strm)(e,t,i,s,r,o),n._sqlite3changegroup_new=e=>(n._sqlite3changegroup_new=me.sqlite3changegroup_new)(e),n._sqlite3changegroup_add=(e,t,i)=>(n._sqlite3changegroup_add=me.sqlite3changegroup_add)(e,t,i),n._sqlite3changegroup_output=(e,t,i)=>(n._sqlite3changegroup_output=me.sqlite3changegroup_output)(e,t,i),n._sqlite3changegroup_add_strm=(e,t,i)=>(n._sqlite3changegroup_add_strm=me.sqlite3changegroup_add_strm)(e,t,i),n._sqlite3changegroup_output_strm=(e,t,i)=>(n._sqlite3changegroup_output_strm=me.sqlite3changegroup_output_strm)(e,t,i),n._sqlite3changegroup_delete=e=>(n._sqlite3changegroup_delete=me.sqlite3changegroup_delete)(e),n._sqlite3changeset_concat=(e,t,i,s,r,o)=>(n._sqlite3changeset_concat=me.sqlite3changeset_concat)(e,t,i,s,r,o),n._sqlite3changeset_concat_strm=(e,t,i,s,r,o)=>(n._sqlite3changeset_concat_strm=me.sqlite3changeset_concat_strm)(e,t,i,s,r,o),n._sqlite3session_config=(e,t)=>(n._sqlite3session_config=me.sqlite3session_config)(e,t),n._sqlite3_sourceid=()=>(n._sqlite3_sourceid=me.sqlite3_sourceid)(),n._sqlite3__wasm_pstack_ptr=()=>(n._sqlite3__wasm_pstack_ptr=me.sqlite3__wasm_pstack_ptr)(),n._sqlite3__wasm_pstack_restore=e=>(n._sqlite3__wasm_pstack_restore=me.sqlite3__wasm_pstack_restore)(e),n._sqlite3__wasm_pstack_alloc=e=>(n._sqlite3__wasm_pstack_alloc=me.sqlite3__wasm_pstack_alloc)(e),n._sqlite3__wasm_pstack_remaining=()=>(n._sqlite3__wasm_pstack_remaining=me.sqlite3__wasm_pstack_remaining)(),n._sqlite3__wasm_pstack_quota=()=>(n._sqlite3__wasm_pstack_quota=me.sqlite3__wasm_pstack_quota)(),n._sqlite3__wasm_db_error=(e,t,i)=>(n._sqlite3__wasm_db_error=me.sqlite3__wasm_db_error)(e,t,i),n._sqlite3__wasm_test_struct=e=>(n._sqlite3__wasm_test_struct=me.sqlite3__wasm_test_struct)(e),n._sqlite3__wasm_enum_json=()=>(n._sqlite3__wasm_enum_json=me.sqlite3__wasm_enum_json)(),n._sqlite3__wasm_vfs_unlink=(e,t)=>(n._sqlite3__wasm_vfs_unlink=me.sqlite3__wasm_vfs_unlink)(e,t),n._sqlite3__wasm_db_vfs=(e,t)=>(n._sqlite3__wasm_db_vfs=me.sqlite3__wasm_db_vfs)(e,t),n._sqlite3__wasm_db_reset=e=>(n._sqlite3__wasm_db_reset=me.sqlite3__wasm_db_reset)(e),n._sqlite3__wasm_db_export_chunked=(e,t)=>(n._sqlite3__wasm_db_export_chunked=me.sqlite3__wasm_db_export_chunked)(e,t),n._sqlite3__wasm_db_serialize=(e,t,i,s,r)=>(n._sqlite3__wasm_db_serialize=me.sqlite3__wasm_db_serialize)(e,t,i,s,r),n._sqlite3__wasm_vfs_create_file=(e,t,i,s)=>(n._sqlite3__wasm_vfs_create_file=me.sqlite3__wasm_vfs_create_file)(e,t,i,s),n._sqlite3__wasm_posix_create_file=(e,t,i)=>(n._sqlite3__wasm_posix_create_file=me.sqlite3__wasm_posix_create_file)(e,t,i),n._sqlite3__wasm_kvvfsMakeKeyOnPstack=(e,t)=>(n._sqlite3__wasm_kvvfsMakeKeyOnPstack=me.sqlite3__wasm_kvvfsMakeKeyOnPstack)(e,t),n._sqlite3__wasm_kvvfs_methods=()=>(n._sqlite3__wasm_kvvfs_methods=me.sqlite3__wasm_kvvfs_methods)(),n._sqlite3__wasm_vtab_config=(e,t,i)=>(n._sqlite3__wasm_vtab_config=me.sqlite3__wasm_vtab_config)(e,t,i),n._sqlite3__wasm_db_config_ip=(e,t,i,s)=>(n._sqlite3__wasm_db_config_ip=me.sqlite3__wasm_db_config_ip)(e,t,i,s),n._sqlite3__wasm_db_config_pii=(e,t,i,s,r)=>(n._sqlite3__wasm_db_config_pii=me.sqlite3__wasm_db_config_pii)(e,t,i,s,r),n._sqlite3__wasm_db_config_s=(e,t,i)=>(n._sqlite3__wasm_db_config_s=me.sqlite3__wasm_db_config_s)(e,t,i),n._sqlite3__wasm_config_i=(e,t)=>(n._sqlite3__wasm_config_i=me.sqlite3__wasm_config_i)(e,t),n._sqlite3__wasm_config_ii=(e,t,i)=>(n._sqlite3__wasm_config_ii=me.sqlite3__wasm_config_ii)(e,t,i),n._sqlite3__wasm_config_j=(e,t)=>(n._sqlite3__wasm_config_j=me.sqlite3__wasm_config_j)(e,t),n._sqlite3__wasm_qfmt_token=(e,t)=>(n._sqlite3__wasm_qfmt_token=me.sqlite3__wasm_qfmt_token)(e,t),n._sqlite3__wasm_init_wasmfs=e=>(n._sqlite3__wasm_init_wasmfs=me.sqlite3__wasm_init_wasmfs)(e),n._sqlite3__wasm_test_intptr=e=>(n._sqlite3__wasm_test_intptr=me.sqlite3__wasm_test_intptr)(e),n._sqlite3__wasm_test_voidptr=e=>(n._sqlite3__wasm_test_voidptr=me.sqlite3__wasm_test_voidptr)(e),n._sqlite3__wasm_test_int64_max=()=>(n._sqlite3__wasm_test_int64_max=me.sqlite3__wasm_test_int64_max)(),n._sqlite3__wasm_test_int64_min=()=>(n._sqlite3__wasm_test_int64_min=me.sqlite3__wasm_test_int64_min)(),n._sqlite3__wasm_test_int64_times2=e=>(n._sqlite3__wasm_test_int64_times2=me.sqlite3__wasm_test_int64_times2)(e),n._sqlite3__wasm_test_int64_minmax=(e,t)=>(n._sqlite3__wasm_test_int64_minmax=me.sqlite3__wasm_test_int64_minmax)(e,t),n._sqlite3__wasm_test_int64ptr=e=>(n._sqlite3__wasm_test_int64ptr=me.sqlite3__wasm_test_int64ptr)(e),n._sqlite3__wasm_test_stack_overflow=e=>(n._sqlite3__wasm_test_stack_overflow=me.sqlite3__wasm_test_stack_overflow)(e),n._sqlite3__wasm_test_str_hello=e=>(n._sqlite3__wasm_test_str_hello=me.sqlite3__wasm_test_str_hello)(e),n._sqlite3__wasm_SQLTester_strglob=(e,t)=>(n._sqlite3__wasm_SQLTester_strglob=me.sqlite3__wasm_SQLTester_strglob)(e,t),n._malloc=e=>(n._malloc=me.malloc)(e),n._free=e=>(n._free=me.free)(e),n._realloc=(e,t)=>(n._realloc=me.realloc)(e,t);var he,ge=(e,t)=>(ge=me.emscripten_builtin_memalign)(e,t);function be(){function e(){he||(he=!0,n.calledRun=!0,E||(n.noFSInit||ie.initialized||ie.init(),ie.ignorePermissions=!1,M(I),t(n),n.onRuntimeInitialized?.(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),T.unshift(e);var e;M(T)}()))}O>0||(!function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),A.unshift(e);var e;M(A)}(),O>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((()=>{setTimeout((()=>n.setStatus("")),1),e()}),1)):e()))}if(n.wasmMemory=m,F=function e(){he||be(),he||(F=e)},n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return be(),n.postRun||(n.postRun=[]),n.postRun.push((function(e){if(globalThis.sqlite3ApiBootstrap=function t(i=globalThis.sqlite3ApiConfig||t.defaultConfig){if(t.sqlite3)return(t.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),t.sqlite3;const n=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:!(void 0===e||!e.HEAPU64)||!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},i||{});Object.assign(n,{allocExportName:n.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:n.useStdAlloc?"free":"sqlite3_free",reallocExportName:n.useStdAlloc?"realloc":"sqlite3_realloc"},n),["exports","memory","wasmfsOpfsDir"].forEach((e=>{"function"==typeof n[e]&&(n[e]=n[e]())})),delete globalThis.sqlite3ApiConfig,delete t.defaultConfig;const s=Object.create(null),r=Object.create(null),o=e=>s.sqlite3_js_rc_str&&s.sqlite3_js_rc_str(e)||"Unknown result code #"+e;class a extends Error{constructor(...e){let t;if(e.length)if("number"==typeof(i=e[0])&&i===(0|i))if(t=e[0],1===e.length)super(o(e[0]));else{const i=o(t);"object"==typeof e[1]?super(i,e[1]):(e[0]=i+":",super(e.join(" ")))}else 2===e.length&&"object"==typeof e[1]?super(...e):super(e.join(" "));var i;this.resultCode=t||s.SQLITE_ERROR,this.name="SQLite3Error"}}a.toss=(...e)=>{throw new a(...e)};const l=a.toss;n.wasmfsOpfsDir&&!/^\/[^/]+$/.test(n.wasmfsOpfsDir)&&l("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const c=e=>"bigint"!=typeof e&&!!(e===(0|e)&&e<=2147483647&&e>=-2147483648),u="undefined"==typeof SharedArrayBuffer?function(){}:SharedArrayBuffer,_=e=>e.buffer instanceof u,f=(e,t,i)=>_(e)?e.slice(t,i):e.subarray(t,i),p=e=>e&&(e instanceof Uint8Array||e instanceof Int8Array||e instanceof ArrayBuffer),d=e=>e&&(e instanceof Uint8Array||e instanceof Int8Array||e instanceof ArrayBuffer),m=e=>p(e)||l("Value is not of a supported TypedArray type."),h=new TextDecoder("utf-8"),g=function(e,t,i){return h.decode(f(e,t,i))},b=function(e){return d(e)?g(e instanceof ArrayBuffer?new Uint8Array(e):e):Array.isArray(e)?e.join(""):(r.isPtr(e)&&(e=r.cstrToJs(e)),e)};class y extends Error{constructor(...e){2===e.length&&"object"==typeof e[1]?super(...e):e.length?super(e.join(" ")):super("Allocation failed."),this.resultCode=s.SQLITE_NOMEM,this.name="WasmAllocError"}}y.toss=(...e)=>{throw new y(...e)},Object.assign(s,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(e,t,i,n,s,r,o,a,l)=>{},sqlite3_create_function:(e,t,i,n,s,r,o,a)=>{},sqlite3_create_window_function:(e,t,i,n,s,r,o,a,l,c)=>{},sqlite3_prepare_v3:(e,t,i,n,s,r)=>{},sqlite3_prepare_v2:(e,t,i,n,s)=>{},sqlite3_exec:(e,t,i,n,s)=>{},sqlite3_randomness:(e,t)=>{}});const q={affirmBindableTypedArray:m,flexibleString:b,bigIntFits32:e=>e>=-2147483648n&&e<=0x7fffffffn,bigIntFits64:function e(t){return e._max||(e._max=BigInt("0x7fffffffffffffff"),e._min=~e._max),t>=e._min&&t<=e._max},bigIntFitsDouble:function e(t){return e._min||(e._min=Number.MIN_SAFE_INTEGER,e._max=Number.MAX_SAFE_INTEGER),t>=e._min&&t<=e._max},isBindableTypedArray:p,isInt32:c,isSQLableTypedArray:d,isTypedArray:e=>!!(e&&e.constructor&&c(e.constructor.BYTES_PER_ELEMENT))&&e,typedArrayToString:g,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,isSharedTypedArray:_,toss:function(...e){throw new Error(e.join(" "))},toss3:l,typedArrayPart:f,affirmDbHeader:function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));const t="SQLite format 3";15>e.byteLength&&l("Input does not contain an SQLite3 database header.");for(let i=0;i<15;++i)t.charCodeAt(i)!==e[i]&&l("Input does not contain an SQLite3 database header.")},affirmIsDb:function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));const t=e.byteLength;(t<512||t%512!=0)&&l("Byte array size",t,"is invalid for an SQLite3 db."),q.affirmDbHeader(e)}};Object.assign(r,{ptrSizeof:n.wasmPtrSizeof||4,ptrIR:n.wasmPtrIR||"i32",bigIntEnabled:!!n.bigIntEnabled,exports:n.exports||l("Missing API config.exports (WASM module exports)."),memory:n.memory||n.exports.memory||l("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),alloc:void 0,realloc:void 0,dealloc:void 0}),r.allocFromTypedArray=function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e)),m(e);const t=r.alloc(e.byteLength||1);return r.heapForSize(e.constructor).set(e.byteLength?e:[0],t),t};{const e=n.allocExportName,t=n.deallocExportName,i=n.reallocExportName;for(const n of[e,t,i]){r.exports[n]instanceof Function||l("Missing required exports[",n,"] function.")}r.alloc=function e(t){return e.impl(t)||y.toss("Failed to allocate",t," bytes.")},r.alloc.impl=r.exports[e],r.realloc=function e(t,i){const n=e.impl(t,i);return i?n||y.toss("Failed to reallocate",i," bytes."):0},r.realloc.impl=r.exports[i],r.dealloc=r.exports[t]}let w;if(r.compileOptionUsed=function e(t){if(!arguments.length){if(e._result)return e._result;e._opt||(e._rx=/^([^=]+)=(.+)/,e._rxInt=/^-?\d+$/,e._opt=function(t,i){const n=e._rx.exec(t);i[0]=n?n[1]:t,i[1]=!n||(e._rxInt.test(n[2])?+n[2]:n[2])});const t={},i=[0,0];let n,r=0;for(;n=s.sqlite3_compileoption_get(r++);)e._opt(n,i),t[i[0]]=i[1];return e._result=t}if(Array.isArray(t)){const e={};return t.forEach((t=>{e[t]=s.sqlite3_compileoption_used(t)})),e}return"object"==typeof t?(Object.keys(t).forEach((e=>{t[e]=s.sqlite3_compileoption_used(e)})),t):"string"==typeof t&&!!s.sqlite3_compileoption_used(t)},r.pstack=Object.assign(Object.create(null),{restore:r.exports.sqlite3__wasm_pstack_restore,alloc:function(e){return"string"!=typeof e||(e=r.sizeofIR(e))||y.toss("Invalid value for pstack.alloc(",arguments[0],")"),r.exports.sqlite3__wasm_pstack_alloc(e)||y.toss("Could not allocate",e,"bytes from the pstack.")},allocChunks:function(e,t){"string"!=typeof t||(t=r.sizeofIR(t))||y.toss("Invalid size value for allocChunks(",arguments[1],")");const i=r.pstack.alloc(e*t),n=[];let s=0,o=0;for(;s<e;++s,o+=t)n.push(i+o);return n},allocPtr:(e=1,t=!0)=>1===e?r.pstack.alloc(t?8:r.ptrSizeof):r.pstack.allocChunks(e,t?8:r.ptrSizeof),call:function(e){const t=r.pstack.pointer;try{return e(E)}finally{r.pstack.restore(t)}}}),Object.defineProperties(r.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:r.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:r.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:r.exports.sqlite3__wasm_pstack_remaining}}),s.sqlite3_randomness=(...e)=>{if(1===e.length&&q.isTypedArray(e[0])&&1===e[0].BYTES_PER_ELEMENT){const i=e[0];if(0===i.byteLength)return r.exports.sqlite3_randomness(0,0),i;const n=r.pstack.pointer;try{let e=i.byteLength,t=0;const n=r.exports.sqlite3_randomness,s=r.heap8u(),o=e<512?e:512,a=r.pstack.alloc(o);do{const r=e>o?o:e;n(r,a),i.set(f(s,a,a+r),t),e-=r,t+=r}while(e>0)}catch(t){console.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",t)}finally{r.pstack.restore(n)}return i}r.exports.sqlite3_randomness(...e)},s.sqlite3_wasmfs_opfs_dir=function(){if(void 0!==w)return w;const e=n.wasmfsOpfsDir;if(!(e&&globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle))return w="";try{return w=e&&0===r.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],e)?e:""}catch(t){return w=""}},s.sqlite3_wasmfs_filename_is_persistent=function(e){const t=s.sqlite3_wasmfs_opfs_dir();return!(!t||!e)&&e.startsWith(t+"/")},s.sqlite3_js_db_uses_vfs=function(e,t,i=0){try{const n=s.sqlite3_vfs_find(t);return!!n&&(e?n===s.sqlite3_js_db_vfs(e,i)&&n:n===s.sqlite3_vfs_find(0)&&n)}catch(n){return!1}},s.sqlite3_js_vfs_list=function(){const e=[];let t=s.sqlite3_vfs_find(0);for(;t;){const i=new s.sqlite3_vfs(t);e.push(r.cstrToJs(i.$zName)),t=i.$pNext,i.dispose()}return e},s.sqlite3_js_db_export=function(e,t=0){(e=r.xWrap.testConvertArg("sqlite3*",e))||l("Invalid sqlite3* argument."),r.bigIntEnabled||l("BigInt64 support is not enabled.");const i=r.scopedAllocPush();let n;try{const i=r.scopedAlloc(8+r.ptrSizeof),s=i+8,o=t?r.isPtr(t)?t:r.scopedAllocCString(""+t):0;let a=r.exports.sqlite3__wasm_db_serialize(e,o,s,i,0);a&&l("Database serialization failed with code",E.capi.sqlite3_js_rc_str(a)),n=r.peekPtr(s);const c=r.peek(i,"i64");return a=c?r.heap8u().slice(n,n+Number(c)):new Uint8Array,a}finally{n&&r.exports.sqlite3_free(n),r.scopedAllocPop(i)}},s.sqlite3_js_db_vfs=(e,t=0)=>q.sqlite3__wasm_db_vfs(e,t),s.sqlite3_js_aggregate_context=(e,t)=>s.sqlite3_aggregate_context(e,t)||(t?y.toss("Cannot allocate",t,"bytes for sqlite3_aggregate_context()"):0),s.sqlite3_js_posix_create_file=function(e,t,i){let n;t&&r.isPtr(t)?n=t:t instanceof ArrayBuffer||t instanceof Uint8Array?(n=r.allocFromTypedArray(t),(arguments.length<3||!q.isInt32(i)||i<0)&&(i=t.byteLength)):a.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!q.isInt32(i)||i<0)&&a.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const t=q.sqlite3__wasm_posix_create_file(e,n,i);t&&a.toss("Creation of file failed with sqlite3 result code",s.sqlite3_js_rc_str(t))}finally{r.dealloc(n)}},s.sqlite3_js_vfs_create_file=function(e,t,i,o){let l;n.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternative options."),i?(r.isPtr(i)?l=i:i instanceof ArrayBuffer&&(i=new Uint8Array(i)),i instanceof Uint8Array?(l=r.allocFromTypedArray(i),(arguments.length<4||!q.isInt32(o)||o<0)&&(o=i.byteLength)):a.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):l=0,(!q.isInt32(o)||o<0)&&(r.dealloc(l),a.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const i=q.sqlite3__wasm_vfs_create_file(e,t,l,o);i&&a.toss("Creation of file failed with sqlite3 result code",s.sqlite3_js_rc_str(i))}finally{r.dealloc(l)}},s.sqlite3_js_sql_to_string=e=>{if("string"==typeof e)return e;const t=b(v);return t===v?void 0:t},q.isUIThread()){const e=function(e){const t=Object.create(null);return t.prefix="kvvfs-"+e,t.stores=[],"session"!==e&&""!==e||t.stores.push(globalThis.sessionStorage),"local"!==e&&""!==e||t.stores.push(globalThis.localStorage),t};s.sqlite3_js_kvvfs_clear=function(t=""){let i=0;const n=e(t);return n.stores.forEach((e=>{const t=[];let s;for(s=0;s<e.length;++s){const i=e.key(s);i.startsWith(n.prefix)&&t.push(i)}t.forEach((t=>e.removeItem(t))),i+=t.length})),i},s.sqlite3_js_kvvfs_size=function(t=""){let i=0;const n=e(t);return n.stores.forEach((e=>{let t;for(t=0;t<e.length;++t){const s=e.key(t);s.startsWith(n.prefix)&&(i+=s.length,i+=e.getItem(s).length)}})),2*i}}s.sqlite3_db_config=function(e,t,...i){switch(this.s||(this.s=r.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"]),this.pii=r.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"]),this.ip=r.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),t){case s.SQLITE_DBCONFIG_ENABLE_FKEY:case s.SQLITE_DBCONFIG_ENABLE_TRIGGER:case s.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case s.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case s.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case s.SQLITE_DBCONFIG_ENABLE_QPSG:case s.SQLITE_DBCONFIG_TRIGGER_EQP:case s.SQLITE_DBCONFIG_RESET_DATABASE:case s.SQLITE_DBCONFIG_DEFENSIVE:case s.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case s.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case s.SQLITE_DBCONFIG_DQS_DML:case s.SQLITE_DBCONFIG_DQS_DDL:case s.SQLITE_DBCONFIG_ENABLE_VIEW:case s.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case s.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case s.SQLITE_DBCONFIG_STMT_SCANSTATUS:case s.SQLITE_DBCONFIG_REVERSE_SCANORDER:return this.ip(e,t,i[0],i[1]||0);case s.SQLITE_DBCONFIG_LOOKASIDE:return this.pii(e,t,i[0],i[1],i[2]);case s.SQLITE_DBCONFIG_MAINDBNAME:return this.s(e,t,i[0]);default:return s.SQLITE_MISUSE}}.bind(Object.create(null)),s.sqlite3_value_to_js=function(e,t=!0){let i;const n=s.sqlite3_value_type(e);switch(n){case s.SQLITE_INTEGER:r.bigIntEnabled?(i=s.sqlite3_value_int64(e),q.bigIntFitsDouble(i)&&(i=Number(i))):i=s.sqlite3_value_double(e);break;case s.SQLITE_FLOAT:i=s.sqlite3_value_double(e);break;case s.SQLITE_TEXT:i=s.sqlite3_value_text(e);break;case s.SQLITE_BLOB:{const t=s.sqlite3_value_bytes(e),n=s.sqlite3_value_blob(e);t&&!n&&E.WasmAllocError.toss("Cannot allocate memory for blob argument of",t,"byte(s)"),i=t?r.heap8u().slice(n,n+Number(t)):null;break}case s.SQLITE_NULL:i=null;break;default:t&&l(s.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",n),i=void 0}return i},s.sqlite3_values_to_js=function(e,t,i=!0){let n;const o=[];for(n=0;n<e;++n)o.push(s.sqlite3_value_to_js(r.peekPtr(t+r.ptrSizeof*n),i));return o},s.sqlite3_result_error_js=function(e,t){t instanceof y?s.sqlite3_result_error_nomem(e):s.sqlite3_result_error(e,""+t,-1)},s.sqlite3_result_js=function(e,t){if(t instanceof Error)s.sqlite3_result_error_js(e,t);else try{switch(typeof t){case"undefined":break;case"boolean":s.sqlite3_result_int(e,t?1:0);break;case"bigint":q.bigIntFits32(t)?s.sqlite3_result_int(e,Number(t)):q.bigIntFitsDouble(t)?s.sqlite3_result_double(e,Number(t)):r.bigIntEnabled?q.bigIntFits64(t)?s.sqlite3_result_int64(e,t):l("BigInt value",t.toString(),"is too BigInt for int64."):l("BigInt value",t.toString(),"is too BigInt.");break;case"number":{let i;i=q.isInt32(t)?s.sqlite3_result_int:r.bigIntEnabled&&Number.isInteger(t)&&q.bigIntFits64(BigInt(t))?s.sqlite3_result_int64:s.sqlite3_result_double,i(e,t);break}case"string":{const[i,n]=r.allocCString(t,!0);s.sqlite3_result_text(e,i,n,s.SQLITE_WASM_DEALLOC);break}case"object":if(null===t){s.sqlite3_result_null(e);break}if(q.isBindableTypedArray(t)){const i=r.allocFromTypedArray(t);s.sqlite3_result_blob(e,i,t.byteLength,s.SQLITE_WASM_DEALLOC);break}default:l("Don't not how to handle this UDF result value:",typeof t,t)}}catch(i){s.sqlite3_result_error_js(e,i)}},s.sqlite3_column_js=function(e,t,i=!0){const n=s.sqlite3_column_value(e,t);return 0===n?void 0:s.sqlite3_value_to_js(n,i)};const x=function(e,t,i){i=s[i],this.ptr?r.pokePtr(this.ptr,0):this.ptr=r.allocPtr();const n=i(e,t,this.ptr);if(n)return a.toss(n,arguments[2]+"() failed with code "+n);const o=r.peekPtr(this.ptr);return o?s.sqlite3_value_to_js(o,!0):void 0}.bind(Object.create(null));s.sqlite3_preupdate_new_js=(e,t)=>x(e,t,"sqlite3_preupdate_new"),s.sqlite3_preupdate_old_js=(e,t)=>x(e,t,"sqlite3_preupdate_old"),s.sqlite3changeset_new_js=(e,t)=>x(e,t,"sqlite3changeset_new"),s.sqlite3changeset_old_js=(e,t)=>x(e,t,"sqlite3changeset_old");const E={WasmAllocError:y,SQLite3Error:a,capi:s,util:q,wasm:r,config:n,version:Object.create(null),client:void 0,asyncPostInit:async function e(){if(e.isReady instanceof Promise)return e.isReady;let i=t.initializersAsync;delete t.initializersAsync;const s=async()=>(E.__isUnderTest||(delete E.util,delete E.StructBinder),E),r=e=>{throw n.error("an async sqlite3 initializer failed:",e),e};if(!i||!i.length)return e.isReady=s().catch(r);i=i.map((e=>e instanceof Function?async t=>e(E):e)),i.push(s);let o=Promise.resolve(E);for(;i.length;)o=o.then(i.shift());return e.isReady=o.catch(r)},scriptInfo:void 0};try{t.initializers.forEach((e=>{e(E)}))}catch(S){throw console.error("sqlite3 bootstrap initializer threw:",S),S}return delete t.initializers,t.sqlite3=E,E},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(e){void 0===e.bigIntEnabled&&(e.bigIntEnabled=!!globalThis.BigInt64Array);const t=(...e)=>{throw new Error(e.join(" "))};e.exports||Object.defineProperty(e,"exports",{enumerable:!0,configurable:!0,get:()=>e.instance&&e.instance.exports});const i=e.pointerIR||"i32",n=e.ptrSizeof="i32"===i?4:"i64"===i?8:t("Unhandled ptrSizeof:",i),s=Object.create(null);s.heapSize=0,s.memory=null,s.freeFuncIndexes=[],s.scopedAlloc=[],s.utf8Decoder=new TextDecoder,s.utf8Encoder=new TextEncoder("utf-8"),e.sizeofIR=e=>{switch(e){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return n;default:return(""+e).endsWith("*")?n:void 0}};const r=function(){if(s.memory){if(s.heapSize===s.memory.buffer.byteLength)return s}else s.memory=e.memory instanceof WebAssembly.Memory?e.memory:e.exports.memory;const t=s.memory.buffer;return s.HEAP8=new Int8Array(t),s.HEAP8U=new Uint8Array(t),s.HEAP16=new Int16Array(t),s.HEAP16U=new Uint16Array(t),s.HEAP32=new Int32Array(t),s.HEAP32U=new Uint32Array(t),e.bigIntEnabled&&(s.HEAP64=new BigInt64Array(t),s.HEAP64U=new BigUint64Array(t)),s.HEAP32F=new Float32Array(t),s.HEAP64F=new Float64Array(t),s.heapSize=t.byteLength,s};e.heap8=()=>r().HEAP8,e.heap8u=()=>r().HEAP8U,e.heap16=()=>r().HEAP16,e.heap16u=()=>r().HEAP16U,e.heap32=()=>r().HEAP32,e.heap32u=()=>r().HEAP32U,e.heapForSize=function(i,n=!0){const o=s.memory&&s.heapSize===s.memory.buffer.byteLength?s:r();switch(i){case Int8Array:return o.HEAP8;case Uint8Array:return o.HEAP8U;case Int16Array:return o.HEAP16;case Uint16Array:return o.HEAP16U;case Int32Array:return o.HEAP32;case Uint32Array:return o.HEAP32U;case 8:return n?o.HEAP8U:o.HEAP8;case 16:return n?o.HEAP16U:o.HEAP16;case 32:return n?o.HEAP32U:o.HEAP32;case 64:if(o.HEAP64)return n?o.HEAP64U:o.HEAP64;break;default:if(e.bigIntEnabled){if(i===globalThis.BigUint64Array)return o.HEAP64U;if(i===globalThis.BigInt64Array)return o.HEAP64;break}}t("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")},e.functionTable=function(){return e.exports.__indirect_function_table},e.functionEntry=function(t){const i=e.functionTable();return t<i.length?i.get(t):void 0},e.jsFuncToWasm=function e(i,n){if(e._||(e._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:"i32",P:"i32",s:"i32",j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:function(e,t,i){i<128?e[t](i):e[t](i%128|128,i>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:function(t){const i=e._.rxJSig.exec(t);return i?i[2]:t.substr(1)},letterType:i=>e._.sigTypes[i]||t("Invalid signature letter:",i),pushSigType:(t,i)=>t.push(e._.typeCodes[e._.letterType(i)])}),"string"==typeof i){const e=n;n=i,i=e}const s=e._.sigParams(n),r=[1,96];e._.uleb128Encode(r,"push",s.length);for(const t of s)e._.pushSigType(r,t);return"v"===n[0]?r.push(0):(r.push(1),e._.pushSigType(r,n[0])),e._.uleb128Encode(r,"unshift",r.length),r.unshift(0,97,115,109,1,0,0,0,1),r.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(r)),{e:{f:i}}).exports.f};const o=function(i,n,r){if(r&&!s.scopedAlloc.length&&t("No scopedAllocPush() scope is active."),"string"==typeof i){const e=n;n=i,i=e}"string"==typeof n&&i instanceof Function||t("Invalid arguments: expecting (function,signature) or (signature,function).");const o=e.functionTable(),a=o.length;let l;for(;s.freeFuncIndexes.length&&(l=s.freeFuncIndexes.pop(),o.get(l));)l=null;l||(l=a,o.grow(1));try{return o.set(l,i),r&&s.scopedAlloc[s.scopedAlloc.length-1].push(l),l}catch(c){if(!(c instanceof TypeError))throw l===a&&s.freeFuncIndexes.push(a),c}try{const t=e.jsFuncToWasm(i,n);o.set(l,t),r&&s.scopedAlloc[s.scopedAlloc.length-1].push(l)}catch(c){throw l===a&&s.freeFuncIndexes.push(a),c}return l};e.installFunction=(e,t)=>o(e,t,!1),e.scopedInstallFunction=(e,t)=>o(e,t,!0),e.uninstallFunction=function(t){if(!t&&0!==t)return;const i=s.freeFuncIndexes,n=e.functionTable();i.push(t);const r=n.get(t);return n.set(t,null),r},e.peek=function(n,o="i8"){o.endsWith("*")&&(o=i);const a=s.memory&&s.heapSize===s.memory.buffer.byteLength?s:r(),l=Array.isArray(n)?[]:void 0;let c;do{switch(l&&(n=arguments[0].shift()),o){case"i1":case"i8":c=a.HEAP8[n|0];break;case"i16":c=a.HEAP16[n>>1];break;case"i32":c=a.HEAP32[n>>2];break;case"float":case"f32":c=a.HEAP32F[n>>2];break;case"double":case"f64":c=Number(a.HEAP64F[n>>3]);break;case"i64":if(e.bigIntEnabled){c=BigInt(a.HEAP64[n>>3]);break}default:t("Invalid type for peek():",o)}l&&l.push(c)}while(l&&arguments[0].length);return l||c},e.poke=function(e,n,o="i8"){o.endsWith("*")&&(o=i);const a=s.memory&&s.heapSize===s.memory.buffer.byteLength?s:r();for(const i of Array.isArray(e)?e:[e])switch(o){case"i1":case"i8":a.HEAP8[i|0]=n;continue;case"i16":a.HEAP16[i>>1]=n;continue;case"i32":a.HEAP32[i>>2]=n;continue;case"float":case"f32":a.HEAP32F[i>>2]=n;continue;case"double":case"f64":a.HEAP64F[i>>3]=n;continue;case"i64":if(a.HEAP64){a.HEAP64[i>>3]=BigInt(n);continue}default:t("Invalid type for poke(): "+o)}return this},e.peekPtr=(...t)=>e.peek(1===t.length?t[0]:t,i),e.pokePtr=(t,n=0)=>e.poke(t,n,i),e.peek8=(...t)=>e.peek(1===t.length?t[0]:t,"i8"),e.poke8=(t,i)=>e.poke(t,i,"i8"),e.peek16=(...t)=>e.peek(1===t.length?t[0]:t,"i16"),e.poke16=(t,i)=>e.poke(t,i,"i16"),e.peek32=(...t)=>e.peek(1===t.length?t[0]:t,"i32"),e.poke32=(t,i)=>e.poke(t,i,"i32"),e.peek64=(...t)=>e.peek(1===t.length?t[0]:t,"i64"),e.poke64=(t,i)=>e.poke(t,i,"i64"),e.peek32f=(...t)=>e.peek(1===t.length?t[0]:t,"f32"),e.poke32f=(t,i)=>e.poke(t,i,"f32"),e.peek64f=(...t)=>e.peek(1===t.length?t[0]:t,"f64"),e.poke64f=(t,i)=>e.poke(t,i,"f64"),e.getMemValue=e.peek,e.getPtrValue=e.peekPtr,e.setMemValue=e.poke,e.setPtrValue=e.pokePtr,e.isPtr32=e=>"number"==typeof e&&e===(0|e)&&e>=0,e.isPtr=e.isPtr32,e.cstrlen=function(t){if(!t||!e.isPtr(t))return null;const i=r().HEAP8U;let n=t;for(;0!==i[n];++n);return n-t};const a="undefined"==typeof SharedArrayBuffer?function(){}:SharedArrayBuffer;e.cstrToJs=function(t){const i=e.cstrlen(t);return i?(n=r().HEAP8U,o=t,l=t+i,s.utf8Decoder.decode(n.buffer instanceof a?n.slice(o,l):n.subarray(o,l))):null===i?i:"";var n,o,l},e.jstrlen=function(e){if("string"!=typeof e)return null;const t=e.length;let i=0;for(let n=0;n<t;++n){let t=e.charCodeAt(n);t>=55296&&t<=57343&&(t=65536+((1023&t)<<10)|1023&e.charCodeAt(++n)),t<=127?++i:i+=t<=2047?2:t<=65535?3:4}return i},e.jstrcpy=function(e,i,n=0,s=-1,r=!0){if(i&&(i instanceof Int8Array||i instanceof Uint8Array)||t("jstrcpy() target must be an Int8Array or Uint8Array."),s<0&&(s=i.length-n),!(s>0&&n>=0))return 0;let o=0,a=e.length;const l=n,c=n+s-(r?1:0);for(;o<a&&n<c;++o){let t=e.charCodeAt(o);if(t>=55296&&t<=57343&&(t=65536+((1023&t)<<10)|1023&e.charCodeAt(++o)),t<=127){if(n>=c)break;i[n++]=t}else if(t<=2047){if(n+1>=c)break;i[n++]=192|t>>6,i[n++]=128|63&t}else if(t<=65535){if(n+2>=c)break;i[n++]=224|t>>12,i[n++]=128|t>>6&63,i[n++]=128|63&t}else{if(n+3>=c)break;i[n++]=240|t>>18,i[n++]=128|t>>12&63,i[n++]=128|t>>6&63,i[n++]=128|63&t}}return r&&(i[n++]=0),n-l},e.cstrncpy=function(i,n,s){if(i&&n||t("cstrncpy() does not accept NULL strings."),s<0)s=e.cstrlen(strPtr)+1;else if(!(s>0))return 0;const r=e.heap8u();let o,a=0;for(;a<s&&(o=r[n+a]);++a)r[i+a]=o;return a<s&&(r[i+a++]=0),a},e.jstrToUintArray=(e,t=!1)=>s.utf8Encoder.encode(t?e+"\0":e);const l=(e,i)=>{e.alloc instanceof Function&&e.dealloc instanceof Function||t("Object is missing alloc() and/or dealloc() function(s)","required by",i+"().")},c=function(t,i,n,o){if(l(e,o),"string"!=typeof t)return null;{const e=s.utf8Encoder.encode(t),o=n(e.length+1),a=r().HEAP8U;return a.set(e,o),a[o+e.length]=0,i?[o,e.length]:o}};e.allocCString=(t,i=!1)=>c(t,i,e.alloc,"allocCString()"),e.scopedAllocPush=function(){l(e,"scopedAllocPush");const t=[];return s.scopedAlloc.push(t),t},e.scopedAllocPop=function(i){l(e,"scopedAllocPop");const n=arguments.length?s.scopedAlloc.indexOf(i):s.scopedAlloc.length-1;n<0&&t("Invalid state object for scopedAllocPop()."),0===arguments.length&&(i=s.scopedAlloc[n]),s.scopedAlloc.splice(n,1);for(let t;t=i.pop();)e.functionEntry(t)?e.uninstallFunction(t):e.dealloc(t)},e.scopedAlloc=function(i){s.scopedAlloc.length||t("No scopedAllocPush() scope is active.");const n=e.alloc(i);return s.scopedAlloc[s.scopedAlloc.length-1].push(n),n},Object.defineProperty(e.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>s.scopedAlloc.length,set:()=>t("The 'active' property is read-only.")}),e.scopedAllocCString=(t,i=!1)=>c(t,i,e.scopedAlloc,"scopedAllocCString()");const u=function(t,i){const n=e[t?"scopedAlloc":"alloc"]((i.length+1)*e.ptrSizeof);let s=0;return i.forEach((i=>{e.pokePtr(n+e.ptrSizeof*s++,e[t?"scopedAllocCString":"allocCString"](""+i))})),e.pokePtr(n+e.ptrSizeof*s,0),n};e.scopedAllocMainArgv=e=>u(!0,e),e.allocMainArgv=e=>u(!1,e),e.cArgvToJs=(t,i)=>{const n=[];for(let s=0;s<t;++s){const t=e.peekPtr(i+e.ptrSizeof*s);n.push(t?e.cstrToJs(t):null)}return n},e.scopedAllocCall=function(t){e.scopedAllocPush();try{return t()}finally{e.scopedAllocPop()}};const _=function(t,s,r){l(e,r);const o=s?"i64":i;let a=e[r](t*(s?8:n));if(e.poke(a,0,o),1===t)return a;const c=[a];for(let i=1;i<t;++i)a+=s?8:n,c[i]=a,e.poke(a,0,o);return c};e.allocPtr=(e=1,t=!0)=>_(e,t,"alloc"),e.scopedAllocPtr=(e=1,t=!0)=>_(e,t,"scopedAlloc"),e.xGet=function(i){return e.exports[i]||t("Cannot find exported symbol:",i)};const f=(e,i)=>t(e+"() requires",i,"argument(s).");e.xCall=function(i,...n){const s=i instanceof Function?i:e.xGet(i);return s instanceof Function||t("Exported symbol",i,"is not a function."),s.length!==n.length&&f(s===i?s.name:i,s.length),2===arguments.length&&Array.isArray(arguments[1])?s.apply(null,arguments[1]):s.apply(null,n)},s.xWrap=Object.create(null),s.xWrap.convert=Object.create(null),s.xWrap.convert.arg=new Map,s.xWrap.convert.result=new Map;const p=s.xWrap.convert.arg,d=s.xWrap.convert.result;e.bigIntEnabled&&p.set("i64",(e=>BigInt(e)));const m="i32"===i?e=>0|e:e=>BigInt(e)|BigInt(0);p.set("i32",m).set("i16",(e=>65535&e)).set("i8",(e=>255&e)).set("f32",(e=>Number(e).valueOf())).set("float",p.get("f32")).set("f64",p.get("f32")).set("double",p.get("f64")).set("int",p.get("i32")).set("null",(e=>e)).set(null,p.get("null")).set("**",m).set("*",m),d.set("*",m).set("pointer",m).set("number",(e=>Number(e))).set("void",(e=>{})).set("null",(e=>e)).set(null,d.get("null"));{const n=["i8","i16","i32","int","f32","float","f64","double"];e.bigIntEnabled&&n.push("i64");const s=p.get(i);for(const e of n)p.set(e+"*",s),d.set(e+"*",s),d.set(e,p.get(e)||t("Missing arg converter:",e))}const h=function(t){return"string"==typeof t?e.scopedAllocCString(t):t?m(t):null};p.set("string",h).set("utf8",h).set("pointer",h),d.set("string",(t=>e.cstrToJs(t))).set("utf8",d.get("string")).set("string:dealloc",(t=>{try{return t?e.cstrToJs(t):null}finally{e.dealloc(t)}})).set("utf8:dealloc",d.get("string:dealloc")).set("json",(t=>JSON.parse(e.cstrToJs(t)))).set("json:dealloc",(t=>{try{return t?JSON.parse(e.cstrToJs(t)):null}finally{e.dealloc(t)}}));const g=class{constructor(e){this.name=e.name||"unnamed adapter"}convertArg(e,i,n){t("AbstractArgAdapter must be subclassed.")}};p.FuncPtrAdapter=class i extends g{constructor(e){super(e),p.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",e),this.name=e.name||"unnamed",this.signature=e.signature,e.contextKey instanceof Function&&(this.contextKey=e.contextKey,e.bindScope||(e.bindScope="context")),this.bindScope=e.bindScope||t("FuncPtrAdapter options requires a bindScope (explicit or implied)."),i.bindScopes.indexOf(e.bindScope)<0&&t("Invalid options.bindScope ("+e.bindMod+") for FuncPtrAdapter. Expecting one of: ("+i.bindScopes.join(", ")+")"),this.isTransient="transient"===this.bindScope,this.isContext="context"===this.bindScope,this.isPermanent="permanent"===this.bindScope,this.singleton="singleton"===this.bindScope?[]:void 0,this.callProxy=e.callProxy instanceof Function?e.callProxy:void 0}contextKey(e,t){return this}contextMap(e){const t=this.__cmap||(this.__cmap=new Map);let i=t.get(e);return void 0===i&&t.set(e,i=[]),i}convertArg(t,n,r){let a=this.singleton;if(!a&&this.isContext&&(a=this.contextMap(this.contextKey(n,r))),a&&a[0]===t)return a[1];if(t instanceof Function){this.callProxy&&(t=this.callProxy(t));const e=o(t,this.signature,this.isTransient);if(i.debugFuncInstall&&i.debugOut("FuncPtrAdapter installed",this,this.contextKey(n,r),"@"+e,t),a){if(a[1]){i.debugFuncInstall&&i.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(n,r),"@"+a[1],t);try{s.scopedAlloc[s.scopedAlloc.length-1].push(a[1])}catch(l){}}a[0]=t,a[1]=e}return e}if(e.isPtr(t)||null==t){if(a&&a[1]&&a[1]!==t){i.debugFuncInstall&&i.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(n,r),"@"+a[1],t);try{s.scopedAlloc[s.scopedAlloc.length-1].push(a[1])}catch(l){}a[0]=a[1]=0|t}return t||0}throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},p.FuncPtrAdapter.warnOnUse=!1,p.FuncPtrAdapter.debugFuncInstall=!1,p.FuncPtrAdapter.debugOut=console.debug.bind(console),p.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const b=e=>p.get(e)||t("Argument adapter not found:",e),y=e=>d.get(e)||t("Result adapter not found:",e);s.xWrap.convertArg=(e,...t)=>b(e)(...t),s.xWrap.convertArgNoCheck=(e,...t)=>p.get(e)(...t),s.xWrap.convertResult=(e,t)=>null===e?t:e?y(e)(t):void 0,s.xWrap.convertResultNoCheck=(e,t)=>null===e?t:e?d.get(e)(t):void 0,e.xWrap=function(i,n,...r){3===arguments.length&&Array.isArray(arguments[2])&&(r=arguments[2]),e.isPtr(i)&&(i=e.functionEntry(i)||t("Function pointer not found in WASM function table."));const o=i instanceof Function,a=o?i:e.xGet(i);if(o&&(i=a.name||"unnamed function"),r.length!==a.length&&f(i,a.length),null===n&&0===a.length)return a;null!=n&&y(n);for(const e of r)e instanceof g?p.set(e,((...t)=>e.convertArg(...t))):b(e);const l=s.xWrap;return 0===a.length?(...e)=>e.length?f(i,a.length):l.convertResult(n,a.call(null)):function(...t){t.length!==a.length&&f(i,a.length);const s=e.scopedAllocPush();try{let e=0;for(;e<t.length;++e)t[e]=l.convertArgNoCheck(r[e],t[e],t,e);return l.convertResultNoCheck(n,a.apply(null,t))}finally{e.scopedAllocPop(s)}}};const q=function(e,i,n,s,r,o){if("string"==typeof n){if(1===i)return o.get(n);if(2===i)return s?(s instanceof Function||t(r,"requires a function argument."),o.set(n,s),e):(o.get(n),e)}t("Invalid arguments to",r)};return e.xWrap.resultAdapter=function e(t,i){return q(e,arguments.length,t,i,"resultAdapter()",d)},e.xWrap.argAdapter=function e(t,i){return q(e,arguments.length,t,i,"argAdapter()",p)},e.xWrap.FuncPtrAdapter=p.FuncPtrAdapter,e.xCallWrapped=function(t,i,n,...s){return Array.isArray(arguments[3])&&(s=arguments[3]),e.xWrap(t,i,n||[]).apply(null,s||[])},e.xWrap.testConvertArg=s.xWrap.convertArg,e.xWrap.testConvertResult=s.xWrap.convertResult,e},globalThis.WhWasmUtilInstaller.yawl=function(e){const t=()=>fetch(e.uri,{credentials:"same-origin"}),i=this,n=function(t){if(e.wasmUtilTarget){const n=(...e)=>{throw new Error(e.join(" "))},s=e.wasmUtilTarget;if(s.module=t.module,s.instance=t.instance,s.instance.exports.memory||(s.memory=e.imports&&e.imports.env&&e.imports.env.memory||n("Missing 'memory' object!")),!s.alloc&&t.instance.exports.malloc){const e=t.instance.exports;s.alloc=function(t){return e.malloc(t)||n("Allocation of",t,"bytes failed.")},s.dealloc=function(t){e.free(t)}}i(s)}return e.onload&&e.onload(t,e),t};return WebAssembly.instantiateStreaming?function(){return WebAssembly.instantiateStreaming(t(),e.imports||{}).then(n)}:function(){return t().then((e=>e.arrayBuffer())).then((t=>WebAssembly.instantiate(t,e.imports||{}))).then(n)}}.bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function e(t){const i=(...e)=>{throw new Error(e.join(" "))};t.heap instanceof WebAssembly.Memory||t.heap instanceof Function||i("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach((function(e){t[e]instanceof Function||i("Config option '"+e+"' must be a function.")}));const n=e,s=t.heap instanceof Function?t.heap:()=>new Uint8Array(t.heap.buffer),r=t.alloc,o=t.dealloc,a=t.log||console.log.bind(console),l=t.memberPrefix||"",c=t.memberSuffix||"",u=void 0===t.bigIntEnabled?!!globalThis.BigInt64Array:!!t.bigIntEnabled,_=globalThis.BigInt,f=globalThis.BigInt64Array,p=t.ptrSizeof||4,d=t.ptrIR||"i32";n.debugFlags||(n.__makeDebugFlags=function(e=null){e&&e.__flags&&(e=e.__flags);const t=function e(t){return 0===arguments.length?e.__flags:(t<0?(delete e.__flags.getter,delete e.__flags.setter,delete e.__flags.alloc,delete e.__flags.dealloc):(e.__flags.getter=!!(1&t),e.__flags.setter=!!(2&t),e.__flags.alloc=!!(4&t),e.__flags.dealloc=!!(8&t)),e._flags)};return Object.defineProperty(t,"__flags",{iterable:!1,writable:!1,value:Object.create(e)}),e||t(0),t},n.debugFlags=n.__makeDebugFlags());const m=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}(),h=e=>(e=>"("===e[1])(e)?"p":e[0],g=function(e){switch(h(e)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return d;case"j":return"i64";case"f":return"float";case"d":return"double"}i("Unhandled signature IR:",e)},b=f?()=>!0:()=>i("BigInt64Array is not available."),y=(e,t)=>e+"::"+t,q=new WeakMap,w="(pointer-is-external)",v=function(e,t,i){if(i||(i=q.get(t)),i){if(q.delete(t),Array.isArray(t.ondispose)){let s;for(;s=t.ondispose.shift();)try{s instanceof Function?s.call(t):s instanceof D?s.dispose():"number"==typeof s&&o(s)}catch(n){console.warn("ondispose() for",e.structName,"@",i,"threw. NOT propagating it.",n)}}else if(t.ondispose instanceof Function)try{t.ondispose()}catch(n){console.warn("ondispose() for",e.structName,"@",i,"threw. NOT propagating it.",n)}delete t.ondispose,e.debugFlags.__flags.dealloc&&a("debug.dealloc:",t[w]?"EXTERNAL":"",e.structName,"instance:",e.structInfo.sizeof,"bytes @"+i),t[w]||o(i)}},x=e=>({configurable:!1,writable:!1,iterable:!1,value:e}),E=function(e,t,n){let o=!n;n?Object.defineProperty(t,w,x(n)):(n=r(e.structInfo.sizeof))||i("Allocation of",e.structName,"structure failed.");try{e.debugFlags.__flags.alloc&&a("debug.alloc:",o?"":"EXTERNAL",e.structName,"instance:",e.structInfo.sizeof,"bytes @"+n),o&&s().fill(0,n,n+e.structInfo.sizeof),q.set(t,n)}catch(l){throw v(e,t,n),l}},S=x((e=>l+e+c)),k=function(e,t,n=!0){let s=e.members[t];if(!s&&(l||c)){for(const i of Object.values(e.members))if(i.key===t){s=i;break}!s&&n&&i(y(e.name,t),"is not a mapped struct member.")}return s},A=function e(t,i,n=!1){e._||(e._=e=>e.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const s=k(t.structInfo,i,!0);return n?e._(s.signature):s.signature},I={configurable:!1,enumerable:!1,get:function(){return q.get(this)},set:()=>i("Cannot assign the 'pointer' property of a struct.")},T=x((function(){const e=[];for(const t of Object.keys(this.structInfo.members))e.push(this.memberKey(t));return e})),O=new TextDecoder("utf-8"),F=new TextEncoder,L="undefined"==typeof SharedArrayBuffer?function(){}:SharedArrayBuffer,P=function(e){"s"!==e.signature&&i("Invalid member type signature for C-string value:",JSON.stringify(e))},C=function(e,t){const i=k(e.structInfo,t,!0);P(i);const n=e[i.key];if(!n)return null;let r=n;const o=s();for(;0!==o[r];++r);return n===r?"":(a=o,l=n,c=r,O.decode(a.buffer instanceof L?a.slice(l,c):a.subarray(l,c)));var a,l,c},N=function(e,...t){e.ondispose?Array.isArray(e.ondispose)||(e.ondispose=[e.ondispose]):e.ondispose=[],e.ondispose.push(...t)},R=function(e){const t=F.encode(e),n=r(t.length+1);n||i("Allocation error while duplicating string:",e);const o=s();return o.set(t,n),o[n+t.length]=0,n},D=function(e,t){arguments[2]!==x&&i("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:x(e),structInfo:x(t)})};D.prototype=Object.create(null,{dispose:x((function(){v(this.constructor,this)})),lookupMember:x((function(e,t=!0){return k(this.structInfo,e,t)})),memberToJsString:x((function(e){return C(this,e)})),memberIsString:x((function(e,t=!0){return function(e,t,i=!1){const n=k(e.structInfo,t,i);return!(!n||1!==n.signature.length||"s"!==n.signature[0])&&n}(this,e,t)})),memberKey:S,memberKeys:T,memberSignature:x((function(e,t=!1){return A(this,e,t)})),memoryDump:x((function(){const e=this.pointer;return e?new Uint8Array(s().slice(e,e+this.structInfo.sizeof)):null})),pointer:I,setMemberCString:x((function(e,t){return function(e,t,i){const n=k(e.structInfo,t,!0);P(n);const s=R(i);return e[n.key]=s,N(e,s),e}(this,e,t)}))}),Object.assign(D.prototype,{addOnDispose:function(...e){return N(this,...e),this}}),Object.defineProperties(D,{allocCString:x(R),isA:x((e=>e instanceof D)),hasExternalPointer:x((e=>e instanceof D&&!!e[w])),memberKey:S});const j=e=>Number.isFinite(e)||e instanceof(_||Number),z=function e(t,n,r){if(!e._){e._={getters:{},setters:{},sw:{}};const t=["i","c","C","p","P","s","f","d","v()"];u&&t.push("j"),t.forEach((function(t){e._.getters[t]=function(e){switch(h(e)){case"p":case"P":case"s":switch(p){case 4:return"getInt32";case 8:return b()&&"getBigInt64"}break;case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return b()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}i("Unhandled DataView getter for signature:",e)}(t),e._.setters[t]=function(e){switch(h(e)){case"p":case"P":case"s":switch(p){case 4:return"setInt32";case 8:return b()&&"setBigInt64"}break;case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return b()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}i("Unhandled DataView setter for signature:",e)}(t),e._.sw[t]=function(e){switch(h(e)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return b()&&_;case"p":case"P":case"s":switch(p){case 4:return Number;case 8:return b()&&_}}i("Unhandled DataView set wrapper for signature:",e)}(t)}));const n=/^[ipPsjfdcC]$/,s=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;e.sigCheck=function(e,t,r,o){Object.prototype.hasOwnProperty.call(e,r)&&i(e.structName,"already has a property named",r+"."),n.test(o)||s.test(o)||i("Malformed signature for",y(e.structName,t)+":",o)}}const o=t.memberKey(n);e.sigCheck(t.prototype,n,o,r.signature),r.key=o,r.name=n;const l=h(r.signature),c=y(t.prototype.structName,o),f=t.prototype.debugFlags.__flags,d=Object.create(null);var q,w;d.configurable=!1,d.enumerable=!1,d.get=function(){f.getter&&a("debug.getter:",e._.getters[l],"for",g(l),c,"@",this.pointer,"+",r.offset,"sz",r.sizeof);let t=new DataView(s().buffer,this.pointer+r.offset,r.sizeof)[e._.getters[l]](0,m);return f.getter&&a("debug.getter:",c,"result =",t),t},r.readOnly?d.set=(q=t.prototype.structName,w=o,()=>i(y(q,w),"is read-only.")):d.set=function(t){if(f.setter&&a("debug.setter:",e._.setters[l],"for",g(l),c,"@",this.pointer,"+",r.offset,"sz",r.sizeof,t),this.pointer||i("Cannot set struct property on disposed instance."),null===t)t=0;else for(;!j(t);){if("P"===r.signature&&t instanceof D){t=t.pointer||0,f.setter&&a("debug.setter:",c,"resolved to",t);break}i("Invalid value for pointer-type",c+".")}new DataView(s().buffer,this.pointer+r.offset,r.sizeof)[e._.setters[l]](0,e._.sw[l](t),m)},Object.defineProperty(t.prototype,o,d)},M=function e(t,s){1===arguments.length?t=(s=t).name:s.name||(s.name=t),t||i("Struct name is required.");let r=!1;Object.keys(s.members).forEach((e=>{const n=s.members[e];n.sizeof?1===n.sizeof?"c"===n.signature||"C"===n.signature||i("Unexpected sizeof==1 member",y(s.name,e),"with signature",n.signature):(0!=n.sizeof%4&&(console.warn("Invalid struct member description =",n,"from",s),i(t,"member",e,"sizeof is not aligned. sizeof="+n.sizeof)),0!=n.offset%4&&(console.warn("Invalid struct member description =",n,"from",s),i(t,"member",e,"offset is not aligned. offset="+n.offset))):i(t,"member",e,"is missing sizeof."),(!r||r.offset<n.offset)&&(r=n)})),r?s.sizeof<r.offset+r.sizeof&&i("Invalid struct config:",t,"max member offset ("+r.offset+") ","extends past end of struct (sizeof="+s.sizeof+")."):i("No member property descriptions found.");const o=x(n.__makeDebugFlags(e.debugFlags)),a=function e(n){this instanceof e?arguments.length?((n!==(0|n)||n<=0)&&i("Invalid pointer value for",t,"constructor."),E(e,this,n)):E(e,this):i("The",t,"constructor may only be called via 'new'.")};return Object.defineProperties(a,{debugFlags:o,isA:x((e=>e instanceof a)),memberKey:S,memberKeys:T,methodInfoForKey:x((function(e){})),structInfo:x(s),structName:x(t)}),a.prototype=new D(t,s,x),Object.defineProperties(a.prototype,{debugFlags:o,constructor:x(a)}),Object.keys(s.members).forEach((e=>z(a,e,s.members[e]))),a};return M.StructType=D,M.config=t,M.allocCString=R,M.debugFlags||(M.debugFlags=n.__makeDebugFlags(n.debugFlags)),M},globalThis.sqlite3ApiBootstrap.initializers.push((function(e){const t=(...e)=>{throw new Error(e.join(" "))};e.SQLite3Error.toss;const i=e.capi,n=e.wasm,s=e.util;if(globalThis.WhWasmUtilInstaller(n),delete globalThis.WhWasmUtilInstaller,n.bindingSignatures=[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new n.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(e,t)=>e[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new n.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:e=>e[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new n.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:e=>{let t;return(s,r,o,a)=>{try{const i=n.cArgvToJs(r,o);return t||(t=n.cArgvToJs(r,a)),0|e(i,t)}catch(l){return l.resultCode||i.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new n.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:e=>e[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*",new n.xWrap.FuncPtrAdapter({name:"xDestroyAuxData",signature:"v(*)",contextKey:(e,t)=>e[0]})]],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new n.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(e,t)=>e[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],n.exports.sqlite3_progress_handler&&n.bindingSignatures.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new n.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(e,t)=>e[0]}),"*"]]),n.exports.sqlite3_stmt_explain&&n.bindingSignatures.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),n.exports.sqlite3_set_authorizer&&n.bindingSignatures.push(["sqlite3_set_authorizer","int",["sqlite3*",new n.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(e,t)=>e[0],callProxy:e=>(t,s,r,o,a,l)=>{try{return r=r&&n.cstrToJs(r),o=o&&n.cstrToJs(o),a=a&&n.cstrToJs(a),l=l&&n.cstrToJs(l),e(t,s,r,o,a,l)||0}catch(c){return c.resultCode||i.SQLITE_ERROR}}}),"*"]]),n.bindingSignatures.int64=[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new n.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook",signature:"v(iippj)",contextKey:e=>e[0],callProxy:e=>(t,i,s,r,o)=>{e(t,i,n.cstrToJs(s),n.cstrToJs(r),o)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],n.bigIntEnabled&&n.exports.sqlite3_declare_vtab&&n.bindingSignatures.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),n.bigIntEnabled&&n.exports.sqlite3_preupdate_hook&&n.bindingSignatures.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new n.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:e=>e[0],callProxy:e=>(t,i,s,r,o,a,l)=>{e(t,i,s,n.cstrToJs(r),n.cstrToJs(o),a,l)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),n.bigIntEnabled&&n.exports.sqlite3changegroup_add&&n.exports.sqlite3session_create&&n.exports.sqlite3_preupdate_hook){const e={signature:"i(ps)",callProxy:e=>(t,s)=>{try{return 0|e(t,n.cstrToJs(s))}catch(r){return r.resultCode||i.SQLITE_ERROR}}};n.bindingSignatures.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new n.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new n.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new n.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...e}),new n.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new n.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new n.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...e}),new n.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new n.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...e}),new n.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new n.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new n.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...e}),new n.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new n.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new n.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new n.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new n.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new n.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new n.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new n.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new n.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new n.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new n.xWrap.FuncPtrAdapter({name:"xFilter",...e,contextKey:(e,t)=>e[0]}),"*"]])}n.bindingSignatures.wasmInternal=[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]],e.StructBinder=globalThis.Jaccwabyt({heap:n.heap8u,alloc:n.alloc,dealloc:n.dealloc,bigIntEnabled:n.bigIntEnabled,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const r=n.xWrap.argAdapter("string");n.xWrap.argAdapter("string:flexible",(e=>r(s.flexibleString(e)))),n.xWrap.argAdapter("string:static",function(e){if(n.isPtr(e))return e;return this[e=""+e]||(this[e]=n.allocCString(e))}.bind(Object.create(null)));const o=n.xWrap.argAdapter("*"),a=function(){};n.xWrap.argAdapter("sqlite3_filename",o)("sqlite3_context*",o)("sqlite3_value*",o)("void*",o)("sqlite3_changegroup*",o)("sqlite3_changeset_iter*",o)("sqlite3_session*",o)("sqlite3_stmt*",(t=>o(t instanceof(e?.oo1?.Stmt||a)?t.pointer:t)))("sqlite3*",(t=>o(t instanceof(e?.oo1?.DB||a)?t.pointer:t)))("sqlite3_vfs*",(t=>"string"==typeof t?i.sqlite3_vfs_find(t)||e.SQLite3Error.toss(i.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",t):o(t instanceof(i.sqlite3_vfs||a)?t.pointer:t))),n.exports.sqlite3_declare_vtab&&n.xWrap.argAdapter("sqlite3_index_info*",(e=>o(e instanceof(i.sqlite3_index_info||a)?e.pointer:e)))("sqlite3_module*",(e=>o(e instanceof(i.sqlite3_module||a)?e.pointer:e)));const l=n.xWrap.resultAdapter("*");n.xWrap.resultAdapter("sqlite3*",l)("sqlite3_context*",l)("sqlite3_stmt*",l)("sqlite3_value*",l)("sqlite3_vfs*",l)("void*",l),0===n.exports.sqlite3_step.length&&(n.xWrap.doArgcCheck=!1,e.config.warn("Disabling sqlite3.wasm.xWrap.doArgcCheck due to environmental quirks."));for(const e of n.bindingSignatures)i[e[0]]=n.xWrap.apply(null,e);for(const e of n.bindingSignatures.wasmInternal)s[e[0]]=n.xWrap.apply(null,e);const c=function(e){return()=>t(e+"() is unavailable due to lack","of BigInt support in this build.")};for(const e of n.bindingSignatures.int64)i[e[0]]=n.bigIntEnabled?n.xWrap.apply(null,e):c(e[0]);if(delete n.bindingSignatures,n.exports.sqlite3__wasm_db_error){const t=n.xWrap("sqlite3__wasm_db_error","int","sqlite3*","int","string");s.sqlite3__wasm_db_error=function(n,s,r){return s instanceof e.WasmAllocError?(s=i.SQLITE_NOMEM,r=0):s instanceof Error&&(r=r||""+s,s=s.resultCode||i.SQLITE_ERROR),n?t(n,s,r):s}}else s.sqlite3__wasm_db_error=function(e,t,i){return console.warn("sqlite3__wasm_db_error() is not exported.",arguments),t}}{const r=n.xCall("sqlite3__wasm_enum_json");r||t("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),n.ctype=JSON.parse(n.cstrToJs(r));const o=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];n.bigIntEnabled&&o.push("serialize","session","vtab");for(const e of o)for(const t of Object.entries(n.ctype[e]))i[t[0]]=t[1];n.functionEntry(i.SQLITE_WASM_DEALLOC)||t("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+i.SQLITE_WASM_DEALLOC+").");const a=Object.create(null);for(const e of["resultCodes"])for(const t of Object.entries(n.ctype[e]))a[t[1]]=t[0];i.sqlite3_js_rc_str=e=>a[e];const l=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!s.isUIThread(),sqlite3_index_info:!n.bigIntEnabled,sqlite3_index_constraint:!n.bigIntEnabled,sqlite3_index_orderby:!n.bigIntEnabled,sqlite3_index_constraint_usage:!n.bigIntEnabled});for(const t of n.ctype.structs)l[t.name]||(i[t.name]=e.StructBinder(t));if(i.sqlite3_index_info){for(const e of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])i.sqlite3_index_info[e]=i[e],delete i[e];i.sqlite3_vtab_config=n.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const r=(e,t,n)=>s.sqlite3__wasm_db_error(e,i.SQLITE_MISUSE,t+"() requires "+n+" argument"+(1===n?"":"s")+"."),o=e=>s.sqlite3__wasm_db_error(e,i.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),a=e=>n.xWrap.argAdapter("sqlite3*")(e),l=e=>n.isPtr(e)?n.cstrToJs(e):e,c=function(e,t){e=a(e);let i=this.dbMap.get(e);return t?(!i&&t>0&&this.dbMap.set(e,i=Object.create(null)),i):(this.dbMap.delete(e),i)}.bind(Object.assign(Object.create(null),{dbMap:new Map}));c.addCollation=function(e,t){const i=c(e,1);i.collation||(i.collation=new Set),i.collation.add(l(t).toLowerCase())},c._addUDF=function(e,t,i,n){t=l(t).toLowerCase();let s=n.get(t);s||n.set(t,s=new Set),s.add(i<0?-1:i)},c.addFunction=function(e,t,i){const n=c(e,1);n.udf||(n.udf=new Map),this._addUDF(e,t,i,n.udf)},n.exports.sqlite3_create_window_function&&(c.addWindowFunc=function(e,t,i){const n=c(e,1);n.wudf||(n.wudf=new Map),this._addUDF(e,t,i,n.wudf)}),c.cleanup=function(t){const s=[t=a(t)];for(const a of["sqlite3_busy_handler","sqlite3_commit_hook","sqlite3_preupdate_hook","sqlite3_progress_handler","sqlite3_rollback_hook","sqlite3_set_authorizer","sqlite3_trace_v2","sqlite3_update_hook"]){const t=n.exports[a];if(t){s.length=t.length;try{i[a](...s)}catch(l){e.config.warn("close-time call of",a+"(",s,") threw:",l)}}}const r=c(t,0);if(!r)return;if(r.collation){for(const e of r.collation)try{i.sqlite3_create_collation_v2(t,e,i.SQLITE_UTF8,0,0,0)}catch(l){}delete r.collation}let o;for(o=0;o<2;++o){const e=o?r.wudf:r.udf;if(!e)continue;const n=o?i.sqlite3_create_window_function:i.sqlite3_create_function_v2;for(const s of e){const e=s[0],r=s[1],a=[t,e,0,i.SQLITE_UTF8,0,0,0,0,0];o&&a.push(0);for(const t of r)try{a[2]=t,n.apply(null,a)}catch(u){}r.clear()}e.clear()}delete r.udf,delete r.wudf};{const e=n.xWrap("sqlite3_close_v2","int","sqlite3*");i.sqlite3_close_v2=function(t){if(1!==arguments.length)return r(t,"sqlite3_close_v2",1);if(t)try{c.cleanup(t)}catch(i){}return e(t)}}if(i.sqlite3session_create){const e=n.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);i.sqlite3session_delete=function(t){if(1!==arguments.length)return r(pDb,"sqlite3session_delete",1);t&&i.sqlite3session_table_filter(t,0,0),e(t)}}{const e=(e,t)=>"argv["+t+"]:"+e[0]+":"+n.cstrToJs(e[1]).toLowerCase(),t=n.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new n.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:e}),new n.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:e})]);i.sqlite3_create_collation_v2=function(e,n,a,l,u,_){if(6!==arguments.length)return r(e,"sqlite3_create_collation_v2",6);if(15&a){if(i.SQLITE_UTF8!==(15&a))return o(e)}else a|=i.SQLITE_UTF8;try{const i=t(e,n,a,l,u,_);return 0===i&&u instanceof Function&&c.addCollation(e,n),i}catch(f){return s.sqlite3__wasm_db_error(e,f)}},i.sqlite3_create_collation=(e,t,n,s,o)=>5===arguments.length?i.sqlite3_create_collation_v2(e,t,n,s,o,0):r(e,"sqlite3_create_collation",5)}{const e=function(e,t){return e[0]+":"+(e[2]<0?-1:e[2])+":"+t+":"+n.cstrToJs(e[1]).toLowerCase()},t=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:e,callProxy:e=>(t,n,s)=>{try{e(t,...i.sqlite3_values_to_js(n,s))}catch(r){i.sqlite3_result_error_js(t,r)}}},xFinalAndValue:{signature:"v(p)",contextKey:e,callProxy:e=>t=>{try{i.sqlite3_result_js(t,e(t))}catch(n){i.sqlite3_result_error_js(t,n)}}},xFunc:{signature:"v(pip)",contextKey:e,callProxy:e=>(t,n,s)=>{try{i.sqlite3_result_js(t,e(t,...i.sqlite3_values_to_js(n,s)))}catch(r){i.sqlite3_result_error_js(t,r)}}},xDestroy:{signature:"v(p)",contextKey:e,callProxy:e=>t=>{try{e(t)}catch(i){console.error("UDF xDestroy method threw:",i)}}}}),a=n.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new n.xWrap.FuncPtrAdapter({name:"xFunc",...t.xFunc}),new n.xWrap.FuncPtrAdapter({name:"xStep",...t.xInverseAndStep}),new n.xWrap.FuncPtrAdapter({name:"xFinal",...t.xFinalAndValue}),new n.xWrap.FuncPtrAdapter({name:"xDestroy",...t.xDestroy})]),l=n.exports.sqlite3_create_window_function?n.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new n.xWrap.FuncPtrAdapter({name:"xStep",...t.xInverseAndStep}),new n.xWrap.FuncPtrAdapter({name:"xFinal",...t.xFinalAndValue}),new n.xWrap.FuncPtrAdapter({name:"xValue",...t.xFinalAndValue}),new n.xWrap.FuncPtrAdapter({name:"xInverse",...t.xInverseAndStep}),new n.xWrap.FuncPtrAdapter({name:"xDestroy",...t.xDestroy})]):void 0;i.sqlite3_create_function_v2=function e(t,n,l,u,_,f,p,d,m){if(e.length!==arguments.length)return r(t,"sqlite3_create_function_v2",e.length);if(15&u){if(i.SQLITE_UTF8!==(15&u))return o(t)}else u|=i.SQLITE_UTF8;try{const e=a(t,n,l,u,_,f,p,d,m);return 0===e&&(f instanceof Function||p instanceof Function||d instanceof Function||m instanceof Function)&&c.addFunction(t,n,l),e}catch(h){return console.error("sqlite3_create_function_v2() setup threw:",h),s.sqlite3__wasm_db_error(t,h,"Creation of UDF threw: "+h)}},i.sqlite3_create_function=function e(t,n,s,o,a,l,c,u){return e.length===arguments.length?i.sqlite3_create_function_v2(t,n,s,o,a,l,c,u,0):r(t,"sqlite3_create_function",e.length)},l?i.sqlite3_create_window_function=function e(t,n,a,u,_,f,p,d,m,h){if(e.length!==arguments.length)return r(t,"sqlite3_create_window_function",e.length);if(15&u){if(i.SQLITE_UTF8!==(15&u))return o(t)}else u|=i.SQLITE_UTF8;try{const e=l(t,n,a,u,_,f,p,d,m,h);return 0===e&&(f instanceof Function||p instanceof Function||d instanceof Function||m instanceof Function||h instanceof Function)&&c.addWindowFunc(t,n,a),e}catch(g){return console.error("sqlite3_create_window_function() setup threw:",g),s.sqlite3__wasm_db_error(t,g,"Creation of UDF threw: "+g)}}:delete i.sqlite3_create_window_function,i.sqlite3_create_function_v2.udfSetResult=i.sqlite3_create_function.udfSetResult=i.sqlite3_result_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetResult=i.sqlite3_result_js),i.sqlite3_create_function_v2.udfConvertArgs=i.sqlite3_create_function.udfConvertArgs=i.sqlite3_values_to_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfConvertArgs=i.sqlite3_values_to_js),i.sqlite3_create_function_v2.udfSetError=i.sqlite3_create_function.udfSetError=i.sqlite3_result_error_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetError=i.sqlite3_result_error_js)}{const e=(e,t)=>("string"==typeof e?t=-1:s.isSQLableTypedArray(e)?(t=e.byteLength,e=s.typedArrayToString(e instanceof ArrayBuffer?new Uint8Array(e):e)):Array.isArray(e)&&(e=e.join(""),t=-1),[e,t]),t={basic:n.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:n.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};i.sqlite3_prepare_v3=function n(o,a,l,c,u,_){if(n.length!==arguments.length)return r(o,"sqlite3_prepare_v3",n.length);const[f,p]=e(a,l);switch(typeof f){case"string":return t.basic(o,f,p,c,u,null);case"number":return t.full(o,f,p,c,u,_);default:return s.sqlite3__wasm_db_error(o,i.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3().")}},i.sqlite3_prepare_v2=function e(t,n,s,o,a){return e.length===arguments.length?i.sqlite3_prepare_v3(t,n,s,0,o,a):r(t,"sqlite3_prepare_v2",e.length)}}{const e=n.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),t=n.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);i.sqlite3_bind_text=function t(o,a,l,c,u){if(t.length!==arguments.length)return r(i.sqlite3_db_handle(o),"sqlite3_bind_text",t.length);if(n.isPtr(l)||null===l)return e(o,a,l,c,u);let _,f;l instanceof ArrayBuffer?l=new Uint8Array(l):Array.isArray(pMem)&&(l=pMem.join(""));try{if(s.isSQLableTypedArray(l))_=n.allocFromTypedArray(l),f=l.byteLength;else{if("string"!=typeof l)return s.sqlite3__wasm_db_error(i.sqlite3_db_handle(o),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");[_,f]=n.allocCString(l)}return e(o,a,_,f,i.SQLITE_WASM_DEALLOC)}catch(p){return n.dealloc(_),s.sqlite3__wasm_db_error(i.sqlite3_db_handle(o),p)}},i.sqlite3_bind_blob=function e(o,a,l,c,u){if(e.length!==arguments.length)return r(i.sqlite3_db_handle(o),"sqlite3_bind_blob",e.length);if(n.isPtr(l)||null===l)return t(o,a,l,c,u);let _,f;l instanceof ArrayBuffer?l=new Uint8Array(l):Array.isArray(l)&&(l=l.join(""));try{if(s.isBindableTypedArray(l))_=n.allocFromTypedArray(l),f=c>=0?c:l.byteLength;else{if("string"!=typeof l)return s.sqlite3__wasm_db_error(i.sqlite3_db_handle(o),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");[_,f]=n.allocCString(l)}return t(o,a,_,f,i.SQLITE_WASM_DEALLOC)}catch(p){return n.dealloc(_),s.sqlite3__wasm_db_error(i.sqlite3_db_handle(o),p)}}}i.sqlite3_config=function(e,...t){if(arguments.length<2)return i.SQLITE_MISUSE;switch(e){case i.SQLITE_CONFIG_COVERING_INDEX_SCAN:case i.SQLITE_CONFIG_MEMSTATUS:case i.SQLITE_CONFIG_SMALL_MALLOC:case i.SQLITE_CONFIG_SORTERREF_SIZE:case i.SQLITE_CONFIG_STMTJRNL_SPILL:case i.SQLITE_CONFIG_URI:return n.exports.sqlite3__wasm_config_i(e,t[0]);case i.SQLITE_CONFIG_LOOKASIDE:return n.exports.sqlite3__wasm_config_ii(e,t[0],t[1]);case i.SQLITE_CONFIG_MEMDB_MAXSIZE:return n.exports.sqlite3__wasm_config_j(e,t[0]);case i.SQLITE_CONFIG_GETMALLOC:case i.SQLITE_CONFIG_GETMUTEX:case i.SQLITE_CONFIG_GETPCACHE2:case i.SQLITE_CONFIG_GETPCACHE:case i.SQLITE_CONFIG_HEAP:case i.SQLITE_CONFIG_LOG:case i.SQLITE_CONFIG_MALLOC:case i.SQLITE_CONFIG_MMAP_SIZE:case i.SQLITE_CONFIG_MULTITHREAD:case i.SQLITE_CONFIG_MUTEX:case i.SQLITE_CONFIG_PAGECACHE:case i.SQLITE_CONFIG_PCACHE2:case i.SQLITE_CONFIG_PCACHE:case i.SQLITE_CONFIG_PCACHE_HDRSZ:case i.SQLITE_CONFIG_PMASZ:case i.SQLITE_CONFIG_SERIALIZED:case i.SQLITE_CONFIG_SINGLETHREAD:case i.SQLITE_CONFIG_SQLLOG:case i.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return i.SQLITE_NOTFOUND}};{const e=new Set;i.sqlite3_auto_extension=function(t){if(t instanceof Function)t=n.installFunction("i(ppp)",t);else if(1!==arguments.length||!n.isPtr(t))return i.SQLITE_MISUSE;const s=n.exports.sqlite3_auto_extension(t);return t!==arguments[0]&&(0===s?e.add(t):n.uninstallFunction(t)),s},i.sqlite3_cancel_auto_extension=function(e){return e&&1===arguments.length&&n.isPtr(e)?n.exports.sqlite3_cancel_auto_extension(e):0},i.sqlite3_reset_auto_extension=function(){n.exports.sqlite3_reset_auto_extension();for(const t of e)n.uninstallFunction(t);e.clear()}}const u=i.sqlite3_vfs_find("kvvfs");if(u)if(s.isUIThread()){const e=new i.sqlite3_kvvfs_methods(n.exports.sqlite3__wasm_kvvfs_methods());delete i.sqlite3_kvvfs_methods;const t=n.exports.sqlite3__wasm_kvvfsMakeKeyOnPstack,s=n.pstack,r=e=>115===n.peek(e)?sessionStorage:localStorage,o={xRead:(e,i,o,a)=>{const l=s.pointer,c=n.scopedAllocPush();try{const s=t(e,i);if(!s)return-3;const l=n.cstrToJs(s),c=r(e).getItem(l);if(!c)return-1;const u=c.length;if(a<=0)return u;if(1===a)return n.poke(o,0),u;const _=n.scopedAllocCString(c);return a>u+1&&(a=u+1),n.heap8u().copyWithin(o,_,_+a-1),n.poke(o+a-1,0),a-1}catch(u){return console.error("kvstorageRead()",u),-2}finally{s.restore(l),n.scopedAllocPop(c)}},xWrite:(e,o,a)=>{const l=s.pointer;try{const i=t(e,o);if(!i)return 1;const s=n.cstrToJs(i);return r(e).setItem(s,n.cstrToJs(a)),0}catch(c){return console.error("kvstorageWrite()",c),i.SQLITE_IOERR}finally{s.restore(l)}},xDelete:(e,o)=>{const a=s.pointer;try{const i=t(e,o);return i?(r(e).removeItem(n.cstrToJs(i)),0):1}catch(l){return console.error("kvstorageDelete()",l),i.SQLITE_IOERR}finally{s.restore(a)}}};for(const i of Object.keys(o))e[e.memberKey(i)]=n.installFunction(e.memberSignature(i),o[i])}else i.sqlite3_vfs_unregister(u);n.xWrap.FuncPtrAdapter.warnOnUse=!0;const _=e.StructBinder,f=function e(i,s,r,o=e.installMethodArgcCheck){if(i instanceof _.StructType?r instanceof Function||n.isPtr(r)||t("Usage errror: expecting a Function or WASM pointer to one."):t("Usage error: target object is-not-a StructType."),1===arguments.length)return(t,n)=>e(i,t,n,o);e.argcProxy||(e.argcProxy=function(e,i,n,s){return function(...r){return n.length!==arguments.length&&t("Argument mismatch for",e.structInfo.name+"::"+i+": Native signature is:",s),n.apply(this,r)}},e.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach(((e,t)=>{if("number"==typeof e)try{n.uninstallFunction(e)}catch(i){}})),delete this.ondispose.__removeFuncList)});const a=i.memberSignature(s);a.length<2&&t("Member",s,"does not have a function pointer signature:",a);const l=i.memberKey(s),c=o&&!n.isPtr(r)?e.argcProxy(i,l,r,a):r;if(n.isPtr(c))c&&!n.functionEntry(c)&&t("Pointer",c,"is not a WASM function table entry."),i[l]=c;else{const t=n.installFunction(c,i.memberSignature(s,!0));i[l]=t,i.ondispose&&i.ondispose.__removeFuncList||(i.addOnDispose("ondispose.__removeFuncList handler",e.removeFuncList),i.ondispose.__removeFuncList=[]),i.ondispose.__removeFuncList.push(l,t)}return(t,n)=>e(i,t,n,o)};f.installMethodArgcCheck=!1;const p=function(e,t,i=f.installMethodArgcCheck){const n=new Map;for(const s of Object.keys(t)){const r=t[s],o=n.get(r);if(o){const t=e.memberKey(s);e[t]=e[e.memberKey(o)]}else f(e,s,r,i),n.set(r,s)}return e};_.StructType.prototype.installMethod=function(e,t,i=f.installMethodArgcCheck){return arguments.length<3&&e&&"object"==typeof e?p(this,...arguments):f(this,...arguments)},_.StructType.prototype.installMethods=function(e,t=f.installMethodArgcCheck){return p(this,e,t)}})),globalThis.sqlite3ApiBootstrap.initializers.push((function(e){e.version={libVersion:"3.47.0",libVersionNumber:3047e3,sourceId:"2024-10-21 16:30:22 03a9703e27c44437c39363d0baf82db4ebc94538a0f28411c85dda156f82alt1",downloadVersion:347e4}})),globalThis.sqlite3ApiBootstrap.initializers.push((function(e){const t=(...t)=>{throw new e.SQLite3Error(...t)},i=e.capi,n=e.wasm,s=e.util,r=new WeakMap,o=new WeakMap,a=(e,t,i)=>{const n=Object.getOwnPropertyDescriptor(e,t);return n?n.value:i},l=function(e,n){return n&&(e instanceof f&&(e=e.pointer),t(n,"sqlite3 result code",n+":",e?i.sqlite3_errmsg(e):i.sqlite3_errstr(n))),arguments[0]},c=n.installFunction("i(ippp)",function(e,t,s,r){i.SQLITE_TRACE_STMT===e&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+t+":",n.cstrToJs(r))}.bind({counter:0})),u=Object.create(null),_=function s(...a){if(!s._name2vfs){s._name2vfs=Object.create(null);const e="function"==typeof importScripts&&(e=>t("The VFS for",e,"is only available in the main window thread."));s._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:e||(()=>"local")},s._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:e||(()=>"session")}}const _=s.normalizeArgs(...a);let f=_.filename,p=_.vfs,d=_.flags;("string"!=typeof f&&"number"!=typeof f||"string"!=typeof d||p&&"string"!=typeof p&&"number"!=typeof p)&&(e.config.error("Invalid DB ctor args",_,arguments),t("Invalid arguments for DB constructor."));let m="number"==typeof f?n.cstrToJs(f):f;const h=s._name2vfs[m];h&&(p=h.vfs,f=m=h.filename(m));let g,b=0;d.indexOf("c")>=0&&(b|=i.SQLITE_OPEN_CREATE|i.SQLITE_OPEN_READWRITE),d.indexOf("w")>=0&&(b|=i.SQLITE_OPEN_READWRITE),0===b&&(b|=i.SQLITE_OPEN_READONLY),b|=i.SQLITE_OPEN_EXRESCODE;const y=n.pstack.pointer;try{const e=n.pstack.allocPtr();let t=i.sqlite3_open_v2(f,e,b,p||0);g=n.peekPtr(e),l(g,t),i.sqlite3_extended_result_codes(g,1),d.indexOf("t")>=0&&i.sqlite3_trace_v2(g,i.SQLITE_TRACE_STMT,c,g)}catch(q){throw g&&i.sqlite3_close_v2(g),q}finally{n.pstack.restore(y)}this.filename=m,r.set(this,g),o.set(this,Object.create(null));try{const n=i.sqlite3_js_db_vfs(g)||t("Internal error: cannot get VFS for new db handle."),s=u[n];s&&(s instanceof Function?s(this,e):l(g,i.sqlite3_exec(g,s,0,0,0)))}catch(q){throw this.close(),q}};_.setVfsPostOpenCallback=function(e,i){i instanceof Function||t("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),u[e]=i},_.normalizeArgs=function(e=":memory:",t="c",i=null){const n={};return 1===arguments.length&&arguments[0]&&"object"==typeof arguments[0]?(Object.assign(n,arguments[0]),void 0===n.flags&&(n.flags="c"),void 0===n.vfs&&(n.vfs=null),void 0===n.filename&&(n.filename=":memory:")):(n.filename=e,n.flags=t,n.vfs=i),n};const f=function(...e){_.apply(this,e)};f.dbCtorHelper=_;const p={null:1,number:2,string:3,boolean:4,blob:5};p[void 0],p.null,n.bigIntEnabled&&(p.bigint=p.number);const d=function(){p!==arguments[2]&&t(i.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],r.set(this,arguments[1]),this.parameterCount=i.sqlite3_bind_parameter_count(this.pointer)},m=function(e){return e.pointer||t("DB has been closed."),e},h=function(e,i){return(i!==(0|i)||i<0||i>=e.columnCount)&&t("Column index",i,"is out of range."),e},g=(e,t,i,...n)=>{const s=e.prepare(t);try{const e=s.bind(i).step()?s.get(...n):void 0;return s.reset(),e}finally{s.finalize()}},b=(e,t,i,n)=>e.exec({sql:t,bind:i,rowMode:n,returnValue:"resultRows"});f.checkRc=(e,t)=>l(e,t),f.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return m(this)},close:function(){if(this.pointer){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch(e){}const t=this.pointer;if(Object.keys(o.get(this)).forEach(((t,i)=>{if(i&&i.pointer)try{i.finalize()}catch(e){}})),r.delete(this),o.delete(this),i.sqlite3_close_v2(t),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch(e){}delete this.filename}},changes:function(e=!1,t=!1){const n=m(this).pointer;return e?t?i.sqlite3_total_changes64(n):i.sqlite3_total_changes(n):t?i.sqlite3_changes64(n):i.sqlite3_changes(n)},dbFilename:function(e="main"){return i.sqlite3_db_filename(m(this).pointer,e)},dbName:function(e=0){return i.sqlite3_db_name(m(this).pointer,e)},dbVfsName:function(e=0){let t;const s=i.sqlite3_js_db_vfs(m(this).pointer,e);if(s){const e=new i.sqlite3_vfs(s);try{t=n.cstrToJs(e.$zName)}finally{e.dispose()}}return t},prepare:function(e){m(this);const s=n.pstack.pointer;let r,a;try{r=n.pstack.alloc(8),f.checkRc(this,i.sqlite3_prepare_v2(this.pointer,e,-1,r,null)),a=n.peekPtr(r)}finally{n.pstack.restore(s)}a||t("Cannot prepare empty SQL.");const l=new d(this,a,p);return o.get(this)[a]=l,l},exec:function(){m(this);const e=function(e,n){const r=Object.create(null);switch(r.opt=Object.create(null),n.length){case 1:"string"==typeof n[0]||s.isSQLableTypedArray(n[0])||Array.isArray(n[0])?r.sql=n[0]:n[0]&&"object"==typeof n[0]&&(r.opt=n[0],r.sql=r.opt.sql);break;case 2:r.sql=n[0],r.opt=n[1];break;default:t("Invalid argument count for exec().")}r.sql=s.flexibleString(r.sql),"string"!=typeof r.sql&&t("Missing SQL argument or unsupported SQL value type.");const o=r.opt;switch(o.returnValue){case"resultRows":o.resultRows||(o.resultRows=[]),r.returnVal=()=>o.resultRows;break;case"saveSql":o.saveSql||(o.saveSql=[]),r.returnVal=()=>o.saveSql;break;case void 0:case"this":r.returnVal=()=>e;break;default:t("Invalid returnValue value:",o.returnValue)}if(o.callback||o.returnValue||void 0===o.rowMode||(o.resultRows||(o.resultRows=[]),r.returnVal=()=>o.resultRows),o.callback||o.resultRows)switch(void 0===o.rowMode?"array":o.rowMode){case"object":r.cbArg=(e,t)=>{t.columnNames||(t.columnNames=e.getColumnNames([]));const i=e.get([]),n=Object.create(null);for(const s in t.columnNames)n[t.columnNames[s]]=i[s];return n};break;case"array":r.cbArg=e=>e.get([]);break;case"stmt":Array.isArray(o.resultRows)&&t("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),r.cbArg=e=>e;break;default:if(s.isInt32(o.rowMode)){r.cbArg=e=>e.get(o.rowMode);break}if("string"==typeof o.rowMode&&o.rowMode.length>1&&"$"===o.rowMode[0]){const e=o.rowMode.substr(1);r.cbArg=n=>{const s=n.get(Object.create(null))[e];return void 0===s?t(i.SQLITE_NOTFOUND,"exec(): unknown result column:",e):s};break}t("Invalid rowMode:",o.rowMode)}return r}(this,arguments);if(!e.sql)return t("exec() requires an SQL string.");const r=e.opt,o=r.callback,a=Array.isArray(r.resultRows)?r.resultRows:void 0;let l,c=r.bind,u=!!(e.cbArg||r.columnNames||a);const _=n.scopedAllocPush(),h=Array.isArray(r.saveSql)?r.saveSql:void 0;try{const t=s.isSQLableTypedArray(e.sql);let _=t?e.sql.byteLength:n.jstrlen(e.sql);const m=n.scopedAlloc(2*n.ptrSizeof+(_+1)),g=m+n.ptrSizeof;let b=g+n.ptrSizeof;const y=b+_;for(t?n.heap8().set(e.sql,b):n.jstrcpy(e.sql,n.heap8(),b,_,!1),n.poke(b+_,0);b&&n.peek(b,"i8");){n.pokePtr([m,g],0),f.checkRc(this,i.sqlite3_prepare_v3(this.pointer,b,_,0,m,g));const t=n.peekPtr(m);if(b=n.peekPtr(g),_=y-b,t){if(h&&h.push(i.sqlite3_sql(t).trim()),l=new d(this,t,p),c&&l.parameterCount&&(l.bind(c),c=null),u&&l.columnCount){let t=Array.isArray(r.columnNames)?0:1;if(u=!1,e.cbArg||a){const i=Object.create(null);for(;l.step();l._lockedByExec=!1){0==t++&&l.getColumnNames(i.columnNames=r.columnNames||[]),l._lockedByExec=!0;const n=e.cbArg(l,i);if(a&&a.push(n),o&&!1===o.call(r,n,l))break}l._lockedByExec=!1}0===t&&l.getColumnNames(r.columnNames)}else l.step();l.reset().finalize(),l=null}}}finally{n.scopedAllocPop(_),l&&(delete l._lockedByExec,l.finalize())}return e.returnVal()},createFunction:function(e,n,r){const o=e=>e instanceof Function;switch(arguments.length){case 1:e=(r=e).name,n=r.xFunc||0;break;case 2:o(n)||(n=(r=n).xFunc||0)}r||(r={}),"string"!=typeof e&&t("Invalid arguments: missing function name.");let l=r.xStep||0,c=r.xFinal||0;const u=r.xValue||0,_=r.xInverse||0;let p;o(n)?(p=!1,(o(l)||o(c))&&t("Ambiguous arguments: scalar or aggregate?"),l=c=null):o(l)?(o(c)||t("Missing xFinal() callback for aggregate or window UDF."),n=null):o(c)?t("Missing xStep() callback for aggregate or window UDF."):t("Missing function-type properties."),!1===p?(o(u)||o(_))&&t("xValue and xInverse are not permitted for non-window UDFs."):o(u)?(o(_)||t("xInverse must be provided if xValue is."),p=!0):o(_)&&t("xValue must be provided if xInverse is.");const d=r.pApp;null==d||"number"==typeof d&&s.isInt32(d)||t("Invalid value for pApp property. Must be a legal WASM pointer value.");const m=r.xDestroy||0;m&&!o(m)&&t("xDestroy property must be a function.");let h=0;a(r,"deterministic")&&(h|=i.SQLITE_DETERMINISTIC),a(r,"directOnly")&&(h|=i.SQLITE_DIRECTONLY),a(r,"innocuous")&&(h|=i.SQLITE_INNOCUOUS),e=e.toLowerCase();const g=n||l,b=a(r,"arity"),y="number"==typeof b?b:g.length?g.length-1:0;let q;return q=p?i.sqlite3_create_window_function(this.pointer,e,y,i.SQLITE_UTF8|h,d||0,l,c,u,_,m):i.sqlite3_create_function_v2(this.pointer,e,y,i.SQLITE_UTF8|h,d||0,n,l,c,m),f.checkRc(this,q),this},selectValue:function(e,t,i){return g(this,e,t,0,i)},selectValues:function(e,t,i){const n=this.prepare(e),s=[];try{for(n.bind(t);n.step();)s.push(n.get(0,i));n.reset()}finally{n.finalize()}return s},selectArray:function(e,t){return g(this,e,t,[])},selectObject:function(e,t){return g(this,e,t,{})},selectArrays:function(e,t){return b(this,e,t,"array")},selectObjects:function(e,t){return b(this,e,t,"object")},openStatementCount:function(){return this.pointer?Object.keys(o.get(this)).length:0},transaction:function(e){let n="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&t(i.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),n+=" "+arguments[0],e=arguments[1]),m(this).exec(n);try{const t=e(this);return this.exec("COMMIT"),t}catch(s){throw this.exec("ROLLBACK"),s}},savepoint:function(e){m(this).exec("SAVEPOINT oo1");try{const t=e(this);return this.exec("RELEASE oo1"),t}catch(t){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),t}},checkRc:function(e){return l(this,e)}};const y=function(e){return e.pointer||t("Stmt has been closed."),e},q=function(e){return function(e){let t=p[null==e?"null":typeof e];switch(t){case p.boolean:case p.null:case p.number:case p.string:return t;case p.bigint:if(n.bigIntEnabled)return t;default:return s.isBindableTypedArray(e)?p.blob:void 0}}(e)||t("Unsupported bind() argument type:",typeof e)},w=function(e,i){return e._lockedByExec&&t("Operation is illegal when statement is locked:",i),e},v=function r(o,a,l,c){w(y(o),"bind()"),r._||(r._tooBigInt=e=>t("BigInt value is too big to store without precision loss:",e),r._={string:function(e,t,s,r){const[o,a]=n.allocCString(s,!0);return(r?i.sqlite3_bind_blob:i.sqlite3_bind_text)(e.pointer,t,o,a,i.SQLITE_WASM_DEALLOC)}}),q(c),a=function(e,n){const r="number"==typeof n?n:i.sqlite3_bind_parameter_index(e.pointer,n);return 0!==r&&s.isInt32(r)?(r<1||r>e.parameterCount)&&t("Bind index",n,"is out of range."):t("Invalid bind() parameter name: "+n),r}(o,a);let u=0;switch(null==c?p.null:l){case p.null:u=i.sqlite3_bind_null(o.pointer,a);break;case p.string:u=r._.string(o,a,c,!1);break;case p.number:{let e;s.isInt32(c)?e=i.sqlite3_bind_int:"bigint"==typeof c?s.bigIntFits64(c)?n.bigIntEnabled?e=i.sqlite3_bind_int64:s.bigIntFitsDouble(c)?(c=Number(c),e=i.sqlite3_bind_double):r._tooBigInt(c):r._tooBigInt(c):(c=Number(c),e=n.bigIntEnabled&&Number.isInteger(c)?i.sqlite3_bind_int64:i.sqlite3_bind_double),u=e(o.pointer,a,c);break}case p.boolean:u=i.sqlite3_bind_int(o.pointer,a,c?1:0);break;case p.blob:{if("string"==typeof c){u=r._.string(o,a,c,!0);break}c instanceof ArrayBuffer?c=new Uint8Array(c):s.isBindableTypedArray(c)||t("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const e=n.alloc(c.byteLength||1);n.heap8().set(c.byteLength?c:[0],e),u=i.sqlite3_bind_blob(o.pointer,a,e,c.byteLength,i.SQLITE_WASM_DEALLOC);break}default:e.config.warn("Unsupported bind() argument type:",c),t("Unsupported bind() argument type: "+typeof c)}return u&&f.checkRc(o.db.pointer,u),o._mayGet=!1,o};d.prototype={finalize:function(){if(this.pointer){w(this,"finalize()");const e=i.sqlite3_finalize(this.pointer);return delete o.get(this.db)[this.pointer],r.delete(this),delete this._mayGet,delete this.parameterCount,delete this._lockedByExec,delete this.db,e}},clearBindings:function(){return w(y(this),"clearBindings()"),i.sqlite3_clear_bindings(this.pointer),this._mayGet=!1,this},reset:function(e){w(this,"reset()"),e&&this.clearBindings();const t=i.sqlite3_reset(y(this).pointer);return this._mayGet=!1,l(this.db,t),this},bind:function(){let e,i;switch(y(this),arguments.length){case 1:e=1,i=arguments[0];break;case 2:e=arguments[0],i=arguments[1];break;default:t("Invalid bind() arguments.")}return void 0===i?this:(this.parameterCount||t("This statement has no bindable parameters."),this._mayGet=!1,null===i?v(this,e,p.null,i):Array.isArray(i)?(1!==arguments.length&&t("When binding an array, an index argument is not permitted."),i.forEach(((e,t)=>v(this,t+1,q(e),e))),this):(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),"object"!=typeof i||s.isBindableTypedArray(i)?v(this,e,q(i),i):(1!==arguments.length&&t("When binding an object, an index argument is not permitted."),Object.keys(i).forEach((e=>v(this,e,q(i[e]),i[e]))),this)))},bindAsBlob:function(e,i){y(this),1===arguments.length&&(i=e,e=1);const n=q(i);return p.string!==n&&p.blob!==n&&p.null!==n&&t("Invalid value type for bindAsBlob()"),v(this,e,p.blob,i)},step:function(){w(this,"step()");const t=i.sqlite3_step(y(this).pointer);switch(t){case i.SQLITE_DONE:return this._mayGet=!1;case i.SQLITE_ROW:return this._mayGet=!0;default:this._mayGet=!1,e.config.warn("sqlite3_step() rc=",t,i.sqlite3_js_rc_str(t),"SQL =",i.sqlite3_sql(this.pointer)),f.checkRc(this.db.pointer,t)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const e=this.step();return this.reset(),e}finally{try{this.finalize()}catch(e){}}},get:function(e,r){if(y(this)._mayGet||t("Stmt.step() has not (recently) returned true."),Array.isArray(e)){let t=0;const i=this.columnCount;for(;t<i;)e[t]=this.get(t++);return e}if(e&&"object"==typeof e){let t=0;const n=this.columnCount;for(;t<n;)e[i.sqlite3_column_name(this.pointer,t)]=this.get(t++);return e}switch(h(this,e),void 0===r?i.sqlite3_column_type(this.pointer,e):r){case i.SQLITE_NULL:return null;case i.SQLITE_INTEGER:if(n.bigIntEnabled){const t=i.sqlite3_column_int64(this.pointer,e);return t>=Number.MIN_SAFE_INTEGER&&t<=Number.MAX_SAFE_INTEGER?Number(t).valueOf():t}{const n=i.sqlite3_column_double(this.pointer,e);return(n>Number.MAX_SAFE_INTEGER||n<Number.MIN_SAFE_INTEGER)&&t("Integer is out of range for JS integer range: "+n),s.isInt32(n)?0|n:n}case i.SQLITE_FLOAT:return i.sqlite3_column_double(this.pointer,e);case i.SQLITE_TEXT:return i.sqlite3_column_text(this.pointer,e);case i.SQLITE_BLOB:{const t=i.sqlite3_column_bytes(this.pointer,e),s=i.sqlite3_column_blob(this.pointer,e),r=new Uint8Array(t);return t&&r.set(n.heap8u().slice(s,s+t),0),t&&this.db._blobXfer instanceof Array&&this.db._blobXfer.push(r.buffer),r}default:t("Don't know how to translate","type of result column #"+e+".")}t("Not reached.")},getInt:function(e){return this.get(e,i.SQLITE_INTEGER)},getFloat:function(e){return this.get(e,i.SQLITE_FLOAT)},getString:function(e){return this.get(e,i.SQLITE_TEXT)},getBlob:function(e){return this.get(e,i.SQLITE_BLOB)},getJSON:function(e){const t=this.get(e,i.SQLITE_STRING);return null===t?t:JSON.parse(t)},getColumnName:function(e){return i.sqlite3_column_name(h(y(this),e).pointer,e)},getColumnNames:function(e=[]){h(y(this),0);const t=this.columnCount;for(let n=0;n<t;++n)e.push(i.sqlite3_column_name(this.pointer,n));return e},getParamIndex:function(e){return y(this).parameterCount?i.sqlite3_bind_parameter_index(this.pointer,e):void 0},getParamName:function(e){return y(this).parameterCount?i.sqlite3_bind_parameter_name(this.pointer,e):void 0},isBusy:function(){return 0!==i.sqlite3_stmt_busy(y(this))},isReadOnly:function(){return 0!==i.sqlite3_stmt_readonly(y(this))}};{const e={enumerable:!0,get:function(){return r.get(this)},set:()=>t("The pointer property is read-only.")};Object.defineProperty(d.prototype,"pointer",e),Object.defineProperty(f.prototype,"pointer",e)}if(Object.defineProperty(d.prototype,"columnCount",{enumerable:!1,get:function(){return i.sqlite3_column_count(this.pointer)},set:()=>t("The columnCount property is read-only.")}),e.oo1={DB:f,Stmt:d},s.isUIThread()){e.oo1.JsStorageDb=function(e="session"){const i=_.normalizeArgs(...arguments);"session"!==(e=i.filename)&&"local"!==e&&t("JsStorageDb db name must be one of 'session' or 'local'."),i.vfs="kvvfs",_.call(this,i)};const n=e.oo1.JsStorageDb;n.prototype=Object.create(f.prototype),n.clearStorage=i.sqlite3_js_kvvfs_clear,n.prototype.clearStorage=function(){return n.clearStorage(m(this).filename)},n.storageSize=i.sqlite3_js_kvvfs_size,n.prototype.storageSize=function(){return n.storageSize(m(this).filename)}}})),globalThis.sqlite3ApiBootstrap.initializers.push((function(e){const t=e.util;e.initWorker1API=function(){const e=(...e)=>{throw new Error(e.join(" "))};globalThis.WorkerGlobalScope instanceof Function||e("initWorker1API() must be run from a Worker thread.");const i=this.sqlite3||e("Missing this.sqlite3 object."),n=i.oo1.DB,s=function(e){let t=r.idMap.get(e);return t||(t="db#"+ ++r.idSeq+"@"+e.pointer,r.idMap.set(e,t),t)},r={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(e){const t=new n(e);return this.dbs[s(t)]=t,this.dbList.indexOf(t)<0&&this.dbList.push(t),t},close:function(e,i){if(e){delete this.dbs[s(e)];const n=e.filename,r=t.sqlite3__wasm_db_vfs(e.pointer,0);e.close();const o=this.dbList.indexOf(e);o>=0&&this.dbList.splice(o,1),i&&n&&r&&t.sqlite3__wasm_vfs_unlink(r,n)}},post:function(e,t){t&&t.length?(globalThis.postMessage(e,Array.from(t)),t.length=0):globalThis.postMessage(e)},dbs:Object.create(null),getDb:function(t,i=!0){return this.dbs[t]||(i?e("Unknown (or closed) DB ID:",t):void 0)}},o=function(t,i=!0){const n=r.getDb(t.dbId,!1)||r.dbList[0];return i?function(t=r.dbList[0]){return t&&t.pointer?t:e("DB is not opened.")}(n):n},a={open:function(t){const n=Object.create(null),o=t.args||Object.create(null);o.simulateError&&e("Throwing because of simulateError flag.");const a=Object.create(null);n.vfs=o.vfs,n.filename=o.filename||"";const l=r.open(n);return a.filename=l.filename,a.persistent=!!i.capi.sqlite3_js_db_uses_vfs(l.pointer,"opfs"),a.dbId=s(l),a.vfs=l.dbVfsName(),a},close:function(e){const t=o(e,!1),i={filename:t&&t.filename};if(t){const i=!(!e.args||"object"!=typeof e.args)&&!!e.args.unlink;r.close(t,i)}return i},exec:function(t){const i="string"==typeof t.args?{sql:t.args}:t.args||Object.create(null);"stmt"===i.rowMode?e("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):i.sql||e("'exec' requires input SQL.");const n=o(t);(i.callback||Array.isArray(i.resultRows))&&(n._blobXfer=r.xfer);const s=i.callback;let a=0;const l=!!i.columnNames;"string"==typeof s&&(l||(i.columnNames=[]),i.callback=function(e,t){r.post({type:s,columnNames:i.columnNames,rowNumber:++a,row:e},r.xfer)});try{const e=i.countChanges?n.changes(!0,64===i.countChanges):void 0;n.exec(i),void 0!==e&&(i.changeCount=n.changes(!0,64===i.countChanges)-e),i.callback instanceof Function&&(i.callback=s,r.post({type:s,columnNames:i.columnNames,rowNumber:null,row:void 0}))}finally{delete n._blobXfer,i.callback&&(i.callback=s)}return i},"config-get":function(){const e=Object.create(null),t=i.config;return["bigIntEnabled"].forEach((function(i){Object.getOwnPropertyDescriptor(t,i)&&(e[i]=t[i])})),e.version=i.version,e.vfsList=i.capi.sqlite3_js_vfs_list(),e},export:function(e){const t=o(e),n={byteArray:i.capi.sqlite3_js_db_export(t.pointer),filename:t.filename,mimetype:"application/x-sqlite3"};return r.xfer.push(n.byteArray.buffer),n},toss:function(t){e("Testing worker exception")}};globalThis.onmessage=async function(t){let i,n=(t=t.data).dbId,o=t.type;const l=performance.now();try{a.hasOwnProperty(o)&&a[o]instanceof Function?i=await a[o](t):e("Unknown db worker message type:",t.type)}catch(c){o="error",i={operation:t.type,message:c.message,errorClass:c.name,input:t},c.stack&&(i.stack="string"==typeof c.stack?c.stack.split(/\n\s*/):c.stack)}n||(n=i.dbId||r.dbList[0]&&s(r.dbList[0])),r.post({type:o,dbId:n,messageId:t.messageId,workerReceivedTime:l,workerRespondTime:performance.now(),departureTime:t.departureTime,result:i},r.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}.bind({sqlite3:e})})),globalThis.sqlite3ApiBootstrap.initializers.push((function(e){const t=e.wasm,i=e.capi,n=e.util.toss3,s=Object.create(null);e.vfs=s,i.sqlite3_vfs.prototype.registerVfs=function(t=!1){this instanceof e.capi.sqlite3_vfs||n("Expecting a sqlite3_vfs-type argument.");const s=i.sqlite3_vfs_register(this,t?1:0);return s&&n("sqlite3_vfs_register(",this,") failed with rc",s),this.pointer!==i.sqlite3_vfs_find(this.$zName)&&n("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},s.installVfs=function(e){let i=0;const s=["io","vfs"];for(const n of s){const s=e[n];s&&(++i,s.struct.installMethods(s.methods,!!s.applyArgcCheck),"vfs"===n&&(s.struct.$zName||"string"!=typeof s.name||s.struct.addOnDispose(s.struct.$zName=t.allocCString(s.name)),s.struct.registerVfs(!!s.asDefault)))}return i||n("Misuse: installVfs() options object requires at least","one of:",s),this}})),globalThis.sqlite3ApiBootstrap.initializers.push((function(e){if(!e.wasm.exports.sqlite3_declare_vtab)return;const t=e.wasm,i=e.capi,n=e.util.toss3,s=Object.create(null);e.vtab=s;const r=i.sqlite3_index_info;r.prototype.nthConstraint=function(e,t=!1){if(e<0||e>=this.$nConstraint)return!1;const i=this.$aConstraint+r.sqlite3_index_constraint.structInfo.sizeof*e;return t?i:new r.sqlite3_index_constraint(i)},r.prototype.nthConstraintUsage=function(e,t=!1){if(e<0||e>=this.$nConstraint)return!1;const i=this.$aConstraintUsage+r.sqlite3_index_constraint_usage.structInfo.sizeof*e;return t?i:new r.sqlite3_index_constraint_usage(i)},r.prototype.nthOrderBy=function(e,t=!1){if(e<0||e>=this.$nOrderBy)return!1;const i=this.$aOrderBy+r.sqlite3_index_orderby.structInfo.sizeof*e;return t?i:new r.sqlite3_index_orderby(i)};const o=function(i,n){const s=function(i,n){return function(s,r=!1){if(0===arguments.length&&(s=new n),s instanceof n)return this.set(s.pointer,s),s;t.isPtr(s)||e.SQLite3Error.toss("Invalid argument to",i+"()");let o=this.get(s);return r&&this.delete(s),o}.bind(new Map)}(i,n);return Object.assign(Object.create(null),{StructType:n,create:e=>{const i=s();return t.pokePtr(e,i.pointer),i},get:e=>s(e),unget:e=>s(e,!0),dispose:e=>{const t=s(e,!0);t&&t.dispose()}})};s.xVtab=o("xVtab",i.sqlite3_vtab),s.xCursor=o("xCursor",i.sqlite3_vtab_cursor),s.xIndexInfo=e=>new i.sqlite3_index_info(e),s.xError=function t(n,s,r){if(t.errorReporter instanceof Function)try{t.errorReporter("sqlite3_module::"+n+"(): "+s.message)}catch(a){}let o;return s instanceof e.WasmAllocError?o=i.SQLITE_NOMEM:arguments.length>2?o=r:s instanceof e.SQLite3Error&&(o=s.resultCode),o||i.SQLITE_ERROR},s.xError.errorReporter=console.error.bind(console),s.xRowid=(e,i)=>t.poke(e,i,"i64"),s.setupModule=function(r){let o=!1;const a=this instanceof i.sqlite3_module?this:r.struct||(o=new i.sqlite3_module);try{const i=r.methods||n("Missing 'methods' object.");for(const e of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const t=e[0],n=e[1];!0===i[t]?i[t]=i[n]:!0===i[n]&&(i[n]=i[t])}if(r.catchExceptions){const n=function(i,n){return["xConnect","xCreate"].indexOf(i)>=0?function(r,o,a,l,c,u){try{return n(...arguments)||0}catch(_){return _ instanceof e.WasmAllocError||(t.dealloc(t.peekPtr(u)),t.pokePtr(u,t.allocCString(_.message))),s.xError(i,_)}}:function(...e){try{return n(...e)||0}catch(t){return s.xError(i,t)}}},r=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],o=Object.create(null);for(const e of r){const t=i[e];t instanceof Function&&("xConnect"===e&&i.xCreate===t?o[e]=i.xCreate:"xCreate"===e&&i.xConnect===t?o[e]=i.xConnect:o[e]=n(e,t))}a.installMethods(o,!1)}else a.installMethods(i,!!r.applyArgcCheck);if(0===a.$iVersion){let e;e="number"==typeof r.iVersion?r.iVersion:a.$xShadowName?3:a.$xSavePoint||a.$xRelease||a.$xRollbackTo?2:1,a.$iVersion=e}}catch(l){throw o&&o.dispose(),l}return a},i.sqlite3_module.prototype.setupModule=function(e){return s.setupModule.call(this,e)}})),globalThis.sqlite3ApiBootstrap.initializers.push((function(e){const t=function t(i){if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if("undefined"==typeof WorkerGlobalScope)return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!(globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&navigator?.storage?.getDirectory))return Promise.reject(new Error("Missing required OPFS APIs."));i&&"object"==typeof i||(i=Object.create(null));const n=new URL(globalThis.location.href).searchParams;if(n.has("opfs-disable"))return Promise.resolve(e);void 0===i.verbose&&(i.verbose=n.has("opfs-verbose")?+n.get("opfs-verbose")||2:1),void 0===i.sanityChecks&&(i.sanityChecks=n.has("opfs-sanity-check")),void 0===i.proxyUri&&(i.proxyUri=t.defaultProxyUri),"function"==typeof i.proxyUri&&(i.proxyUri=i.proxyUri());const s=new Promise((function(t,n){const s=[e.config.error,e.config.warn,e.config.log],r=(e,...t)=>{i.verbose>e&&s[e]("OPFS syncer:",...t)},o=(...e)=>r(2,...e),a=(...e)=>r(1,...e),l=(...e)=>r(0,...e),c=e.util.toss,u=e.capi,_=e.util,f=e.wasm,p=u.sqlite3_vfs,d=u.sqlite3_file,m=u.sqlite3_io_methods,h=Object.create(null);h.metrics={dump:function(){let t,i=0,n=0,s=0;for(t in S.opIds){const e=k[t];i+=e.count,n+=e.time,s+=e.wait,e.avgTime=e.count&&e.time?e.time/e.count:0,e.avgWait=e.count&&e.wait?e.wait/e.count:0}e.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",k,"\nTotal of",i,"op(s) for",n,"ms (incl. "+s+" ms of waiting on the async side)"),e.config.log("Serialization metrics:",k.s11n),v.postMessage({type:"opfs-async-metrics"})},reset:function(){let e;for(e in S.opIds)(t=k[e]=Object.create(null)).count=t.time=t.wait=0;var t;let i=k.s11n=Object.create(null);i=i.serialize=Object.create(null),i.count=i.time=0,i=k.s11n.deserialize=Object.create(null),i.count=i.time=0}};const g=new m,b=(new p).addOnDispose((()=>g.dispose()));let y;const q=e=>(y=!0,b.dispose(),n(e)),w=()=>(y=!1,t(e)),v=new Worker(new URL("/assets/sqlite3-opfs-async-proxy.js",import.meta.url),{type:"module"});setTimeout((()=>{void 0===y&&q(new Error("Timeout while waiting for OPFS async proxy worker."))}),4e3),v._originalOnError=v.onerror,v.onerror=function(e){l("Error initializing OPFS asyncer:",e),q(new Error("Loading OPFS async Worker failed for unknown reasons."))};const x=u.sqlite3_vfs_find(null),E=x?new p(x):null;g.$iVersion=1,b.$iVersion=2,b.$szOsFile=u.sqlite3_file.structInfo.sizeof,b.$mxPathname=1024,b.$zName=f.allocCString("opfs"),b.$xDlOpen=b.$xDlError=b.$xDlSym=b.$xDlClose=null,b.addOnDispose("$zName",b.$zName,"cleanup default VFS wrapper",(()=>E?E.dispose():null));const S=Object.create(null);S.verbose=i.verbose,S.littleEndian=(()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]})(),S.asyncIdleWaitTime=150,S.asyncS11nExceptions=1,S.fileBufferSize=65536,S.sabS11nOffset=S.fileBufferSize,S.sabS11nSize=2*b.$mxPathname,S.sabIO=new SharedArrayBuffer(S.fileBufferSize+S.sabS11nSize),S.opIds=Object.create(null);const k=Object.create(null);{let e=0;S.opIds.whichOp=e++,S.opIds.rc=e++,S.opIds.xAccess=e++,S.opIds.xClose=e++,S.opIds.xDelete=e++,S.opIds.xDeleteNoWait=e++,S.opIds.xFileSize=e++,S.opIds.xLock=e++,S.opIds.xOpen=e++,S.opIds.xRead=e++,S.opIds.xSleep=e++,S.opIds.xSync=e++,S.opIds.xTruncate=e++,S.opIds.xUnlock=e++,S.opIds.xWrite=e++,S.opIds.mkdir=e++,S.opIds["opfs-async-metrics"]=e++,S.opIds["opfs-async-shutdown"]=e++,S.opIds.retry=e++,S.sabOP=new SharedArrayBuffer(4*e),h.metrics.reset()}S.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach((e=>{void 0===(S.sq3Codes[e]=u[e])&&c("Maintenance required: not found:",e)})),S.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const A=(e,...t)=>{const i=S.opIds[e]||c("Invalid op ID:",e);S.s11n.serialize(...t),Atomics.store(S.sabOPView,S.opIds.rc,-1),Atomics.store(S.sabOPView,S.opIds.whichOp,i),Atomics.notify(S.sabOPView,S.opIds.whichOp);const n=performance.now();for(;"not-equal"!==Atomics.wait(S.sabOPView,S.opIds.rc,-1););const s=Atomics.load(S.sabOPView,S.opIds.rc);if(k[e].wait+=performance.now()-n,s&&S.asyncS11nExceptions){const t=S.s11n.deserialize();t&&l(e+"() async error:",...t)}return s};h.debug={asyncShutdown:()=>{a("Shutting down OPFS async listener. The OPFS VFS will no longer work."),A("opfs-async-shutdown")},asyncRestart:()=>{a("Attempting to restart OPFS VFS async listener. Might work, might not."),v.postMessage({type:"opfs-async-restart"})}};const I=function e(t=16){e._chars||(e._n=(e._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789").length);const i=[];let n=0;for(;n<t;++n){const t=Math.random()*(64*e._n)%e._n|0;i[n]=e._chars[t]}return i.join("")},T=Object.create(null),O=Object.create(null);O.op=void 0,O.start=void 0;const F=e=>{O.start=performance.now(),O.op=e,++k[e].count},L=()=>k[O.op].time+=performance.now()-O.start,P={xCheckReservedLock:function(e,t){return f.poke(t,0,"i32"),0},xClose:function(e){F("xClose");let t=0;const i=T[e];return i&&(delete T[e],t=A("xClose",e),i.sq3File&&i.sq3File.dispose()),L(),t},xDeviceCharacteristics:function(e){return u.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(e,t,i){return u.SQLITE_NOTFOUND},xFileSize:function(e,t){F("xFileSize");let i=A("xFileSize",e);if(0==i)try{const e=S.s11n.deserialize()[0];f.poke(t,e,"i64")}catch(n){l("Unexpected error reading xFileSize() result:",n),i=S.sq3Codes.SQLITE_IOERR}return L(),i},xLock:function(e,t){F("xLock");const i=T[e];let n=0;return i.lockType?i.lockType=t:(n=A("xLock",e,t),0===n&&(i.lockType=t)),L(),n},xRead:function(e,t,i,n){F("xRead");const s=T[e];let r;try{r=A("xRead",e,i,Number(n)),0!==r&&u.SQLITE_IOERR_SHORT_READ!==r||f.heap8u().set(s.sabView.subarray(0,i),t)}catch(o){l("xRead(",arguments,") failed:",o,s),r=u.SQLITE_IOERR_READ}return L(),r},xSync:function(e,t){F("xSync"),++k.xSync.count;const i=A("xSync",e,t);return L(),i},xTruncate:function(e,t){F("xTruncate");const i=A("xTruncate",e,Number(t));return L(),i},xUnlock:function(e,t){F("xUnlock");const i=T[e];let n=0;return u.SQLITE_LOCK_NONE===t&&i.lockType&&(n=A("xUnlock",e,t)),0===n&&(i.lockType=t),L(),n},xWrite:function(e,t,i,n){F("xWrite");const s=T[e];let r;try{s.sabView.set(f.heap8u().subarray(t,t+i)),r=A("xWrite",e,i,Number(n))}catch(o){l("xWrite(",arguments,") failed:",o,s),r=u.SQLITE_IOERR_WRITE}return L(),r}},C={xAccess:function(e,t,i,n){F("xAccess");const s=A("xAccess",f.cstrToJs(t));return f.poke(n,s?0:1,"i32"),L(),0},xCurrentTime:function(e,t){return f.poke(t,2440587.5+(new Date).getTime()/864e5,"double"),0},xCurrentTimeInt64:function(e,t){return f.poke(t,21086676e7+(new Date).getTime(),"i64"),0},xDelete:function(e,t,i){F("xDelete");const n=A("xDelete",f.cstrToJs(t),i,!1);return L(),n},xFullPathname:function(e,t,i,n){return f.cstrncpy(n,t,i)<i?0:u.SQLITE_CANTOPEN},xGetLastError:function(e,t,i){return a("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(t,i,n,s,r){F("xOpen");let o=0;0===i?i=I():f.isPtr(i)&&(u.sqlite3_uri_boolean(i,"opfs-unlock-asap",0)&&(o|=S.opfsFlags.OPFS_UNLOCK_ASAP),u.sqlite3_uri_boolean(i,"delete-before-open",0)&&(o|=S.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),i=f.cstrToJs(i));const a=Object.create(null);a.fid=n,a.filename=i,a.sab=new SharedArrayBuffer(S.fileBufferSize),a.flags=s,a.readOnly=!(e.SQLITE_OPEN_CREATE&s||!(s&u.SQLITE_OPEN_READONLY));const l=A("xOpen",n,i,s,o);return l||(a.readOnly&&f.poke(r,u.SQLITE_OPEN_READONLY,"i32"),T[n]=a,a.sabView=S.sabFileBufView,a.sq3File=new d(n),a.sq3File.$pMethods=g.pointer,a.lockType=u.SQLITE_LOCK_NONE),L(),l}};E&&(b.$xRandomness=E.$xRandomness,b.$xSleep=E.$xSleep),b.$xRandomness||(C.xRandomness=function(e,t,i){const n=f.heap8u();let s=0;for(;s<t;++s)n[i+s]=255e3*Math.random()&255;return s}),b.$xSleep||(C.xSleep=function(e,t){return Atomics.wait(S.sabOPView,S.opIds.xSleep,0,t),0}),h.getResolvedPath=function(e,t){const i=new URL(e,"file://irrelevant").pathname;return t?i.split("/").filter((e=>!!e)):i},h.getDirForFilename=async function(e,t=!1){const i=h.getResolvedPath(e,!0),n=i.pop();let s=h.rootDirectory;for(const r of i)r&&(s=await s.getDirectoryHandle(r,{create:!!t}));return[s,n]},h.mkdir=async function(e){try{return await h.getDirForFilename(e+"/filepart",!0),!0}catch(t){return!1}},h.entryExists=async function(e){try{const[t,i]=await h.getDirForFilename(e);return await t.getFileHandle(i),!0}catch(t){return!1}},h.randomFilename=I,h.treeList=async function(){const e=Object.create(null);return await async function e(t,i){i.name=t.name,i.dirs=[],i.files=[];for await(const n of t.values())if("directory"===n.kind){const t=Object.create(null);i.dirs.push(t),await e(n,t)}else i.files.push(n.name)}(h.rootDirectory,e),e},h.rmfr=async function(){const e=h.rootDirectory,t={recurse:!0};for await(const i of e.values())e.removeEntry(i.name,t)},h.unlink=async function(e,t=!1,i=!1){try{const[i,n]=await h.getDirForFilename(e,!1);return await i.removeEntry(n,{recursive:t}),!0}catch(n){if(i)throw new Error("unlink(",arguments[0],") failed: "+n.message,{cause:n});return!1}},h.traverse=async function(e){const t={recursive:!0,directory:h.rootDirectory};"function"==typeof e&&(e={callback:e});!async function t(i,n){for await(const s of i.values()){if(!1===e.callback(s,i,n))return!1;if(e.recursive&&"directory"===s.kind&&!1===await t(s,n+1))break}}((e=Object.assign(t,e||{})).directory,0)};if(h.importDb=async function(e,t){if(t instanceof Function)return async function(e,t){const[i,n]=await h.getDirForFilename(e,!0),s=await i.getFileHandle(n,{create:!0});let r,o=await s.createSyncAccessHandle(),a=0,l=!1;try{for(o.truncate(0);void 0!==(r=await t());)r instanceof ArrayBuffer&&(r=new Uint8Array(r)),0===a&&r.byteLength>=15&&(_.affirmDbHeader(r),l=!0),o.write(r,{at:a}),a+=r.byteLength;if((a<512||0!=a%512)&&c("Input size",a,"is not correct for an SQLite database."),!l){const e=new Uint8Array(20);o.read(e,{at:0}),_.affirmDbHeader(e)}return o.write(new Uint8Array([1,1]),{at:18}),a}catch(u){throw await o.close(),o=void 0,await i.removeEntry(n).catch((()=>{})),u}finally{o&&await o.close()}}(e,t);t instanceof ArrayBuffer&&(t=new Uint8Array(t)),_.affirmIsDb(t);const i=t.byteLength,[n,s]=await h.getDirForFilename(e,!0);let r,o=0;try{const e=await n.getFileHandle(s,{create:!0});return r=await e.createSyncAccessHandle(),r.truncate(0),o=r.write(t,{at:0}),o!=i&&c("Expected to write "+i+" bytes but wrote "+o+"."),r.write(new Uint8Array([1,1]),{at:18}),o}catch(a){throw r&&(await r.close(),r=void 0),await n.removeEntry(s).catch((()=>{})),a}finally{r&&await r.close()}},e.oo1){const t=function(...t){const i=e.oo1.DB.dbCtorHelper.normalizeArgs(...t);i.vfs=b.$zName,e.oo1.DB.dbCtorHelper.call(this,i)};t.prototype=Object.create(e.oo1.DB.prototype),e.oo1.OpfsDb=t,t.importDb=h.importDb,e.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(b.pointer,(function(e,t){t.capi.sqlite3_busy_timeout(e,1e4)}))}v.onmessage=function({data:t}){switch(t.type){case"opfs-unavailable":q(new Error(t.payload.join(" ")));break;case"opfs-async-loaded":v.postMessage({type:"opfs-async-init",args:S});break;case"opfs-async-inited":if(!0===y)break;try{e.vfs.installVfs({io:{struct:g,methods:P},vfs:{struct:b,methods:C}}),S.sabOPView=new Int32Array(S.sabOP),S.sabFileBufView=new Uint8Array(S.sabIO,0,S.fileBufferSize),S.sabS11nView=new Uint8Array(S.sabIO,S.sabS11nOffset,S.sabS11nSize),(()=>{if(S.s11n)return S.s11n;const e=new TextDecoder,t=new TextEncoder("utf-8"),i=new Uint8Array(S.sabIO,S.sabS11nOffset,S.sabS11nSize),n=new DataView(S.sabIO,S.sabS11nOffset,S.sabS11nSize);S.s11n=Object.create(null);const s=Object.create(null);s.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},s.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},s.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},s.string={id:4};const r=e=>{switch(e){case s.number.id:return s.number;case s.bigint.id:return s.bigint;case s.boolean.id:return s.boolean;case s.string.id:return s.string;default:c("Invalid type ID:",e)}};S.s11n.deserialize=function(t=!1){++k.s11n.deserialize.count;const s=performance.now(),o=i[0],a=o?[]:null;if(o){const t=[];let s,l,c,u=1;for(s=0;s<o;++s,++u)t.push(r(i[u]));for(s=0;s<o;++s){const r=t[s];r.getter?(c=n[r.getter](u,S.littleEndian),u+=r.size):(l=n.getInt32(u,S.littleEndian),u+=4,c=e.decode(i.slice(u,u+l)),u+=l),a.push(c)}}return t&&(i[0]=0),k.s11n.deserialize.time+=performance.now()-s,a},S.s11n.serialize=function(...e){const r=performance.now();if(++k.s11n.serialize.count,e.length){const r=[];let a=0,l=1;for(i[0]=255&e.length;a<e.length;++a,++l)r.push((o=e[a],s[typeof o]||c("Maintenance required: this value type cannot be serialized.",o))),i[l]=r[a].id;for(a=0;a<e.length;++a){const s=r[a];if(s.setter)n[s.setter](l,e[a],S.littleEndian),l+=s.size;else{const s=t.encode(e[a]);n.setInt32(l,s.byteLength,S.littleEndian),l+=4,i.set(s,l),l+=s.byteLength}}}else i[0]=0;var o;k.s11n.serialize.time+=performance.now()-r},S.s11n})(),i.sanityChecks&&(a("Running sanity checks because of opfs-sanity-check URL arg..."),function(){const e=f.scopedAllocPush(),t=new d;try{const e=t.pointer,i=u.SQLITE_OPEN_CREATE|u.SQLITE_OPEN_READWRITE|u.SQLITE_OPEN_MAIN_DB,n=f.scopedAlloc(8),s="/sanity/check/file"+I(8),r=f.scopedAllocCString(s);let _;if(S.s11n.serialize("This is  string."),_=S.s11n.deserialize(),o("deserialize() says:",_),"This is  string."!==_[0]&&c("String d13n error."),C.xAccess(b.pointer,r,0,n),_=f.peek(n,"i32"),o("xAccess(",s,") exists ?=",_),_=C.xOpen(b.pointer,r,e,i,n),o("open rc =",_,"state.sabOPView[xOpen] =",S.sabOPView[S.opIds.xOpen]),0!==_)return void l("open failed with code",_);C.xAccess(b.pointer,r,0,n),_=f.peek(n,"i32"),_||c("xAccess() failed to detect file."),_=P.xSync(t.pointer,0),_&&c("sync failed w/ rc",_),_=P.xTruncate(t.pointer,1024),_&&c("truncate failed w/ rc",_),f.poke(n,0,"i64"),_=P.xFileSize(t.pointer,n),_&&c("xFileSize failed w/ rc",_),o("xFileSize says:",f.peek(n,"i64")),_=P.xWrite(t.pointer,r,10,1),_&&c("xWrite() failed!");const p=f.scopedAlloc(16);_=P.xRead(t.pointer,p,6,2),f.poke(p+6,0);let d=f.cstrToJs(p);o("xRead() got:",d),"sanity"!==d&&c("Unexpected xRead() value."),C.xSleep&&(o("xSleep()ing before close()ing..."),C.xSleep(b.pointer,2e3),o("waking up from xSleep()")),_=P.xClose(e),o("xClose rc =",_,"sabOPView =",S.sabOPView),o("Deleting file:",s),C.xDelete(b.pointer,r,4660),C.xAccess(b.pointer,r,0,n),_=f.peek(n,"i32"),_&&c("Expecting 0 from xAccess(",s,") after xDelete()."),a("End of OPFS sanity checks.")}finally{t.dispose(),f.scopedAllocPop(e)}}()),globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&navigator?.storage?.getDirectory?navigator.storage.getDirectory().then((t=>{v.onerror=v._originalOnError,delete v._originalOnError,e.opfs=h,h.rootDirectory=t,o("End of OPFS sqlite3_vfs setup.",b),w()})).catch(q):w()}catch(n){l(n),q(n)}break;default:{const e="Unexpected message from the OPFS async worker: "+JSON.stringify(t);l(e),q(new Error(e));break}}}}));return s};t.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push((async e=>{try{let i=t.defaultProxyUri;return e.scriptInfo.sqlite3Dir&&(t.defaultProxyUri=e.scriptInfo.sqlite3Dir+i),t().catch((t=>{e.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",t.message)}))}catch(i){return e.config.error("installOpfsVfs() exception:",i),Promise.reject(i)}}))})),globalThis.sqlite3ApiBootstrap.initializers.push((function(e){const t=e.util.toss,i=e.util.toss3,n=Object.create(null),s=e.capi,r=e.util,o=e.wasm,a=512,l=4096,c=s.SQLITE_OPEN_MAIN_DB|s.SQLITE_OPEN_MAIN_JOURNAL|s.SQLITE_OPEN_SUPER_JOURNAL|s.SQLITE_OPEN_WAL,u=".opaque",_=()=>Math.random().toString(36).slice(2),f=new TextDecoder,p=new TextEncoder,d=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),m=[e.config.error,e.config.warn,e.config.log];e.config.log;const h=e.config.warn;e.config.error;const g=new Map,b=e=>g.get(e),y=(e,t)=>{t?g.set(e,t):g.delete(e)},q=new Map,w=e=>q.get(e),v=(e,t)=>{t?q.set(e,t):q.delete(e)},x={xCheckReservedLock:function(e,t){const i=w(e);return i.log("xCheckReservedLock"),i.storeErr(),o.poke32(t,1),0},xClose:function(e){const t=w(e);t.storeErr();const i=t.getOFileForS3File(e);if(i)try{t.log(`xClose ${i.path}`),t.mapS3FileToOFile(e,!1),i.sah.flush(),i.flags&s.SQLITE_OPEN_DELETEONCLOSE&&t.deletePath(i.path)}catch(n){return t.storeErr(n,s.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(e){return s.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(e,t,i){return s.SQLITE_NOTFOUND},xFileSize:function(e,t){const i=w(e);i.log("xFileSize");const n=i.getOFileForS3File(e).sah.getSize()-l;return o.poke64(t,BigInt(n)),0},xLock:function(e,t){const i=w(e);i.log(`xLock ${t}`),i.storeErr();return i.getOFileForS3File(e).lockType=t,0},xRead:function(e,t,i,n){const r=w(e);r.storeErr();const a=r.getOFileForS3File(e);r.log(`xRead ${a.path} ${i} @ ${n}`);try{const e=a.sah.read(o.heap8u().subarray(t,t+i),{at:l+Number(n)});return e<i?(o.heap8u().fill(0,t+e,t+i),s.SQLITE_IOERR_SHORT_READ):0}catch(c){return r.storeErr(c,s.SQLITE_IOERR)}},xSectorSize:function(e){return 4096},xSync:function(e,t){const i=w(e);i.log(`xSync ${t}`),i.storeErr();const n=i.getOFileForS3File(e);try{return n.sah.flush(),0}catch(r){return i.storeErr(r,s.SQLITE_IOERR)}},xTruncate:function(e,t){const i=w(e);i.log(`xTruncate ${t}`),i.storeErr();const n=i.getOFileForS3File(e);try{return n.sah.truncate(l+Number(t)),0}catch(r){return i.storeErr(r,s.SQLITE_IOERR)}},xUnlock:function(e,t){const i=w(e);i.log("xUnlock");return i.getOFileForS3File(e).lockType=t,0},xWrite:function(e,i,n,r){const a=w(e);a.storeErr();const c=a.getOFileForS3File(e);a.log(`xWrite ${c.path} ${n} ${r}`);try{return n===c.sah.write(o.heap8u().subarray(i,i+n),{at:l+Number(r)})?0:t("Unknown write() failure.")}catch(u){return a.storeErr(u,s.SQLITE_IOERR)}}},E=new s.sqlite3_io_methods;E.$iVersion=1,e.vfs.installVfs({io:{struct:E,methods:x}});const S={xAccess:function(e,t,i,n){const s=b(e);s.storeErr();try{const e=s.getPath(t);o.poke32(n,s.hasFilename(e)?1:0)}catch(r){o.poke32(n,0)}return 0},xCurrentTime:function(e,t){return o.poke(t,2440587.5+(new Date).getTime()/864e5,"double"),0},xCurrentTimeInt64:function(e,t){return o.poke(t,21086676e7+(new Date).getTime(),"i64"),0},xDelete:function(e,t,i){const n=b(e);n.log(`xDelete ${o.cstrToJs(t)}`),n.storeErr();try{return n.deletePath(n.getPath(t)),0}catch(r){return n.storeErr(r),s.SQLITE_IOERR_DELETE}},xFullPathname:function(e,t,i,n){return o.cstrncpy(n,t,i)<i?0:s.SQLITE_CANTOPEN},xGetLastError:function(e,t,i){const n=b(e),r=n.popErr();if(n.log(`xGetLastError ${t} e =`,r),r){const e=o.scopedAllocPush();try{const[e,n]=o.scopedAllocCString(r.message,!0);o.cstrncpy(i,e,t),n>t&&o.poke8(i+t-1,0)}catch(a){return s.SQLITE_NOMEM}finally{o.scopedAllocPop(e)}}return r?r.sqlite3Rc||s.SQLITE_IOERR:0},xOpen:function(e,i,n,r,a){const l=b(e);try{l.log(`xOpen ${o.cstrToJs(i)} ${r}`);const e=i&&o.peek8(i)?l.getPath(i):_();let c=l.getSAHForPath(e);!c&&r&s.SQLITE_OPEN_CREATE&&(l.getFileCount()<l.getCapacity()?(c=l.nextAvailableSAH(),l.setAssociatedPath(c,e,r)):t("SAH pool is full. Cannot create file",e)),c||t("file not found:",e);const u={path:e,flags:r,sah:c};l.mapS3FileToOFile(n,u),u.lockType=s.SQLITE_LOCK_NONE;const f=new s.sqlite3_file(n);return f.$pMethods=E.pointer,f.dispose(),o.poke32(a,r),0}catch(c){return l.storeErr(c),s.SQLITE_CANTOPEN}}};class k{vfsDir;#e;#t;#i;#n=new Map;#s=new Map;#r=new Set;#o=new Map;#a=new Uint8Array(516);#l;#c;#u;constructor(t=Object.create(null)){this.#u=t.verbosity??d.verbosity,this.vfsName=t.name||d.name,this.#c=function(t){e.capi.sqlite3_vfs_find(t)&&i("VFS name is already registered:",t);const n=new s.sqlite3_vfs,r=s.sqlite3_vfs_find(null),l=r?new s.sqlite3_vfs(r):null;return n.$iVersion=2,n.$szOsFile=s.sqlite3_file.structInfo.sizeof,n.$mxPathname=a,n.addOnDispose(n.$zName=o.allocCString(t),(()=>y(n.pointer,0))),l&&(n.$xRandomness=l.$xRandomness,n.$xSleep=l.$xSleep,l.dispose()),n.$xRandomness||S.xRandomness||(S.xRandomness=function(e,t,i){const n=o.heap8u();let s=0;for(;s<t;++s)n[i+s]=255e3*Math.random()&255;return s}),n.$xSleep||S.xSleep||(S.xSleep=(e,t)=>0),e.vfs.installVfs({vfs:{struct:n,methods:S}}),n}(this.vfsName),y(this.#c.pointer,this),this.vfsDir=t.directory||"."+this.vfsName,this.#l=new DataView(this.#a.buffer,this.#a.byteOffset),this.isReady=this.reset(!!(t.clearOnInit??d.clearOnInit)).then((()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(t.initialCapacity||d.initialCapacity)}))}#_(e,...t){this.#u>e&&m[e](this.vfsName+":",...t)}log(...e){this.#_(2,...e)}warn(...e){this.#_(1,...e)}error(...e){this.#_(0,...e)}getVfs(){return this.#c}getCapacity(){return this.#n.size}getFileCount(){return this.#s.size}getFileNames(){const e=[],t=this.#s.keys();for(const i of t)e.push(i);return e}async addCapacity(e){for(let t=0;t<e;++t){const e=_(),t=await this.#t.getFileHandle(e,{create:!0}),i=await t.createSyncAccessHandle();this.#n.set(i,e),this.setAssociatedPath(i,"",0)}return this.getCapacity()}async reduceCapacity(e){let t=0;for(const i of Array.from(this.#r)){if(t===e||this.getFileCount()===this.getCapacity())break;const n=this.#n.get(i);i.close(),await this.#t.removeEntry(n),this.#n.delete(i),this.#r.delete(i),++t}return t}releaseAccessHandles(){for(const e of this.#n.keys())e.close();this.#n.clear(),this.#s.clear(),this.#r.clear()}async acquireAccessHandles(e){const t=[];for await(const[i,n]of this.#t)"file"===n.kind&&t.push([i,n]);return Promise.all(t.map((async([t,i])=>{try{const n=await i.createSyncAccessHandle();if(this.#n.set(n,t),e)n.truncate(l),this.setAssociatedPath(n,"",0);else{const e=this.getAssociatedPath(n);e?this.#s.set(e,n):this.#r.add(n)}}catch(n){throw this.storeErr(n),this.releaseAccessHandles(),n}})))}getAssociatedPath(e){e.read(this.#a,{at:0});const t=this.#l.getUint32(512);if(this.#a[0]&&(t&s.SQLITE_OPEN_DELETEONCLOSE||!(t&c)))return h(`Removing file with unexpected flags ${t.toString(16)}`,this.#a),this.setAssociatedPath(e,"",0),"";const i=new Uint32Array(2);e.read(i,{at:516});const n=this.computeDigest(this.#a);if(i.every(((e,t)=>e===n[t]))){const t=this.#a.findIndex((e=>0===e));return 0===t&&e.truncate(l),t?f.decode(this.#a.subarray(0,t)):""}return h("Disassociating file with bad digest."),this.setAssociatedPath(e,"",0),""}setAssociatedPath(e,i,n){const s=p.encodeInto(i,this.#a);a<=s.written+1&&t("Path too long:",i),this.#a.fill(0,s.written,a),this.#l.setUint32(512,n);const r=this.computeDigest(this.#a);e.write(this.#a,{at:0}),e.write(r,{at:516}),e.flush(),i?(this.#s.set(i,e),this.#r.delete(e)):(e.truncate(l),this.#r.add(e))}computeDigest(e){let t=3735928559,i=1103547991;for(const n of e)t=31*t+307*n,i=31*i+307*n;return new Uint32Array([t>>>0,i>>>0])}async reset(e){await this.isReady;let t,i=await navigator.storage.getDirectory();for(const n of this.vfsDir.split("/"))n&&(t=i,i=await i.getDirectoryHandle(n,{create:!0}));return this.#e=i,this.#i=t,this.#t=await this.#e.getDirectoryHandle(u,{create:!0}),this.releaseAccessHandles(),this.acquireAccessHandles(e)}getPath(e){return o.isPtr(e)&&(e=o.cstrToJs(e)),(e instanceof URL?e:new URL(e,"file://localhost/")).pathname}deletePath(e){const t=this.#s.get(e);return t&&(this.#s.delete(e),this.setAssociatedPath(t,"",0)),!!t}storeErr(e,t){return e&&(e.sqlite3Rc=t||s.SQLITE_IOERR,this.error(e)),this.$error=e,t}popErr(){const e=this.$error;return this.$error=void 0,e}nextAvailableSAH(){const[e]=this.#r.keys();return e}getOFileForS3File(e){return this.#o.get(e)}mapS3FileToOFile(e,t){t?(this.#o.set(e,t),v(e,this)):(this.#o.delete(e),v(e,!1))}hasFilename(e){return this.#s.has(e)}getSAHForPath(e){return this.#s.get(e)}async removeVfs(){if(!this.#c.pointer||!this.#t)return!1;s.sqlite3_vfs_unregister(this.#c.pointer),this.#c.dispose(),delete n[this.vfsName];try{this.releaseAccessHandles(),await this.#e.removeEntry(u,{recursive:!0}),this.#t=void 0,await this.#i.removeEntry(this.#e.name,{recursive:!0}),this.#e=this.#i=void 0}catch(t){e.config.error(this.vfsName,"removeVfs() failed:",t)}return!0}exportFile(e){const i=this.#s.get(e)||t("File not found:",e),n=i.getSize()-l,s=new Uint8Array(n>0?n:0);if(n>0){const e=i.read(s,{at:l});e!=n&&t("Expected to read "+n+" bytes but read "+e+".")}return s}async importDbChunked(e,i){const n=this.#s.get(e)||this.nextAvailableSAH()||t("No available handles to import to.");n.truncate(0);let o,a=0,c=!1;try{for(;void 0!==(o=await i());)o instanceof ArrayBuffer&&(o=new Uint8Array(o)),0===a&&o.byteLength>=15&&(r.affirmDbHeader(o),c=!0),n.write(o,{at:l+a}),a+=o.byteLength;if((a<512||0!=a%512)&&t("Input size",a,"is not correct for an SQLite database."),!c){const e=new Uint8Array(20);n.read(e,{at:0}),r.affirmDbHeader(e)}n.write(new Uint8Array([1,1]),{at:4114})}catch(u){throw this.setAssociatedPath(n,"",0),u}return this.setAssociatedPath(n,e,s.SQLITE_OPEN_MAIN_DB),a}importDb(e,i){if(i instanceof ArrayBuffer)i=new Uint8Array(i);else if(i instanceof Function)return this.importDbChunked(e,i);const n=this.#s.get(e)||this.nextAvailableSAH()||t("No available handles to import to."),r=i.byteLength;(r<512||r%512!=0)&&t("Byte array size is invalid for an SQLite db.");const o="SQLite format 3";for(let s=0;s<15;++s)o.charCodeAt(s)!==i[s]&&t("Input does not contain an SQLite database header.");const a=n.write(i,{at:l});return a!=r?(this.setAssociatedPath(n,"",0),t("Expected to write "+r+" bytes but wrote "+a+".")):(n.write(new Uint8Array([1,1]),{at:4114}),this.setAssociatedPath(n,e,s.SQLITE_OPEN_MAIN_DB)),a}}class A{#f;constructor(e){this.#f=e,this.vfsName=e.vfsName}async addCapacity(e){return this.#f.addCapacity(e)}async reduceCapacity(e){return this.#f.reduceCapacity(e)}getCapacity(){return this.#f.getCapacity(this.#f)}getFileCount(){return this.#f.getFileCount()}getFileNames(){return this.#f.getFileNames()}async reserveMinimumCapacity(e){const t=this.#f.getCapacity();return t<e?this.#f.addCapacity(e-t):t}exportFile(e){return this.#f.exportFile(e)}importDb(e,t){return this.#f.importDb(e,t)}async wipeFiles(){return this.#f.reset(!0)}unlink(e){return this.#f.deletePath(e)}async removeVfs(){return this.#f.removeVfs()}}e.installOpfsSAHPoolVfs=async function(i=Object.create(null)){const s=(i=Object.assign(Object.create(null),d,i||{})).name;if(i.$testThrowPhase1)throw i.$testThrowPhase1;if(n[s])try{return await n[s]}catch(r){if(!i.forceReinitIfPreviouslyFailed)throw r;delete n[s]}return globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&navigator?.storage?.getDirectory?n[s]=(async()=>{const e=await navigator.storage.getDirectory(),i=".opfs-sahpool-sync-check-"+_(),n=await e.getFileHandle(i,{create:!0}),s=(await n.createSyncAccessHandle()).close();return await s,await e.removeEntry(i),s?.then&&t("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0})().then((async function(){if(i.$testThrowPhase2)throw i.$testThrowPhase2;const t=new k(i);return t.isReady.then((async()=>{const i=new A(t);if(e.oo1){const n=e.oo1,s=t.getVfs(),r=function(...e){const t=n.DB.dbCtorHelper.normalizeArgs(...e);t.vfs=s.$zName,n.DB.dbCtorHelper.call(this,t)};r.prototype=Object.create(n.DB.prototype),i.OpfsSAHPoolDb=r}return t.log("VFS initialized."),i})).catch((async e=>{throw await t.removeVfs().catch((()=>{})),e}))})).catch((e=>n[s]=Promise.reject(e))):n[s]=Promise.reject(new Error("Missing required OPFS APIs."))}})),void 0!==e){const i=Object.assign(Object.create(null),{exports:void 0===me?e.asm:me,memory:e.wasmMemory},globalThis.sqlite3ApiConfig||{});let n;globalThis.sqlite3ApiConfig=i;try{n=globalThis.sqlite3ApiBootstrap()}catch(t){throw console.error("sqlite3ApiBootstrap() error:",t),t}finally{delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig}e.sqlite3=n}else console.warn("This is not running in an Emscripten module context, so","globalThis.sqlite3ApiBootstrap() is _not_ being called due to lack","of config info for the WASM environment.","It must be called manually.")})),s})();const V=function(){const e=H;if(!e)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const t=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:globalThis?.document?.currentScript,isWorker:"undefined"!=typeof WorkerGlobalScope,location:globalThis.location,urlParams:globalThis?.location?.href?new URL(globalThis.location.href).searchParams:new URLSearchParams});if(t.debugModule=t.urlParams.has("sqlite3.debugModule")?(...e)=>console.warn("sqlite3.debugModule:",...e):()=>{},t.urlParams.has("sqlite3.dir"))t.sqlite3Dir=t.urlParams.get("sqlite3.dir")+"/";else if(t.moduleScript){const e=t.moduleScript.src.split("/");e.pop(),t.sqlite3Dir=e.join("/")+"/"}if(globalThis.sqlite3InitModule=function i(...n){return e(...n).then((e=>{const n=e.sqlite3;n.scriptInfo=t,i.__isUnderTest&&(n.__isUnderTest=!0);const s=n.asyncPostInit;return delete n.asyncPostInit,s()})).catch((e=>{throw console.error("Exception loading sqlite3 module:",e),e}))},globalThis.sqlite3InitModule.ready=e.ready,globalThis.sqlite3InitModuleState.moduleScript){const e=globalThis.sqlite3InitModuleState;let t=e.moduleScript.src.split("/");t.pop(),e.scriptDir=t.join("/")+"/"}return t.debugModule("sqlite3InitModuleState =",t),globalThis.sqlite3InitModule}();var G=H=V;function K(e){return new DataView(e.buffer,e.byteOffset)}const J={len:1,get:(e,t)=>K(e).getUint8(t),put:(e,t,i)=>(K(e).setUint8(t,i),t+1)},X={len:2,get:(e,t)=>K(e).getUint16(t,!0),put:(e,t,i)=>(K(e).setUint16(t,i,!0),t+2)},Y={len:2,get:(e,t)=>K(e).getUint16(t),put:(e,t,i)=>(K(e).setUint16(t,i),t+2)},Z={len:4,get:(e,t)=>K(e).getUint32(t,!0),put:(e,t,i)=>(K(e).setUint32(t,i,!0),t+4)},ee={len:4,get:(e,t)=>K(e).getUint32(t),put:(e,t,i)=>(K(e).setUint32(t,i),t+4)},te={len:4,get:(e,t)=>K(e).getInt32(t),put:(e,t,i)=>(K(e).setInt32(t,i),t+4)},ie={len:8,get:(e,t)=>K(e).getBigUint64(t,!0),put:(e,t,i)=>(K(e).setBigUint64(t,i,!0),t+8)};class ne{constructor(e,t){this.len=e,this.encoding=t,this.textDecoder=new TextDecoder(t)}get(e,t){return this.textDecoder.decode(e.subarray(t,t+this.len))}}class se extends Error{constructor(){super("End-Of-Stream")}}class re{constructor(){this.maxStreamReadSize=1048576,this.endOfStream=!1,this.peekQueue=[]}async peek(e,t,i){const n=await this.read(e,t,i);return this.peekQueue.push(e.subarray(t,t+n)),n}async read(e,t,i){if(0===i)return 0;let n=this.readFromPeekBuffer(e,t,i);if(n+=await this.readRemainderFromStream(e,t+n,i-n),0===n)throw new se;return n}readFromPeekBuffer(e,t,i){let n=i,s=0;for(;this.peekQueue.length>0&&n>0;){const i=this.peekQueue.pop();if(!i)throw new Error("peekData should be defined");const r=Math.min(i.length,n);e.set(i.subarray(0,r),t+s),s+=r,n-=r,r<i.length&&this.peekQueue.push(i.subarray(r))}return s}async readRemainderFromStream(e,t,i){let n=i,s=0;for(;n>0&&!this.endOfStream;){const i=Math.min(n,this.maxStreamReadSize),r=await this.readFromStream(e,t+s,i);if(0===r)break;s+=r,n-=r}return s}}class oe extends re{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,t,i){if(this.endOfStream)throw new se;const n=await this.reader.read(new Uint8Array(i));return n.done&&(this.endOfStream=n.done),n.value?(e.set(n.value,t),n.value.byteLength):0}async abort(){await this.reader.cancel(),this.reader.releaseLock()}}class ae{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e?.fileInfo??{},this.onClose=e?.onClose,e?.abortSignal&&e.abortSignal.addEventListener("abort",(()=>{this.abort()}))}async readToken(e,t=this.position){const i=new Uint8Array(e.len);if(await this.readBuffer(i,{position:t})<e.len)throw new se;return e.get(i,0)}async peekToken(e,t=this.position){const i=new Uint8Array(e.len);if(await this.peekBuffer(i,{position:t})<e.len)throw new se;return e.get(i,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new se;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new se;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){await this.abort(),await(this.onClose?.())}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}abort(){return Promise.resolve()}}class le extends ae{constructor(e,t){super(t),this.streamReader=e}async readBuffer(e,t){const i=this.normalizeOptions(e,t),n=i.position-this.position;if(n>0)return await this.ignore(n),this.readBuffer(e,t);if(n<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===i.length)return 0;const s=await this.streamReader.read(e,i.offset,i.length);if(this.position+=s,(!t||!t.mayBeLess)&&s<i.length)throw new se;return s}async peekBuffer(e,t){const i=this.normalizeOptions(e,t);let n=0;if(i.position){const t=i.position-this.position;if(t>0){const s=new Uint8Array(i.length+t);return n=await this.peekBuffer(s,{mayBeLess:i.mayBeLess}),e.set(s.subarray(t),i.offset),n-t}if(t<0)throw new Error("Cannot peek from a negative offset in a stream")}if(i.length>0){try{n=await this.streamReader.peek(e,i.offset,i.length)}catch(s){if(t?.mayBeLess&&s instanceof se)return 0;throw s}if(!i.mayBeLess&&n<i.length)throw new se}return n}async ignore(e){const t=Math.min(256e3,e),i=new Uint8Array(t);let n=0;for(;n<e;){const s=e-n,r=await this.readBuffer(i,{length:Math.min(t,s)});if(r<0)return r;n+=r}return n}abort(){return this.streamReader.abort()}}class ce extends ae{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,t){if(t?.position){if(t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}const i=await this.peekBuffer(e,t);return this.position+=i,i}async peekBuffer(e,t){const i=this.normalizeOptions(e,t),n=Math.min(this.uint8Array.length-i.position,i.length);if(!i.mayBeLess&&n<i.length)throw new se;return e.set(this.uint8Array.subarray(i.position,i.position+n),i.offset),n}close(){return super.close()}}function ue(e){const{byteLength:t}=e;return 6===t?e.getUint16(0)*2**32+e.getUint32(2):5===t?e.getUint8(0)*2**32+e.getUint32(1):4===t?e.getUint32(0):3===t?65536*e.getUint8(0)+e.getUint16(1):2===t?e.getUint16(0):1===t?e.getUint8(0):void 0}function _e(e,t){const i=e.length,n=t.length;if(0===n)return-1;if(n>i)return-1;const s=i-n;for(let r=0;r<=s;r++){let i=!0;for(let s=0;s<n;s++)if(e[r+s]!==t[s]){i=!1;break}if(i)return r}return-1}new globalThis.TextDecoder("utf8"),new globalThis.TextEncoder,Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));const fe={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},pe=4100;function de(e,t,i){i={offset:0,...i};for(const[n,s]of t.entries())if(i.mask){if(s!==(i.mask[n]&e[n+i.offset]))return!1}else if(s!==e[n+i.offset])return!1;return!0}class me{constructor(e){this.detectors=e?.customDetectors,this.tokenizerOptions={abortSignal:e?.signal},this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const t=e.position;for(const i of this.detectors||[]){const n=await i(e);if(n)return n;if(t!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const t=e instanceof Uint8Array?e:new Uint8Array(e);var i,n;if(t?.length>1)return this.fromTokenizer((i=t,n=this.tokenizerOptions,new ce(i,n)))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const t=await(i=e,n=this.tokenizerOptions,new le(new oe(i),n));var i,n;try{return await this.fromTokenizer(t)}finally{await t.close()}}async toDetectionStream(e,t){const{sampleSize:i=pe}=t;let n,s;const r=e.getReader({mode:"byob"});try{const{value:e,done:t}=await r.read(new Uint8Array(i));if(s=e,!t&&e)try{n=await this.fromBuffer(e.slice(0,i))}catch(l){if(!(l instanceof se))throw l;n=void 0}s=e}finally{r.releaseLock()}const o=new TransformStream({async start(e){e.enqueue(s)},transform(e,t){t.enqueue(e)}}),a=e.pipeThrough(o);return a.fileType=n,a}check(e,t){return de(this.buffer,e,t)}checkString(e,t){return this.check((i=e,[...i].map((e=>e.charCodeAt(0)))),t);var i}async parse(e){if(this.buffer=new Uint8Array(pe),void 0===e.fileInfo.size&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const s=await e.readToken(fe);return e.position+s>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(s),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===this.buffer[0]||70===this.buffer[0])&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const r=new DataView(this.buffer.buffer),o={compressedSize:r.getUint32(18,!0),uncompressedSize:r.getUint32(22,!0),filenameLength:r.getUint16(26,!0),extraFieldLength:r.getUint16(28,!0)};if(o.filename=await e.readToken(new ne(o.filenameLength,"utf-8")),await e.ignore(o.extraFieldLength),/classes\d*\.dex/.test(o.filename))return{ext:"apk",mime:"application/vnd.android.package-archive"};if("META-INF/mozilla.rsa"===o.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(o.filename.endsWith(".rels")||o.filename.endsWith(".xml")){switch(o.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"}}}if(o.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(o.filename.startsWith("3D/")&&o.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===o.filename&&o.compressedSize===o.uncompressedSize){let a=await e.readToken(new ne(o.compressedSize,"utf-8"));switch(a=a.trim(),a){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}}if(0===o.compressedSize){let l=-1;for(;l<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),l=_e(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(l>=0?l:this.buffer.length)}else await e.ignore(o.compressedSize)}}catch(n){if(!(n instanceof se))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const c=new Uint8Array(8);return await e.readBuffer(c),de(c,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/ogg; codecs=opus"}:de(c,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:de(c,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:de(c,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:de(c,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:de(c,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(3===this.buffer[2]||5===this.buffer[2]||7===this.buffer[2])&&(4===this.buffer[3]||6===this.buffer[3]||8===this.buffer[3]))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&96&this.buffer[8]){const u=new ne(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(u){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return u.startsWith("3g")?u.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const _=10485760,f=new Uint8Array(Math.min(_,e.fileInfo.size));if(await e.readBuffer(f,{mayBeLess:!0}),t=f,i=(new TextEncoder).encode("AIPrivateData"),-1!==_e(t,i))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof se))throw n}return{ext:"pdf",mime:"application/pdf"}}var t,i;if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const p=await this.readTiffHeader(!1);if(p)return p}if(this.check([77,77])){const d=await this.readTiffHeader(!0);if(d)return d}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function m(){const t=await e.peekNumber(J);let i=128,n=0;for(;!(t&i)&&0!==i;)++n,i>>=1;const s=new Uint8Array(n+1);return await e.readBuffer(s),s}async function h(){const e=await m(),t=await m();t[0]^=128>>t.length-1;const i=Math.min(6,t.length),n=new DataView(e.buffer),s=new DataView(t.buffer,t.length-i,i);return{id:ue(n),len:ue(s)}}async function g(t){for(;t>0;){const i=await h();if(17026===i.id){return(await e.readToken(new ne(i.len))).replaceAll(/\00.*$/g,"")}await e.ignore(i.len),--t}}const b=await h();switch(await g(b.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(0===this.buffer[6]||1===this.buffer[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const y=new ne(4,"latin1").get(this.buffer,2);if(y.match("^d*")&&y>=1e3&&y<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>")){await e.ignore(8);return"debian-binary"===await e.readToken(new ne(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"}}if(this.checkString("WEBVTT")&&["\n","\r","\t"," ","\0"].some((e=>this.checkString(e,{offset:6}))))return{ext:"vtt",mime:"text/vtt"};if(this.check([137,80,78,71,13,10,26,10])){async function q(){return{length:await e.readToken(te),type:await e.readToken(new ne(4,"latin1"))}}await e.ignore(8);do{const w=await q();if(w.length<0)return;switch(w.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(w.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function v(){const t=new Uint8Array(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(ie))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const x=await v();let E=x.size-24;if(de(x.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const S=new Uint8Array(16);if(E-=await e.readBuffer(S),de(S,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(de(S,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(E)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10])){await e.ignore(20);switch(await e.readToken(new ne(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("**ACE",{offset:7})&&this.checkString("**",{offset:12}))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const k=new DataView(this.buffer.buffer).getUint32(12,!0);if(k>12&&this.buffer.length>=k+16)try{const A=(new TextDecoder).decode(this.buffer.slice(16,k+16));if(JSON.parse(A).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),function(e,t=0){const i=Number.parseInt(new ne(6).get(e,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(i))return!1;let n=256;for(let s=t;s<t+148;s++)n+=e[s];for(let s=t+156;s<t+512;s++)n+=e[s];return i===n}(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const t=await this.tokenizer.readToken(e?Y:X);switch(this.tokenizer.ignore(10),t){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const t=await this.tokenizer.readToken(e?Y:X);for(let i=0;i<t;++i){const t=await this.readTiffTag(e);if(t)return t}}async readTiffHeader(e){const t=(e?Y:X).get(this.buffer,2),i=(e?ee:Z).get(this.buffer,4);if(42===t){if(i>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(i>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}await this.tokenizer.ignore(i);return await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(43===t)return{ext:"tif",mime:"image/tiff"}}}new Set(["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx","vtt","apk"]),new Set(["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","video/ogg","audio/ogg","audio/ogg; codecs=opus","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","text/vtt","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio","application/vnd.android.package-archive"]);const he="",ge=()=>new Promise((e=>setTimeout(e,0))),be=e=>new Promise((t=>setTimeout(t,e)));function ye(e,...t){return e.reduce(((i,n,s)=>{let r=t[s]??"";const o=(e[s+1]??"").trim(),a=n.trim();return a.endsWith('"')&&o.startsWith('"')?r=String(r).replaceAll('"','""'):a.endsWith("'")&&o.startsWith("'")&&(r=String(r).replaceAll("'","''")),i+n+r}),"")}async function qe(e){return await async function(e){return(new me).fromBuffer(e)}(e)}async function we(e){const t=await e;return t.objectValues=await Promise.all(t.objectValues.map((async e=>{for(const t in e){const i=e[t];if(i instanceof Uint8Array){const n=await qe(i);e[`${t}__mime__`]=n}}return e}))),t}function ve(e){return/JSON/i.test(e)?"JSON":/DATE/i.test(e)?"DATE":/(BOOLEAN|^BIT$)/i.test(e)?"BOOLEAN":/INT/i.test(e)?"INTEGER":/(CHAR|CLOB|TEXT)/i.test(e)?"TEXT":/BLOB/i.test(e)?"BLOB":/(REAL|FLOA|DOUB)/i.test(e)?"REAL":/(NUMERIC|DECIMAL)/i.test(e)?"NUMERIC":"?"}async function xe(e,{type:t,sql:i,...n},s){const r=n.tbl_name;let o,a,l;o=ye`SELECT tableInfo.*, foreignKeyList."table" AS fkTable, foreignKeyList."to" AS fkName, CASE WHEN foreignKeyList."from" IS NOT NULL THEN 1 ELSE 0 END AS fk FROM pragma_table_xinfo('${r}') AS tableInfo LEFT JOIN (SELECT * FROM pragma_foreign_key_list('${r}')) AS foreignKeyList ON foreignKeyList."from"=tableInfo.name GROUP BY tableInfo.name ORDER BY tableInfo.cid`;try{a=await e.execAsObject(o,s)}catch(f){l=f,a={objectValues:[],columns:[]}}const c=Math.max(...a.objectValues.map((({pk:e})=>e)).filter((e=>!!e))),u=a.objectValues.map((({cid:e,notnull:t,name:i,type:n,pk:s,fk:r,fkTable:o,fkName:a,dflt_value:l,hidden:u})=>({cid:e,notnull:t,name:i,type:n,typeAffinity:ve(n),pk:s,numPk:c,fk:r,fkTable:o,fkName:a,dflt_value:l,hidden:u})));u.unshift({cid:-1,notnull:0,name:"ROWID",type:"ROWID",typeAffinity:"ROWID",pk:0,numPk:0,fk:0,fkTable:0,fkName:0,dflt_value:void 0,hidden:0});const _="table"===t&&!/WITHOUT\s+ROWID/i.test(i)||"index"===t;return{...n,error:l,sql:i,hasRowId:_,uiName:n.name,tblName:r,rootPage:n.rootpage,type:t,sub:t,columnsMeta:u,columnsMetaByName:Object.fromEntries(u.map((e=>[e.name,e])))}}async function Ee(e,t,i){const n=await e.execAsObject("SELECT * FROM main.sqlite_schema ORDER BY type, tbl_name",i);return async function(e,t,i,n){const s=i.objectValues.filter((e=>"table"===e.type)),r=i.objectValues.filter((e=>"view"===e.type)),[o,a]=await Promise.all([Promise.all(s.map((t=>xe(e,t,n)))),Promise.all(r.map((t=>xe(e,t,n))))]);return[{filename:decodeURIComponent(t),type:"table",tables:o,subRows:o},{filename:decodeURIComponent(t),type:"view",tables:a,subRows:a}]}(e,t,n,i)}const Se=e=>e.columnsMeta.filter((e=>e.pk)).sort(((e,t)=>e.pk-t.pk)).map((e=>e.name));function ke(e){const t=Se(e);return e.hasRowId?ye`ROWID AS ROWID`:t.length?`${t.map((e=>ye`"${e}"`)).join(ye` || '${he}' || `)} AS ROWID`:void 0}function Ae(e,{simplified:t=!1,textCutoff:i=1024,blobCutoff:n=1024,idsOnly:s=!1}={}){const r=s?[]:t?["*"]:e.columnsMeta.filter((e=>"ROWID"!==e.name)).map((({textCutoff:e=1024,blobCutoff:t=1024}={})=>i=>ye` CASE WHEN typeof("${i.name}") = 'blob' THEN SUBSTR("${i.name}", 1, ${e}) WHEN typeof("${i.name}") = 'text' THEN SUBSTR("${i.name}", 1, ${t}) ELSE "${i.name}" END AS "${i.name}", CASE WHEN typeof("${i.name}") IN ('blob','text') THEN LENGTH("${i.name}") ELSE NULL END AS "${i.name+"__size__"}"`)({textCutoff:i,blobCutoff:n}));switch(e.type){case"index":case"table":return ye`SELECT ${[ke(e),...r].filter((e=>!!e)).join(", ")} FROM "${e.tblName}"`;default:return ye`SELECT * FROM (${["SELECT ROW_NUMBER() OVER () AS ROWID",...r].join(", ")} FROM "${e.tblName}")`}}function Ie(e,t,i,n,s=!1,{simplified:r=!1,noSort:o=!1}={}){const a=[],l=[],c=r?e=>ye`'${e}'`:e=>(l.push(e),"?"),u=Object.entries(t).filter((([,{search:e,exact:t,invert:i,nonNullish:n}])=>!!e||t||i||n));if(u.length>0||i){const e=[];if(u.length>0){const t=u.map((([e,{search:t,exact:i,invert:n,nonNullish:s}])=>{const r=t?.replaceAll("%","\\%").replaceAll("_","\\_"),o=t!==r,a=n&&!t,l=n?"NOT ":"",u=a?"":"NOT ",_="NULL"===r?ye`IS ${l}NULL`:"''"===r?ye`IS ${l}''`:r&&ye`${l}LIKE ${c(i?r:`%${r}%`)}${o?" ESCAPE '\\'":""}`;return[_&&ye`"${e}" ${_}`,s?ye`("${e}" IS ${u}NULL ${a?"OR":"AND"} "${e}" IS ${u}'')`:null].filter((e=>!!e)).join(" AND ")})).filter((e=>!!e));t.length>0&&e.push(t.join(" AND "))}if(i&&n){const t=i.replaceAll("%","\\%").replaceAll("_","\\_"),s=i!==t,r=n.map((e=>ye`"${e.name}" LIKE ${c(`%${t}%`)}${s?" ESCAPE '\\'":""}`));e.push(ye`(${r.join(" OR ")})`)}e.length>0&&a.push(ye`WHERE ${e.join(" AND ")}`)}return o||(e&&e.length>0?a.push(ye`ORDER BY ${e.map((e=>ye`"${e.id}" ${e.desc?"DESC":"ASC"}`)).join(", ")}`):s&&a.push(ye`ORDER BY ROWID`)),[a.join(" "),l]}function Te(e,t){return e.map(((e,i)=>ye`"${e}" = '${t[i]}'`)).join(" AND ")}function Oe(e,t){if(e.hasRowId||"view"===e.type)return ye`WHERE ROWID = ${t}`;{const i=String(t).split(he);return ye`WHERE (${Te(Se(e),i)})`}}function Fe(e,t){if(!t.length)return"";if(e.hasRowId||"view"===e.type)return 1===t.length?ye`WHERE ROWID = ${t[0]}`:ye`WHERE ROWID IN (${t.join(", ")})`;{const i=t.map((e=>String(e).split(he))),n=Se(e);return ye`WHERE ${i.map((e=>`(${Te(n,e)})`)).join(" OR ")}`}}class Le{execAsObject(e,t){return we(this.execAsObjectImpl(e,[],t))}execAsObjectWithParams(e,t,i){return we(this.execAsObjectImpl(e,t,i))}first(e,t){return this.firstWithParams(e,[],t)}run(e,t){return this.runWithParams(e,[],t)}}let Pe;async function Ce(e){return Pe??=G({wasmBinary:await Promise.all([Promise.resolve().then((function(){return Qe})),Promise.resolve().then((function(){return Qe}))]).then((([e,t])=>{const i=t.join(__dirname,"..",new URL("./sqlite3.wasm",import.meta.url).pathname);return e.readFile(i)}))})}class Ne{static async fromStream(e,t,i,{mappings:n={}}={}){const s=await Ce(this.mappings||=n),r=[];return await t.pipeTo(new WritableStream({write(e){r.push(e)}})),this.createMem2Db(s,e,function(e){const t=e.reduce(((e,t)=>e+t.length),0),i=new Uint8Array(t);let n=0;for(const s of e)i.set(s,n),n+=s.length;return i}(r),i)}static async fromBuffer(e,t,i,{maxFileSize:n=209715200,mappings:s={}}={}){const r=await Ce(this.mappings||=s);return this.createMem2Db(r,e,t,i,{maxFileSize:n})}static{this.walMergePragmas=["PRAGMA locking_mode = EXCLUSIVE;","PRAGMA journal_mode = WAL;","PRAGMA wal_checkpoint(FULL);","PRAGMA journal_mode = OFF;"]}static createOpfsDb(e,t,i=!1){if(i){const i=new e.capi.sqlite3_vfs(e.capi.sqlite3_vfs_find("opfs")),n=e.oo1.DB.dbCtorHelper;n.setVfsPostOpenCallback(i.pointer,((e,t)=>{t.capi.sqlite3_busy_timeout(e,1e4),t.capi.sqlite3_exec(e,[...this.walMergePragmas],0,0,0)})),new e.oo1.OpfsDb(encodeURIComponent(t),"c").close(),n.setVfsPostOpenCallback(i.pointer,((e,t)=>{t.capi.sqlite3_busy_timeout(e,1e4),t.capi.sqlite3_exec(e,["PRAGMA journal_mode = DELETE;","PRAGMA cache_size = -16384;"],0,0,0)}))}const n=new URL(`file://localhost/${t}`);je&&n.searchParams.set("immutable","1");const s=new e.oo1.OpfsDb(n.href);return this.checkDb(s),new ze(e,s)}static createMem2Db(e,t,i,n,{maxFileSize:s=209715200}={}){if(!e.capi.sqlite3_vfs_find("mem2")){const t=e.capi.sqlite3_vfs_find(null),i=t?new e.capi.sqlite3_vfs(t):null,n=new e.capi.sqlite3_io_methods;n.$iVersion=1;const s=(new e.capi.sqlite3_vfs).addOnDispose((()=>{n.dispose()}));s.$iVersion=2,s.$szOsFile=e.capi.sqlite3_file.structInfo.sizeof,s.$mxPathname=1024,s.$zName=e.wasm.allocCString("mem2",!1),s.$xDlOpen=s.$xDlError=s.$xDlSym=s.$xDlClose=null,i&&(s.$xRandomness=i.$xRandomness,s.$xSleep=i.$xSleep,i.dispose());const r=((e,t)=>({io:$(e.wasm,e.capi),vfs:Q(e.wasm,e.capi,t)}))(e,n);e.vfs.installVfs({io:{struct:n,methods:r.io},vfs:{struct:s,methods:r.vfs}}),e.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(s.pointer,((e,t)=>{t.capi.sqlite3_busy_timeout(e,1e4),t.capi.sqlite3_exec(e,[...this.walMergePragmas,"PRAGMA synchronous = OFF","PRAGMA auto_vacuum = NONE;","PRAGMA cache_size = -16384;"],0,0,0)}))}const r=encodeURIComponent(t);!function(e,t,i,{maxFileSize:n=200*B}={}){const s=new ArrayBuffer(t.byteLength,{maxByteLength:Math.min(n,4*U)||4*U}),r=new Uint8Array(s);W=n,r.set(t),z.set(e,{name:e,flags:0,size:t.byteLength,data:r,lockType:0}),i&&z.set(`${e}-wal`,{name:`${e}-wal`,flags:0,size:i.byteLength,data:i,lockType:0})}(r,i,n,{maxFileSize:s});const o=new e.oo1.DB({vfs:"mem2",filename:r});return this.checkDb(o),new ze(e,o)}static checkDb(e){e.exec("PRAGMA foreign_keys = ON;"),e.exec("SELECT * FROM main.sqlite_schema LIMIT 0")}}const Re=performance?.now?.bind(performance)??Date.now.bind(Date),De=50,je=!0;class ze extends Le{constructor(e,t){super(),this.sqlite3=e,this.db=t}get type(){return"wasm"}get readOnly(){return je}execAsObjectImpl(e,t,i){return async function(e,t,i,n){const s=[],r=i.length?e.prepare(t).bind(i):e.prepare(t),o=r.getColumnNames();try{await ge(),n?.throwIfAborted();let e=Re()+De,t=r.step();for(;t;){Re()>e&&(await ge(),n?.throwIfAborted(),e=Re()+De);const i=r.get({});for(const e in i){const t=i[e];if(t instanceof Uint8Array){const n=await qe(t);i[`${e}__mime__`]=n,i[e]=F(t,[t.buffer])}}s.push(i),t=r.step()}return{columns:o,objectValues:s}}finally{r.finalize()}}(this.db,e,t,i)}first(e,t){return Me(this.db,e,[],t)}firstWithParams(e,t,i){return Me(this.db,e,t,i)}async runWithParams(e,t,i){const n=this.db,s=t.length?n.prepare(e).bind(t):n.prepare(e);try{await ge(),i?.throwIfAborted();let e=Re()+De,t=s.step();for(;t;)Re()>e&&(await ge(),i?.throwIfAborted(),e=Re()+De),t=s.step()}finally{s.finalize()}}async exportDb(){return this.sqlite3.capi.sqlite3_js_db_export(this.db.pointer,"main")}close(){this.db.close()}}async function Me(e,t,i,n){await ge(),n?.throwIfAborted();const s=e.selectArray(t,i.length?i:void 0)?.[0];return s}class Be{#p=new Map;get size(){return this.#p.size}get(e){let t;return this.#p.has(e)||this.#p.set(e,t=Promise.withResolvers()),(t??this.#p.get(e)).promise}set(e,t){return this.#p.has(e)?this.#p.get(e).resolve?.(t):this.#p.set(e,{promise:Promise.resolve(t)}),this}has(e){return!0}hasPending(e){return this.#p.get(e)}delete(e){return this.#p.get(e)?.reject?.(),this.#p.delete(e)}clear(){for(const e of this.#p.values())e.reject?.();this.#p.clear()}forEach(e,t){this.#p.forEach(((i,n)=>e.call(t,i.promise,n,this)))}*entries(){for(const[e,t]of this.#p)yield[e,t.promise]}keys(){return this.#p.keys()}*values(){for(const e of this.#p.values())yield e.promise}*[Symbol.iterator](){for(const[e,t]of this.#p)yield[e,t.promise]}get[Symbol.toStringTag](){return"EventualMap"}}class Ue{constructor(e){this.createDbWrapper=e,this.dbs=new Be}async importDb(e,t){const i=await this.createDbWrapper(e,t),n=new We(e,i);return this.dbs.set(e,n),L(n)}async close(e){}[Symbol.dispose](){for(const e of this.dbs.values())e.then((e=>e.close()))}}class We{constructor(e,t){this.filename=e,this.#d=t}#m=new Map;#d;#h=new Map;#g=!1;#b=0;get type(){return this.#d.type}get readOnly(){return this.#d.readOnly}get journalMode(){const e=ye`PRAGMA journal_mode`;return this.log(e),this.#d.first(e)}#y;#q=[];setLogger(e){if(this.#y=e,this.#q.length){for(const e of this.#q)this.#y.log(e).catch(console.warn);this.#q=[]}}log(e,t){if(t?.aborted)return;const i=e.trim()+";";this.#y?this.#y.log(i).catch(console.warn):this.#q.push(i)}getTableGroups(e){let t=this.#m.get(this.filename);return t||this.#m.set(this.filename,t=Ee(this.#d,this.filename)),t}async#w(e){const t=(await this.getTableGroups())[["table","view","index","trigger"].indexOf(e.table)].tables.find((t=>t.uiName===e.name));if(!t)throw Error(`Could not find schema for table: "${e.name}"`);return t}async close(e){this.#d?.close()}async getCount(e,{columnFilters:t={},globalFilter:i=""}={},n){const s=await this.#w(e),[r,o]=Ie([],t,i,s.columnsMeta,s.hasRowId,{noSort:!0}),[a]=Ie([],t,i,s.columnsMeta,s.hasRowId,{noSort:!0,simplified:!0}),l=ye`SELECT COUNT(*) FROM "${e.name}" ${r}`,c=ye`SELECT COUNT(*) FROM "${e.name}" ${a}`;let u;return this.log(c,n),u=Number(await this.#d.firstWithParams(l,o,n)),u}async getPage(e,{offset:t=0,sorting:i=[],columnFilters:n={},globalFilter:s=""}={},r){await be(50);const o=await this.#w(e),[a,l]=Ie(i,n,s,o.columnsMeta,o.hasRowId),[c]=Ie(i,n,s,o.columnsMeta,o.hasRowId,{simplified:!0}),u=ye`LIMIT ${300} OFFSET ${t}`,_=ye`${Ae(o)} ${a} ${u}`,f=`${Ae(o,{simplified:!0})} ${c} ${u}`;this.log(f,r);const{objectValues:p}=await this.#d.execAsObjectWithParams(_,l,r);return{offset:t,objectValues:p}}async getIdsFromToIndex(e,t,i,{sorting:n=[],columnFilters:s={},globalFilter:r=""}={},o){const a=Math.min(t,i),l=`LIMIT ${Math.abs(i-t)+1} OFFSET ${a}`,c=await this.#w(e),[u,_]=Ie(n,s,r,c.columnsMeta,c.hasRowId),[f]=Ie(n,s,r,c.columnsMeta,c.hasRowId,{simplified:!0}),p=`${Ae(c,{idsOnly:!0})} ${u} ${l}`,d=`${Ae(c,{idsOnly:!0,simplified:!0})} ${f} ${l}`;this.log(d,o);const{objectValues:m}=await this.#d.execAsObjectWithParams(p,_,o),h=new Set;for(const g of m)h.add(g.ROWID);return h}async getByRowId(e,t,{textCutoff:i=1024,blobCutoff:n=1024}={},s){const r=await this.getByRowIds(e,[t],{textCutoff:i,blobCutoff:n},s);return r?.objectValues?.[0]}async getByRowIds(e,t=[],{textCutoff:i=1024,blobCutoff:n=1024}={},s){const r=Array.from(t);if(!r.length)return{columns:[],objectValues:[]};const o=await this.#w(e),a=Ae(o,{textCutoff:i,blobCutoff:n}),l=Ae(o,{textCutoff:i,blobCutoff:n,simplified:!0}),c=`${a} ${Fe(o,r)} LIMIT ${r.length}`,u=`${l} ${Fe(o,r)} LIMIT ${r.length}`;this.log(u,s);const _=await this.#d.execAsObject(c,s);return _.objectValues=r.map(((e,t)=>_.objectValues.find((t=>t.ROWID==e)))),_}async getBlob(e,t,i,n){await be(50);const s=await this.#w(e),r=ye`SELECT "${i}" FROM "${s.tblName}" ${Fe(s,[t])}`;this.log(r,n);const o=await this.#d.first(r,n);return o&&F({data:o,type:await qe(o),size:o.byteLength},[o.buffer])}async exportDb(e,t){const i=await this.#d.exportDb(t);return F(i,[i.buffer])}async getStorageSize(e){const t=ye`SELECT SUM("pgsize") AS totalSize, COUNT(*) AS numPages FROM "dbstat" WHERE name='${(await this.#w(e)).tblName}'`;this.log(t);const{objectValues:[{totalSize:i,numPages:n}]}=await this.#d.execAsObject(t);return{totalSize:i,numPages:n}}async getIndices(e){const t=ye`SELECT * from pragma_index_list('${(await this.#w(e)).tblName}') ORDER BY seq`;this.log(t);const{objectValues:i}=await this.#d.execAsObject(t);return i.map((e=>({seq:e.seq,name:e.name,unique:!!e.unique,origin:e.origin,partial:!!e.partial})))}async#v(){this.#g||(this.#g=!0,await this.#x(ye`BEGIN TRANSACTION`))}#E(e){if("string"==typeof e){if(""===e)return null;if("NULL"===e)return null;if("''"===e)return""}return e}async updateRow(e,t,i,n,s){const r=Oe(await this.#w(e),t),o=ye`SELECT "${i}" FROM "${e.name}" ${r}`,a=ye`UPDATE "${e.name}" SET "${i}" = ? ${r}`,l=await this.#d.first(o,s)??null,c=[this.#E(n)];return await this.#S(a,c,s),{query:a,values:c,undoValues:[l]}}async insertRow(e,t,i){const n=await this.#w(e),s=Object.keys(t),r=Object.values(t).map(this.#E),o=s.map((e=>`"${e}"`)).join(", "),a=r.map((()=>"?")).join(", "),l=(c=n).hasRowId?ye`RETURNING ROWID`:ye`RETURNING ${Se(c).map((e=>ye`"${e}"`)).join(", ")}`;var c;const u=ye`INSERT INTO "${e.name}" (${o}) VALUES (${a}) ${l}`,{objectValues:[_]}=await this.#k(u,r,i);if(!_)throw Error("Failed to insert row");const f=Object.values(_).join(he);return{query:u,undoQuery:ye`DELETE FROM "${e.name}" ${Oe(n,f)}`,values:r,undoValues:[]}}async deleteRows(e,t,i){const n=await this.#w(e),s=Fe(n,t),r=ye`DELETE FROM "${e.name}" ${s} RETURNING ${n.hasRowId?"ROWID, *":"*"}`,{columns:o,objectValues:a}=await this.#k(r,[],i);let l,c;if(a.length*o.length>=32766)l="SELECT '__OMITTED__'";else{const t=o.map((e=>`"${e}"`)).join(", "),i=a.map((()=>`(${o.map((()=>"?")).join(", ")})`)).join(", ");l=ye`INSERT INTO "${e.name}" (${t}) VALUES ${i}`,c=a.flatMap((e=>o.map((t=>e[t]))))}return{query:r,undoQuery:l,values:[],undoValues:c??[]}}async#S(e,t,i){await this.#v(),await this.#x(ye`SAVEPOINT "UNDOPOINT"`,i),this.#b++,await this.#A(e,t,i)}async#I(e,t,i){return await this.#v(),await this.#x(ye`SAVEPOINT "UNDOPOINT"`,i),this.#b++,this.log(e,i),await this.#d.firstWithParams(e,t,i)}async#k(e,t,i){return await this.#v(),await this.#x(ye`SAVEPOINT "UNDOPOINT"`,i),this.#b++,this.log(e,i),await this.#d.execAsObjectWithParams(e,t,i)}#x(e,t){return this.log(e,t),this.#d.run(e)}#A(e,t,i){return this.log(e,i),this.#d.runWithParams(e,t,i)}async undo(e){this.#b>0?(this.#b--,await this.#x(ye`ROLLBACK TO "UNDOPOINT"`),await this.#x(ye`RELEASE "UNDOPOINT"`),0===this.#b&&(this.#g=!1,await this.#x(ye`COMMIT`))):(await this.#v(),await this.#A(e.undoQuery??e.query,e.undoValues))}async redo(e,t){await this.#S(e.query,e.values,t)}async applyEdits(e,t){if(e.length){await this.#v();for(const i of e)await this.#A(i.query,i.values,t)}}async commit(e){this.#g&&(this.#g=!1,this.#b=0,await this.#x(ye`COMMIT`,e))}async rollback(e){this.#g&&(this.#g=!1,this.#b=0,await this.#x(ye`ROLLBACK`,e))}getFilename(){return this.filename}[Symbol.dispose](){this.#d.close()}}b(new Ue(((e,t)=>{if("stream"in t)return Ne.fromStream(e,t.stream,t.walData,t);if("data"in t)return Ne.fromBuffer(e,t.data,t.walData,t);throw Error(`Not implemented for: ${JSON.stringify(t,null,2)}`)})));var Qe=Object.freeze({__proto__:null,default:{}});
